---
title: "Testing AmplificationTimeR - how much of a difference does using the wrong equation make?"
author: "Maria Jakobsdottir"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_notebook
---

Using perfectly simulated data. Output saved in: `/mnt/bmh01-rds/UoOxford_David_W/b05055gj/AmplificationTimeR_synthetic_tests/multinomial_sampled_data`

```{r}
outdir <- c("/mnt/bmh01-rds/UoOxford_David_W/b05055gj/AmplificationTimeR_synthetic_tests/multinomial_sampled_data/")
data_type <- "multinomial_data"
data_type_title <- "Multinomially Simulated Data"
multinomial_TF <- TRUE
```


# Libraries
```{r}
# devtools::install_github("Wedge-lab/AmplificationTimeR", force = TRUE)
# library(AmplificationTimeR)
library(ggplot2)
library(viridis)
library(BSgenome.Hsapiens.UCSC.hg19)
library(pheatmap)
library(grid)
library(data.table)
library(gridExtra)
library(scales)
```

# Data
List possible copy number states, their order, and potential alternative orders.

```{r}
states_and_order <- as.data.frame(matrix(data = c("State_and_order" = c("2+0 G","2+1 G","3+0 GG","3+1 GG","4+0 GGG",
                                                    "4+1 GGG","5+0 GGGG","5+1 GGGG","6+0 GGGGG","6+1 GGGGG",
                                                    "7+0 GGGGGG","7+1 GGGGGG","8+0 GGGGGGG","8+1 GGGGGGG","9+0 GGGGGGGG",
                                                    "9+1 GGGGGGGG","10+0 GGGGGGGGG","10+1 GGGGGGGGG","2+0 W","2+1 W",
                                                    "2+2 W","3+0 WG","3+1 WG","3+2 WG","4+0 WGG",
                                                    "4+0 GW","4+1 WGG","4+1 GW","4+2 WGG","4+2 GW",
                                                    "5+0 WGGG","5+0 GWG","5+1 WGGG","5+1 GWG","5+2 WGGG",
                                                    "5+2 GWG","6+0 WGGGG","6+0 GWGG","6+0 GGW","6+1 WGGGG",
                                                    "6+1 GWGG","6+1 GGW","6+2 WGGGG","6+2 GWGG","6+2 GGW",
                                                    "7+0 WGGGGG","7+0 GWGGG","7+0 GGWG","7+1 WGGGGG","7+1 GWGGG",
                                                    "7+1 GGWG","7+2 WGGGGG","7+2 GWGGG","7+2 GGWG","8+0 WGGGGGG",
                                                    "8+0 GWGGGG","8+0 GGWGG","8+0 GGGW","8+1 WGGGGGG","8+1 GWGGGG",
                                                    "8+1 GGWGG","8+1 GGGW","8+2 WGGGGGG","8+2 GWGGGG","8+2 GGWGG",
                                                    "8+2 GGGW","9+0 WGGGGGGG","9+0 GWGGGGG","9+0 GGWGGG","9+0 GGGWG",
                                                    "9+1 WGGGGGGG","9+1 GWGGGGG","9+1 GGWGGG","9+1 GGGWG","9+2 WGGGGGGG",
                                                    "9+2 GWGGGGG","9+2 GGWGGG","9+2 GGGWG","10+0 WGGGGGGGG","10+0 GWGGGGGG",
                                                    "10+0 GGWGGGG","10+0 GGGWGG","10+0 GGGGW","10+1 WGGGGGGGG","10+1 GWGGGGGG",
                                                    "10+1 GGWGGGG","10+1 GGGWGG","10+1 GGGGW","10+2 WGGGGGGGG","10+2 GWGGGGGG",
                                                    "10+2 GGWGGGG","10+2 GGGWGG","10+2 GGGGW"),
                                                "multiplicity_states"=c("c(1,2)","c(1,2)","c(1,2,3)","c(1,2,3)","c(1,2,3,4)",#5
                                                                        "c(1,2,3,4)","c(1,2,3,4,5)","c(1,2,3,4,5)","c(1,2,3,4,5,6)","c(1,2,3,4,5,6)",#10
                                                                        "c(1,2,3,4,5,6,7)","c(1,2,3,4,5,6,7)","c(1,2,3,4,5,6,7,8)","c(1,2,3,4,5,6,7,8)","c(1,2,3,4,5,6,7,8,9)",#15
                                                                        "c(1,2,3,4,5,6,7,8,9)","c(1,2,3,4,5,6,7,8,9,10)","c(1,2,3,4,5,6,7,8,9,10)","c(1,2)","c(1,2)",#20
                                                                        "c(1,2)","c(1,2,3)","c(1,2,3)","c(1,2,3)","c(1,2,3,4)",#25
                                                                        "c(1,2,4)","c(1,2,3,4)","c(1,2,4)","c(1,2,3,4)","c(1,2,4)",#30
                                                                        "c(1,2,3,4,5)","c(1,2,3,5)","c(1,2,3,4,5)","c(1,2,3,5)","c(1,2,3,4,5)",#35
                                                                        "c(1,2,3,5)","c(1,2,3,4,5,6)","c(1,2,3,4,6)","c(1,2,4,6)","c(1,2,3,4,5,6)",#40
                                                                        "c(1,2,3,4,6)","c(1,2,4,6)","c(1,2,3,4,5,6)","c(1,2,3,4,6)","c(1,2,4,6)",#45
                                                                        "c(1,2,3,4,5,6,7)","c(1,2,3,4,5,7)","c(1,2,3,5,7)","c(1,2,3,4,5,6,7)","c(1,2,3,4,5,7)",#50
                                                                        "c(1,2,3,5,7)","c(1,2,3,4,5,6,7)","c(1,2,3,4,5,7)","c(1,2,3,5,7)","c(1,2,3,4,5,6,7,8)",#55
                                                                        "c(1,2,3,4,5,6,8)","c(1,2,3,4,6,8)","c(1,2,4,6,8)","c(1,2,3,4,5,6,7,8)","c(1,2,3,4,5,6,8)",#60
                                                                        "c(1,2,3,4,6,8)","c(1,2,4,6,8)","c(1,2,3,4,5,6,7,8)","c(1,2,3,4,5,6,8)","c(1,2,3,4,6,8)",#65
                                                                        "c(1,2,4,6,8)","c(1,2,3,4,5,6,7,8,9)","c(1,2,3,4,5,6,7,9)","c(1,2,3,4,5,7,9)","c(1,2,3,5,7,9)",#70
                                                                        "c(1,2,3,4,5,6,7,8,9)","c(1,2,3,4,5,6,7,9)","c(1,2,3,4,5,7,9)","c(1,2,3,5,7,9)","c(1,2,3,4,5,6,7,8,9)",#75
                                                                        "c(1,2,3,4,5,6,7,9)","c(1,2,3,4,5,7,9)","c(1,2,3,5,7,9)","c(1,2,3,4,5,6,7,8,9,10)","c(1,2,3,4,5,6,7,8,10)",#80
                                                                        "c(1,2,3,4,5,6,8,10)","c(1,2,3,4,6,8,10)","c(1,2,4,6,8,10)","c(1,2,3,4,5,6,7,8,9,10)","c(1,2,3,4,5,6,7,8,10)",#85
                                                                        "c(1,2,3,4,5,6,8,10)","c(1,2,3,4,6,8,10)","c(1,2,4,6,8,10)","c(1,2,3,4,5,6,7,8,9,10)","c(1,2,3,4,5,6,7,8,10)",#90
                                                                        "c(1,2,3,4,5,6,8,10)","c(1,2,3,4,6,8,10)","c(1,2,4,6,8,10)"),#93
                              "is_wgd"=c("No","No","No","No","No",
                                         "No","No","No","No","No",
                                         "No","No","No","No","No",
                                         "No","No","No","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes"),
                              "number_of_timepoints" = c(1,1,2,2,3,
                                                         3,4,4,5,5,
                                                         6,6,7,7,8,
                                                         8,9,9,1,1,
                                                         1,2,2,2,3,
                                                         2,3,2,3,2,
                                                         4,3,4,3,4,
                                                         3,5,4,3,5,
                                                         4,3,5,4,3,
                                                         6,5,4,6,5,
                                                         4,6,5,4,7,
                                                         6,5,4,7,6,
                                                         5,4,7,6,5,
                                                         4,8,7,6,5,
                                                         8,7,6,5,8,
                                                         7,6,5,9,8,
                                                         7,6,5,9,8,
                                                         7,6,5,9,8,
                                                         7,6,5),
                              "potential_alternative_order" = c("None","None","None","None","None",
                                                    "None","None","None","None","None",
                                                    "None","None","None","None","None",
                                                    "None","None","None","None","None",
                                                    "None","None","None","None","c('WGG','GW')",
                                                    "c('WGG','GW')","c('WGG','GW')","c('WGG','GW')","c('WGG','GW')","c('WGG','GW')",
                                                    "c('WGGG','GWG')","c('WGGG','GWG')","c('WGGG','GWG')","c('WGGG','GWG')","c('WGGG','GWG')",
                                                    "c('WGGG','GWG')","c('WGGGG','GWGG','GGW')","c('WGGGG','GWGG','GGW')","c('WGGGG','GWGG','GGW')","c('WGGGG','GWGG','GGW')",
                                                    "c('WGGGG','GWGG','GGW')","c('WGGGG','GWGG','GGW')","c('WGGGG','GWGG','GGW')","c('WGGGG','GWGG','GGW')","c('WGGGG','GWGG','GGW')",
                                                    "c('WGGGGG','GWGGG','GGWG')","c('WGGGGG','GWGGG','GGWG')","c('WGGGGG','GWGGG','GGWG')","c('WGGGGG','GWGGG','GGWG')","c('WGGGGG','GWGGG','GGWG')",
                                                    "c('WGGGGG','GWGGG','GGWG')","c('WGGGGG','GWGGG','GGWG')","c('WGGGGG','GWGGG','GGWG')","c('WGGGGG','GWGGG','GGWG')","c('WGGGGGG','GWGGGG','GGWGG','GGGW')",
                                                    "c('WGGGGGG','GWGGGG','GGWGG','GGGW')","c('WGGGGGG','GWGGGG','GGWGG','GGGW')","c('WGGGGGG','GWGGGG','GGWGG','GGGW')","c('WGGGGGG','GWGGGG','GGWGG','GGGW')","c('WGGGGGG','GWGGGG','GGWGG','GGGW')",
                                                    "c('WGGGGGG','GWGGGG','GGWGG','GGGW')","c('WGGGGGG','GWGGGG','GGWGG','GGGW')","c('WGGGGGG','GWGGGG','GGWGG','GGGW')","c('WGGGGGG','GWGGGG','GGWGG','GGGW')","c('WGGGGGG','GWGGGG','GGWGG','GGGW')",
                                                    "c('WGGGGGG','GWGGGG','GGWGG','GGGW')","c('WGGGGGGG','GWGGGGG','GGWGGG','GGGWG')","c('WGGGGGGG','GWGGGGG','GGWGGG','GGGWG')","c('WGGGGGGG','GWGGGGG','GGWGGG','GGGWG')","c('WGGGGGGG','GWGGGGG','GGWGGG','GGGWG')",
                                                    "c('WGGGGGGG','GWGGGGG','GGWGGG','GGGWG')","c('WGGGGGGG','GWGGGGG','GGWGGG','GGGWG')","c('WGGGGGGG','GWGGGGG','GGWGGG','GGGWG')","c('WGGGGGGG','GWGGGGG','GGWGGG','GGGWG')","c('WGGGGGGG','GWGGGGG','GGWGGG','GGGWG')",
                                                    "c('WGGGGGGG','GWGGGGG','GGWGGG','GGGWG')","c('WGGGGGGG','GWGGGGG','GGWGGG','GGGWG')","c('WGGGGGGG','GWGGGGG','GGWGGG','GGGWG')","c('WGGGGGGGG','GWGGGGGG','GGWGGGG','GGGWGG','GGGGW')","c('WGGGGGGGG','GWGGGGGG','GGWGGGG','GGGWGG','GGGGW')",
                                                    "c('WGGGGGGGG','GWGGGGGG','GGWGGGG','GGGWGG','GGGGW')","c('WGGGGGGGG','GWGGGGGG','GGWGGGG','GGGWGG','GGGGW')","c('WGGGGGGGG','GWGGGGGG','GGWGGGG','GGGWGG','GGGGW')","c('WGGGGGGGG','GWGGGGGG','GGWGGGG','GGGWGG','GGGGW')","c('WGGGGGGGG','GWGGGGGG','GGWGGGG','GGGWGG','GGGGW')",
                                                    "c('WGGGGGGGG','GWGGGGGG','GGWGGGG','GGGWGG','GGGGW')","c('WGGGGGGGG','GWGGGGGG','GGWGGGG','GGGWGG','GGGGW')","c('WGGGGGGGG','GWGGGGGG','GGWGGGG','GGGWGG','GGGGW')","c('WGGGGGGGG','GWGGGGGG','GGWGGGG','GGGWGG','GGGGW')","c('WGGGGGGGG','GWGGGGGG','GGWGGGG','GGGWGG','GGGGW')",
                                                    "c('WGGGGGGGG','GWGGGGGG','GGWGGGG','GGGWGG','GGGGW')","c('WGGGGGGGG','GWGGGGGG','GGWGGGG','GGGWGG','GGGGW')","c('WGGGGGGGG','GWGGGGGG','GGWGGGG','GGGWGG','GGGGW')")), ncol = 5, byrow = FALSE))
colnames(states_and_order) <- c("State_and_order","multiplicity_states","is_wgd","number_of_timepoints","potential_alternative_order")
states_and_order$Order <- gsub(".* ","",states_and_order$State_and_order)
states_and_order$State <- gsub(" .*","",states_and_order$State_and_order)
```

# Functions
## Modified timing equations
```{r}
# Function for timing amplifications

################################################################################
#' Identify mutations that are C>T at CpG
#' 
#' @param mutation Data frame containing mutation information, including Ref and Alt alleles. Columns must be "chr","start","end","ref","alt"
#' @param genome Reference genome used. Must be one of "hg19" or "hg38"
#' @return A data frame with mutations that are C>T at CpG. 
#' @keywords internal
#' @noRd

clocklike_muts <- function(mutation, genome){
  muts <- mutation
  genome_ref <- genome
  
  ###
  # Check that input is okay
  ###
  if(!(genome_ref %in% c("hg19","hg38"))){
    stop("genome must be one of 'hg19' or 'hg38'")
  }
  if(!all(colnames(muts) %in% c("chr","start","end","ref","alt"))){
    stop("Mutation file column names must be 'chr','start','end','ref','alt'")
  }
  if(nrow(muts) == 0){
    stop("'mutation_data' has no content")
  }
  # Make sure we're only considering SNVs
  nucleotides <- c("A","T","G","C")
  muts <- muts[muts$ref %in% nucleotides & muts$alt %in% nucleotides,]
  
  # create a VRanges object with your mutations to check against the reference genome
  if(nrow(muts[grep("chr", muts$chr),]) == 0){
    vr <- VariantAnnotation::VRanges(seqnames = paste0("chr",muts$chr),
                                     ranges = IRanges::IRanges(muts$start, muts$end),
                                     ref = muts$ref, 
                                     alt = muts$alt)
  }else{
    vr <- VariantAnnotation::VRanges(seqnames = muts$chr,
                                     ranges = IRanges::IRanges(muts$start, muts$end),
                                     ref = muts$ref, 
                                     alt = muts$alt)
  }
  
  # get mutation context using SomaticSignatures function
  if(genome_ref == "hg19"){
    context <- SomaticSignatures::mutationContext(vr, BSgenome.Hsapiens.UCSC.hg19, k=3, unify = TRUE)
  }else if(genome_ref == "hg38"){
    context <- SomaticSignatures::mutationContext(vr, BSgenome.Hsapiens.UCSC.hg38, k=3, unify = TRUE)
  }
  
  # turn this into a data frame 
  context_df <- as.data.frame(context)
  
  # extract rows with C>G at CpG
  context_ct_cpg <- subset(context_df, alteration == "CT" &
                             context %in% c("A.G","T.G","C.G","G.G"))
  
  return(context_ct_cpg)
  
}

################################################################################
#' Calculate maths for timing
#' 
#' Hidden function for calculating the maths used in AmplificationTimeR - not intended for use by end users.  Called by time_amplification
#' @param mult_data List of observed multiplicity values
#' @param max_amp Maximum copy number state, split into major and minor copy number
#' @param is_WGD Whole genome duplication status
#' @param ordering_event Order of events determined based on copy number and multiplicity of mutations
#' @return A data frame containing approximate timing of each amplification, and the most likely order of events. 
#' @keywords internal
#' @noRd

time_amplification_maths <- function(mult_data, max_amp, is_WGD, ordering_event){
  max_amplification_split <- max_amp
  order_event <- ordering_event
  ############################################################################
  # make your output data frame
  amplification_results <- as.data.frame(matrix(nrow=1, ncol = 12))
  colnames(amplification_results) <- c("highest_copy_number","event_order",
                                       "t_1","t_2","t_3","t_4","t_5",
                                       "t_6","t_7","t_8","t_9","t_10")
  amplification_results$highest_copy_number <- max_amplification_split
  ############################################################################
  ### calculate the multiplicity of all of the mutations
  ## First create a table to house your multiplicity values
  
  if(length(mult_data > 0)){
    n1 <- sum(mult_data == 1) 
    n2 <- sum(mult_data == 2) 
    n3 <- sum(mult_data == 3) 
    n4 <- sum(mult_data == 4) 
    n5 <- sum(mult_data == 5) 
    n6 <- sum(mult_data == 6) 
    n7 <- sum(mult_data == 7) 
    n8 <- sum(mult_data == 8) 
    n9 <- sum(mult_data == 9) 
    n10 <- sum(mult_data == 10) 
    n11 <- sum(mult_data == 11) 
    n12 <- sum(mult_data == 12) 
    n13 <- sum(mult_data == 13) 
    n14 <- sum(mult_data == 14) 
    n15 <- sum(mult_data == 15) 
    n16 <- sum(mult_data == 16) 
    n17 <- sum(mult_data == 17) 
    n18 <- sum(mult_data == 18) 
    n19 <- sum(mult_data == 19) 
    n20 <- sum(mult_data == 20) 
  }
  
  
  ############################################################################
  ### start calculating timing
  ### 
  
  if(max_amplification_split == c("2+0") & is_WGD == FALSE & order_event == "G"){ ######## start with non-WGD
    
    t_1 <- (2*n2)/(n1+2*n2)
    
    amplification_results$t_1 <- t_1
    
  }else if(max_amplification_split == c("2+1") & is_WGD == FALSE & order_event == "G"){ ######## start with non-WGD
    
    t_1 <- (3*n2)/(n1+2*n2)
    
    amplification_results$t_1 <- t_1
    
  }else if(max_amplification_split == c("3+0") & is_WGD == FALSE & order_event == "GG"){
    
    t_1 <- (3*n3)/(n1 + 2*n2 + 3*n3)
    t_2 <- (3*(n2 + n3))/(n1 + 2*n2 + 3*n3)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    
  }else if(max_amplification_split == c("3+1") & is_WGD == FALSE & order_event == "GG"){
    
    t_1 <- (4*n3)/(n1 + 2*n2 + 3*n3)
    t_2 <- (4*(n2+n3))/(n1 + 2*n2 + 3*n3)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    
  }else if(max_amplification_split == c("4+0") & is_WGD == FALSE & order_event %in% c("GGG", "GGG - Unsure")){
    
    t_1 <- (4*(n4))/(n1 + 2*n2 + 3*n3 + 4*n4)
    t_2 <- (4*(n3 + n4))/(n1 + 2*n2 + 3*n3 + 4*n4)
    t_3 <- (4*(n2 + n3 + n4))/(n1 + 2*n2 + 3*n3 + 4*n4)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    amplification_results$t_3 <- t_3
    
  }else if(max_amplification_split == c("4+1") & is_WGD == FALSE & order_event %in% c("GGG", "GGG - Unsure")){
    
    t_1 <- (5*(n4))/(n1 + 2*n2 + 3*n3 + 4*n4)
    t_2 <- (5*(n3 + n4))/(n1 + 2*n2 + 3*n3 + 4*n4)
    t_3 <- (5*(n2 + n3 + n4))/(n1 + 2*n2 + 3*n3 + 4*n4)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    amplification_results$t_3 <- t_3
    
  }else if(max_amplification_split == c("5+0") & is_WGD == FALSE & order_event %in% c("GGGG","GGGG - Unsure")){
    t_1 <- (5*(n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
    t_2 <- (5*(n4 + n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
    t_3 <- (5*(n3 + n4 + n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
    t_4 <- (5*(n2 + n3 + n4 + n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    amplification_results$t_3 <- t_3
    amplification_results$t_4 <- t_4
    
  }else if(max_amplification_split == c("5+1") & is_WGD == FALSE & order_event %in% c("GGGG","GGGG - Unsure")){
    t_1 <- (6*(n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
    t_2 <- (6*(n4 + n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
    t_3 <- (6*(n3 + n4 + n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
    t_4 <- (6*(n2 + n3 + n4 + n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    amplification_results$t_3 <- t_3
    amplification_results$t_4 <- t_4
    
  }else if(max_amplification_split == c("6+0") & is_WGD == FALSE & order_event %in% c("GGGGG","GGGGG - Unsure")){
    t_1 <- (6*n6)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
    t_2 <- (6*(n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
    t_3 <- (6*(n4 + n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
    t_4 <- (6*(n3 + n4 + n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
    t_5 <- (6*(n2 + n3 + n4 + n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    amplification_results$t_3 <- t_3
    amplification_results$t_4 <- t_4
    amplification_results$t_5 <- t_5
    
  }else if(max_amplification_split == c("6+1") & is_WGD == FALSE & order_event %in% c("GGGGG","GGGGG - Unsure")){
    t_1 <- (7*n6)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
    t_2 <- (7*(n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
    t_3 <- (7*(n4 + n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
    t_4 <- (7*(n3 + n4 + n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
    t_5 <- (7*(n2 + n3 + n4 + n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    amplification_results$t_3 <- t_3
    amplification_results$t_4 <- t_4
    amplification_results$t_5 <- t_5
    
  }else if(max_amplification_split == c("7+0") & is_WGD == FALSE & order_event %in% c("GGGGGG","GGGGGG - Unsure")){
    t_1 <- (7*n7)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
    t_2 <- (7*(n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
    t_3 <- (7*(n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
    t_4 <- (7*(n4 + n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
    t_5 <- (7*(n3 + n4 + n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
    t_6 <- (7*(n2 + n3 + n4 + n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    amplification_results$t_3 <- t_3
    amplification_results$t_4 <- t_4
    amplification_results$t_5 <- t_5
    amplification_results$t_6 <- t_6
    
  }else if(max_amplification_split == c("7+1") & is_WGD == FALSE & order_event %in% c("GGGGGG","GGGGGG - Unsure")){
    t_1 <- (8*n7)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
    t_2 <- (8*(n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
    t_3 <- (8*(n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
    t_4 <- (8*(n4 + n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
    t_5 <- (8*(n3 + n4 + n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
    t_6 <- (8*(n2 + n3 + n4 + n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    amplification_results$t_3 <- t_3
    amplification_results$t_4 <- t_4
    amplification_results$t_5 <- t_5
    amplification_results$t_6 <- t_6
    
  }else if(max_amplification_split == c("8+0") & is_WGD == FALSE & order_event %in% c("GGGGGGG","GGGGGGG - Unsure")){
    t_1 <- (8*n8)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
    t_2 <- (8*(n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
    t_3 <- (8*(n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
    t_4 <- (8*(n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
    t_5 <- (8*(n4 + n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
    t_6 <- (8*(n3 + n4 + n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
    t_7 <- (8*(n2 + n3 + n4 + n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    amplification_results$t_3 <- t_3
    amplification_results$t_4 <- t_4
    amplification_results$t_5 <- t_5
    amplification_results$t_6 <- t_6
    amplification_results$t_7 <- t_7
    
  }else if(max_amplification_split == c("8+1") & is_WGD == FALSE & order_event %in% c("GGGGGGG","GGGGGGG - Unsure")){
    t_1 <- (9*n8)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
    t_2 <- (9*(n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
    t_3 <- (9*(n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
    t_4 <- (9*(n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
    t_5 <- (9*(n4 + n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
    t_6 <- (9*(n3 + n4 + n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
    t_7 <- (9*(n2 + n3 + n4 + n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    amplification_results$t_3 <- t_3
    amplification_results$t_4 <- t_4
    amplification_results$t_5 <- t_5
    amplification_results$t_6 <- t_6
    amplification_results$t_7 <- t_7
    
  }else if(max_amplification_split == c("9+0") & is_WGD == FALSE & order_event %in% c("GGGGGGGG","GGGGGGGG - Unsure")){
    t_1 <- (9*n9)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
    t_2 <- (9*(n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
    t_3 <- (9*(n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
    t_4 <- (9*(n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
    t_5 <- (9*(n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
    t_6 <- (9*(n4 + n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
    t_7 <- (9*(n3 + n4 + n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
    t_8 <- (9*(n2 + n3 + n4 + n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    amplification_results$t_3 <- t_3
    amplification_results$t_4 <- t_4
    amplification_results$t_5 <- t_5
    amplification_results$t_6 <- t_6
    amplification_results$t_7 <- t_7
    amplification_results$t_8 <- t_8
    
  }else if(max_amplification_split == c("9+1") & is_WGD == FALSE & order_event %in% c("GGGGGGGG","GGGGGGGG - Unsure")){
    t_1 <- (10*n9)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
    t_2 <- (10*(n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
    t_3 <- (10*(n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
    t_4 <- (10*(n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
    t_5 <- (10*(n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
    t_6 <- (10*(n4 + n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
    t_7 <- (10*(n3 + n4 + n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
    t_8 <- (10*(n2 + n3 + n4 + n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    amplification_results$t_3 <- t_3
    amplification_results$t_4 <- t_4
    amplification_results$t_5 <- t_5
    amplification_results$t_6 <- t_6
    amplification_results$t_7 <- t_7
    amplification_results$t_8 <- t_8
    
  }else if(max_amplification_split == c("10+0") & is_WGD == FALSE & order_event %in% c("GGGGGGGGG","GGGGGGGGG - Unsure")){
    t_1 <- (10*n10)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
    t_2 <- (10*(n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
    t_3 <- (10*(n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
    t_4 <- (10*(n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
    t_5 <- (10*(n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
    t_6 <- (10*(n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
    t_7 <- (10*(n4 + n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
    t_8 <- (10*(n3 + n4 + n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
    t_9 <- (10*(n2 + n3 + n4 + n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    amplification_results$t_3 <- t_3
    amplification_results$t_4 <- t_4
    amplification_results$t_5 <- t_5
    amplification_results$t_6 <- t_6
    amplification_results$t_7 <- t_7
    amplification_results$t_8 <- t_8
    amplification_results$t_9 <- t_9
    
  }else if(max_amplification_split == c("10+1") & is_WGD == FALSE & order_event %in% c("GGGGGGGGG","GGGGGGGGG - Unsure")){
    t_1 <- (11*n10)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
    t_2 <- (11*(n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
    t_3 <- (11*(n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
    t_4 <- (11*(n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
    t_5 <- (11*(n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
    t_6 <- (11*(n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
    t_7 <- (11*(n4 + n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
    t_8 <- (11*(n3 + n4 + n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
    t_9 <- (11*(n2 + n3 + n4 + n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    amplification_results$t_3 <- t_3
    amplification_results$t_4 <- t_4
    amplification_results$t_5 <- t_5
    amplification_results$t_6 <- t_6
    amplification_results$t_7 <- t_7
    amplification_results$t_8 <- t_8
    amplification_results$t_9 <- t_9
    
    ##################### WGD onwards, with further options ####################
  }else if(max_amplification_split == c("2+0") & is_WGD == TRUE){
    
    t_1 <- (2*n2)/(n1 + 2*n2)
    
    amplification_results$t_1 <- t_1
    
  }else if(max_amplification_split == c("2+1") & is_WGD == TRUE){
    
    t_1 <- (3*n2)/(n1+2*n2)
    
    amplification_results$t_1 <- t_1
    
  }else if(max_amplification_split == c("2+2") & is_WGD == TRUE){
    
    t_1 <- (2*n2)/(n1 + 2*n2)

    amplification_results$t_1 <- t_1
    
  }else if(max_amplification_split == c("3+0") & is_WGD == TRUE){
    
    t_1 <- (3*n3)/(n1 + 2*n2 + 3*n3)
    t_2 <- (3*(n2 + n3))/(n1 + 2*n2 + 3*n3)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    
  }else if(max_amplification_split == c("3+1") & is_WGD == TRUE){
    
    t_1 <- (4*n3)/(n1 + 2*n2 + 3*n3)
    t_2 <- (4*(n2 + n3))/(n1 + 2*n2 + 3*n3)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    
  }else if(max_amplification_split == c("3+2") & is_WGD == TRUE){
    
    t_1 <- (5*n3)/(n1 + 2*n2 + 3*n3)
    t_2 <- (5*(n2))/(n1 + 2*n2 + 3*n3)
    
    amplification_results$t_1 <- t_1
    amplification_results$t_2 <- t_2
    
  }else if(max_amplification_split == c("4+0") & is_WGD == TRUE){ 
    # WGG
    if(order_event == "WGG"){
      t_1 <- (4*n4)/(n1 + 2*n2 + 3*n3 + 4*n4)
      t_2 <- (4*(n3 + n4))/(n1 + 2*n2 + 3*n3 + 4*n4)
      t_3 <- (4*(n2 + n3 + n4))/(n1 + 2*n2 + 3*n3 + 4*n4)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      
    }else if(order_event == "GW"){# GW
      t_1 <- (4*n4)/(n1 + 2*n2 + 4*n4)
      t_2 <- (2*(n2 + 2*n4))/(n1 + 2*n2 + 4*n4)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
    }
    
  }else if(max_amplification_split == c("4+1") & is_WGD == TRUE){ 
    # WGG
    if(order_event == "WGG"){
      t_1 <- (5*n4)/(n1 + 2*n2 + 3*n3 + 4*n4)
      t_2 <- (5*(n3 + n4))/(n1 + 2*n2 + 3*n3 + 4*n4)
      t_3 <- (5*(n2 + n3 + n4))/(n1 + 2*n2 + 3*n3 + 4*n4)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      
    }else if(order_event == "GW"){# GW
      t_1 <- (5*n4)/(n1 + 2*n2 + 4*n4)
      t_2 <- (5*(n2 + 2*n4))/(2*(n1 + 2*n2 + 4*n4))
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
    }
    
  }else if(max_amplification_split == c("4+2") & is_WGD == TRUE){ 
    # WGG
    if(order_event == "WGG"){
      t_1 <- (6*(n4))/(n1 + 2*n2 + 3*n3 + 4*n4)
      t_2 <- (6*(n3 + n4))/(n1 + 2*n2 + 3*n3 + 4*n4)
      t_3 <- (6*(n2 + n3))/(n1 + 2*n2 + 3*n3 + 4*n4)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
    }else if(order_event == "GW"){# GW
      t_1 <- (6*(n4))/(n1 + 2*n2 + 4*n4)
      t_2 <- (2*(n2 + 2*n4))/(n1 + 2*n2 + 4*n4)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
    }
    
  }else if(max_amplification_split == c("5+0") & is_WGD == TRUE){
    # WGGG
    if(order_event == "WGGG"){
      t_1 <- (5*n5)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
      t_2 <- (5*(n4 + n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
      t_3 <- (5*(n3 + n4 + n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
      t_4 <- (5*(n2 + n3 + n4 + n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
    }else if(order_event == "GWG"){# GWG
      t_1 <- (5*n5)/(n1 + 2*n2 + 3*n3 + 5*n5)
      t_2 <- (5*(n3 + n5))/(n1 + 2*n2 + 3*n3 + 5*n5)
      t_3 <- (5*(n2 + n5))/(n1 + 2*n2 + 3*n3 + 5*n5)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
    }
    
  }else if(max_amplification_split == c("5+1") & is_WGD == TRUE){
    # WGGG
    if(order_event == "WGGG"){
      t_1 <- (6*(n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
      t_2 <- (6*(n4 + n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
      t_3 <- (6*(n3 + n4 + n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
      t_4 <- (6*(n2 + n3 + n4 + n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
    }else if(order_event == "GWG"){# GWG
      t_1 <- (6*(n5))/(n1 + 2*n2 + 3*n3 + 5*n5)
      t_2 <- (6*(n3 + n5))/(n1 + 2*n2 + 3*n3 + 5*n5)
      t_3 <- (6*(n2 + n5))/(n1 + 2*n2 + 3*n3 + 5*n5)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
    }
    
  }else if(max_amplification_split == c("5+2") & is_WGD == TRUE){
    # WGGG
    if(order_event == "WGGG"){
      t_1 <- (7*(n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
      t_2 <- (7*(n4 + n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
      t_3 <- (7*(n3 + n4 + n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
      t_4 <- (7*(n2 + n3 + n4))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
    }else if(order_event == "GWG"){# GWG
      t_1 <- (7*(n5))/(n1 + 2*n2 + 3*n3 + 5*n5)
      t_2 <- (7*(n3 + n5))/(n1 + 2*n2 + 3*n3 + 5*n5)
      t_3 <- (7*(n2 - n3))/(n1 + 2*n2 + 3*n3 + 5*n5)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
    }
    
  }else if(max_amplification_split == c("6+0") & is_WGD == TRUE){
    # WGGGG
    if(order_event == "WGGGG"){
      t_1 <- (6*n6)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
      t_2 <- (6*(n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
      t_3 <- (6*(n4 + n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
      t_4 <- (6*(n3 + n4 + n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
      t_5 <- (6*(n2 + n3 + n4 + n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
    }else if(order_event == "GWGG"){# GWGG
      t_1 <- (6*n6)/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6)
      t_2 <- (6*(n4 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6)
      t_3 <- (6*(n3 + n4 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6)
      t_4 <- (6*(n2 + n3 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
    }else if(order_event == "GGW"){# GGW
      t_1 <- (6*n6)/(n1 + 2*n2 + 4*n4 + 6*n6)
      t_2 <- (6*(n4 + n6))/(n1 + 2*n2 + 4*n4 + 6*n6)
      t_3 <- (2*(n2 + 2*n4 + 3*n6))/(n1 + 2*n2 + 4*n4 + 6*n6)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
    }
    
  }else if(max_amplification_split == c("6+1") & is_WGD == TRUE){
    # WGGGG
    if(order_event == "WGGGG"){
      t_1 <- (7*(n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
      t_2 <- (7*(n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
      t_3 <- (7*(n4 + n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
      t_4 <- (7*(n3 + n4 + n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
      t_5 <- (7*(n2 + n3 + n4 + n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
    }else if(order_event == "GWGG"){# GWGG
      t_1 <- (7*(n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6)
      t_2 <- (7*(n4 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6)
      t_3 <- (7*(n3 + n4 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6)
      t_4 <- (7*(n2 + n3 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
    }else if(order_event == "GGW"){# GGW
      t_1 <- (7*(n6))/(n1 + 2*n2 + 4*n4 + 6*n6)
      t_2 <- (7*(n4 + n6))/(n1 + 2*n2 + 4*n4 + 6*n6)
      t_3 <- (7*(n2 + 2*n4 + 3*n6))/(3*(n1 + 2*n2 + 4*n4 + 6*n6))
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
    }
    
  }else if(max_amplification_split == c("6+2") & is_WGD == TRUE){
    # WGGGG
    if(order_event == "WGGGG"){
      t_1 <- (8*(n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
      t_2 <- (8*(n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
      t_3 <- (8*(n4 + n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
      t_4 <- (8*(n3 + n4 + n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
      t_5 <- (8*(n2 + n3 + n4 + n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
    }else if(order_event == "GWGG"){# GWGG
      t_1 <- (8*(n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6)
      t_2 <- (8*(n4 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6)
      t_3 <- (8*(n3 + n4 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6)
      t_4 <- (8*(n2 + n3 - n4))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
    }else if(order_event == "GGW"){# GGW
      t_1 <- (8*(n6))/(n1 + 2*n2 + 4*n4 + 6*n6)
      t_2 <- (8*(n4 + n6))/(n1 + 2*n2 + 4*n4 + 6*n6)
      t_3 <- (2*(n2 + 2*n4 + 3*n6))/(n1 + 2*n2 + 4*n4 + 6*n6)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
    }
  }else if(max_amplification_split == c("7+0") & is_WGD == TRUE){
    if((order_event == "WGGGGG")){
      t_1 <- (7*n7)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
      t_2 <- (7*(n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
      t_3 <- (7*(n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
      t_4 <- (7*(n4 + n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
      t_5 <- (7*(n3 + n4 + n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
      t_6 <- (7*(n2 + n3 + n4 + n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
    }else if((order_event == "GWGGG")){
      t_1 <- (7*n7)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7)
      t_2 <- (7*(n5 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7)
      t_3 <- (7*(n4 + n5 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7)
      t_4 <- (7*(n3 + n4 + n5 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7)
      t_5 <- (7*(n2 + n3 + n4 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
    }else if((order_event == "GGWG")){
      t_1 <- (7*n7)/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7)
      t_2 <- (7*(n5 + n7))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7)
      t_3 <- (7*(n3 + n5 + n7))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7)
      t_4 <- (7*(n2 - n3 + n7))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
    }
  }else if(max_amplification_split == c("7+1") & is_WGD == TRUE){
    if((order_event == "WGGGGG")){
      t_1 <- (8*n7)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
      t_2 <- (8*(n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
      t_3 <- (8*(n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
      t_4 <- (8*(n4 + n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
      t_5 <- (8*(n3 + n4 + n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
      t_6 <- (8*(n2 + n3 + n4 + n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
    }else if((order_event == "GWGGG")){
      t_1 <- (8*n7)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7)
      t_2 <- (8*(n5 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7)
      t_3 <- (8*(n4 + n5 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7)
      t_4 <- (8*(n3 + n4 + n5 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7)
      t_5 <- (8*(n2 + n3 + n4 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
    }else if((order_event == "GGWG")){
      t_1 <- (8*n7)/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7)
      t_2 <- (8*(n5 + n7))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7)
      t_3 <- (8*(n3 + n5 + n7))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7)
      t_4 <- (8*(n2 - n3 + n7))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
    }
  }else if(max_amplification_split == c("7+2") & is_WGD == TRUE){
    if((order_event == "WGGGGG")){
      t_1 <- (9*n7)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
      t_2 <- (9*(n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
      t_3 <- (9*(n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
      t_4 <- (9*(n4 + n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
      t_5 <- (9*(n3 + n4 + n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
      t_6 <- (9*(n2 + n3 + n4 + n5 + n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
    }else if((order_event == "GWGGG")){
      t_1 <- (9*n7)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7)
      t_2 <- (9*(n5 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7)
      t_3 <- (9*(n4 + n5 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7)
      t_4 <- (9*(n3 + n4 + n5 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7)
      t_5 <- (9*(n2 + n3 + n4 - n5))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
    }else if((order_event == "GGWG")){
      t_1 <- (9*n7)/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7)
      t_2 <- (9*(n5 + n7))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7)
      t_3 <- (9*(n3 + n5 + n7))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7)
      t_4 <- (9*(n2 - 2*n3 - n5))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
    }
  }else if(max_amplification_split == c("8+0") & is_WGD == TRUE){
    if((order_event == "WGGGGGG")){
      t_1 <- (8*n8)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      t_2 <- (8*(n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      t_3 <- (8*(n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      t_4 <- (8*(n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      t_5 <- (8*(n4 + n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      t_6 <- (8*(n3 + n4 + n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      t_7 <- (8*(n2 + n3 + n4 + n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
      amplification_results$t_7 <- t_7
    }else if((order_event == "GWGGGG")){
      t_1 <- (8*n8)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8)
      t_2 <- (8*(n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8)
      t_3 <- (8*(n5 + n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8)
      t_4 <- (8*(n4 + n5 + n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8)
      t_5 <- (8*(n3 + n4 + n5 + n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8)
      t_6 <- (8*(n2 + n3 + n4 + n5 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
    }else if((order_event == "GGWGG")){
      t_1 <- (8*n8)/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8)
      t_2 <- (8*(n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8)
      t_3 <- (8*(n4 + n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8)
      t_4 <- (8*(n3 + n4 + n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8)
      t_5 <- (8*(n2 + n3 - n4 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
    }else if((order_event == "GGGW")){
      t_1 <- (8*n8)/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8)
      t_2 <- (8*(n6 + n8))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8)
      t_3 <- (8*(n4 + n6 + n8))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8)
      t_4 <- (2*(n2 + 2*n4 + 3*n6 + 4*n8))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
    }
  }else if(max_amplification_split == c("8+1") & is_WGD == TRUE){
    if((order_event == "WGGGGGG")){
      t_1 <- (9*n8)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      t_2 <- (9*(n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      t_3 <- (9*(n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      t_4 <- (9*(n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      t_5 <- (9*(n4 + n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      t_6 <- (9*(n3 + n4 + n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      t_7 <- (9*(n2 + n3 + n4 + n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
      amplification_results$t_7 <- t_7
    }else if((order_event == "GWGGGG")){
      t_1 <- (9*n8)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8)
      t_2 <- (9*(n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8)
      t_3 <- (9*(n5 + n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8)
      t_4 <- (9*(n4 + n5 + n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8)
      t_5 <- (9*(n3 + n4 + n5 + n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8)
      t_6 <- (9*(n2 + n3 + n4 + n5 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
    }else if((order_event == "GGWGG")){
      t_1 <- (9*n8)/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8)
      t_2 <- (9*(n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8)
      t_3 <- (9*(n4 + n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8)
      t_4 <- (9*(n3 + n4 + n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8)
      t_5 <- (9*(n2 + n3 - n4 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
    }else if((order_event == "GGGW")){
      t_1 <- (9*n8)/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8)
      t_2 <- (9*(n6 + n8))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8)
      t_3 <- (9*(n4 + n6 + n8))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8)
      t_4 <- (9*(n2 + 2*n4 + 3*n6 + 4*n8))/(4*(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8))
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
    }
  }else if(max_amplification_split == c("8+2") & is_WGD == TRUE){
    if((order_event == "WGGGGGG")){
      t_1 <- (10*n8)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      t_2 <- (10*(n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      t_3 <- (10*(n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      t_4 <- (10*(n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      t_5 <- (10*(n4 + n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      t_6 <- (10*(n3 + n4 + n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      t_7 <- (10*(n2 + n3 + n4 + n5 + n6 + n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
      amplification_results$t_7 <- t_7
    }else if((order_event == "GWGGGG")){
      t_1 <- (10*n8)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8)
      t_2 <- (10*(n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8)
      t_3 <- (10*(n5 + n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8)
      t_4 <- (10*(n4 + n5 + n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8)
      t_5 <- (10*(n3 + n4 + n5 + n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8)
      t_6 <- (10*(n2 + n3 + n4 + n5 - n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
    }else if((order_event == "GGWGG")){
      t_1 <- (10*n8)/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8)
      t_2 <- (10*(n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8)
      t_3 <- (10*(n4 + n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8)
      t_4 <- (10*(n3 + n4 + n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8)
      t_5 <- (10*(n2 + n3 - 2*n4 - n6))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
    }else if((order_event == "GGGW")){
      t_1 <- (10*n8)/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8)
      t_2 <- (10*(n6 + n8))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8)
      t_3 <- (10*(n4 + n6 + n8))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8)
      t_4 <- (2*(n2 + 2*n4 + 3*n6 + 4*n8))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
    }
  }else if(max_amplification_split == c("9+0") & is_WGD == TRUE){
    if(order_event == "WGGGGGGG"){
      t_1 <- (9*n9)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_2 <- (9*(n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_3 <- (9*(n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_4 <- (9*(n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_5 <- (9*(n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_6 <- (9*(n4 + n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_7 <- (9*(n3 + n4 + n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_8 <- (9*(n2 + n3 + n4 + n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
      amplification_results$t_7 <- t_7
      amplification_results$t_8 <- t_8
    }else if(order_event == "GWGGGGG"){
      t_1 <- (9*n9)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      t_2 <- (9*(n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      t_3 <- (9*(n6 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      t_4 <- (9*(n5 + n6 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      t_5 <- (9*(n4 + n5 + n6 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      t_6 <- (9*(n3 + n4 + n5 + n6 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      t_7 <- (9*(n2 + n3 + n4 + n5 + n6 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
      amplification_results$t_7 <- t_7
    }else if(order_event == "GGWGGG"){
      t_1 <- (9*n9)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7 + 9*n9)
      t_2 <- (9*(n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7 + 9*n9)
      t_3 <- (9*(n5 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7 + 9*n9)
      t_4 <- (9*(n4 + n5 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7 + 9*n9)
      t_5 <- (9*(n3 + n4 + n5 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7 + 9*n9)
      t_6 <- (9*(n2 + n3 + n4 - n5 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7 + 9*n9)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
    }else if(order_event == "GGGWG"){
      t_1 <- (9*n9)/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7 + 9*n9)
      t_2 <- (9*(n7 + n9))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7 + 9*n9)
      t_3 <- (9*(n5 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7 + 9*n9)
      t_4 <- (9*(n3 + n5 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7 + 9*n9)
      t_5 <- (9*(n2 - 2*n3 - n5 + n9))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7 + 9*n9)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
    }
  }else if(max_amplification_split == c("9+1") & is_WGD == TRUE){
    if(order_event == "WGGGGGGG"){
      t_1 <- (10*n9)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_2 <- (10*(n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_3 <- (10*(n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_4 <- (10*(n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_5 <- (10*(n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_6 <- (10*(n4 + n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_7 <- (10*(n3 + n4 + n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_8 <- (10*(n2 + n3 + n4 + n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
      amplification_results$t_7 <- t_7
      amplification_results$t_8 <- t_8
    }else if(order_event == "GWGGGGG"){
      t_1 <- (10*n9)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      t_2 <- (10*(n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      t_3 <- (10*(n6 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      t_4 <- (10*(n5 + n6 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      t_5 <- (10*(n4 + n5 + n6 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      t_6 <- (10*(n3 + n4 + n5 + n6 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      t_7 <- (10*(n2 + n3 + n4 + n5 + n6 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
      amplification_results$t_7 <- t_7
    }else if(order_event == "GGWGGG"){
      t_1 <- (10*n9)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7 + 9*n9)
      t_2 <- (10*(n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7 + 9*n9)
      t_3 <- (10*(n5 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7 + 9*n9)
      t_4 <- (10*(n4 + n5 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7 + 9*n9)
      t_5 <- (10*(n3 + n4 + n5 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7 + 9*n9)
      t_6 <- (10*(n2 + n3 + n4  - n5 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7 + 9*n9)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
    }else if(order_event == "GGGWG"){
      t_1 <- (10*n9)/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7 + 9*n9)
      t_2 <- (10*(n7 + n9))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7 + 9*n9)
      t_3 <- (10*(n5 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7 + 9*n9)
      t_4 <- (10*(n3 + n5 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7 + 9*n9)
      t_5 <- (10*(n2 - 2*n3 - n5 + n9))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7 + 9*n9)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
    }
  }else if(max_amplification_split == c("9+2") & is_WGD == TRUE){
    if(order_event == "WGGGGGGG"){
      t_1 <- (11*(n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_2 <- (11*(n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_3 <- (11*(n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_4 <- (11*(n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_5 <- (11*(n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_6 <- (11*(n4 + n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_7 <- (11*(n3 + n4 + n5 + n6 + n7 + n8 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      t_8 <- (11*(n2 + n3 + n4 + n5 + n6 + n7 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
      amplification_results$t_7 <- t_7
      amplification_results$t_8 <- t_8
    }else if(order_event == "GWGGGGG"){
      t_1 <- (11*(n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      t_2 <- (11*(n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      t_3 <- (11*(n6 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      t_4 <- (11*(n5 + n6 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      t_5 <- (11*(n4 + n5 + n6 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      t_6 <- (11*(n3 + n4 + n5 + n6 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      t_7 <- (11*(n2 + n3 + n4 + n5 + n6 - n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 9*n9)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
      amplification_results$t_7 <- t_7
    }else if(order_event == "GGWGGG"){
      t_1 <- (11*(n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7 + 9*n9)
      t_2 <- (11*(n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7 + 9*n9)
      t_3 <- (11*(n5 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7 + 9*n9)
      t_4 <- (11*(n4 + n5 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7 + 9*n9)
      t_5 <- (11*(n3 + n4 + n5 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7 + 9*n9)
      t_6 <- (11*(n2 + n3 + n4 - 2*n5 - n7))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 7*n7 + 9*n9)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
    }else if(order_event == "GGGWG"){
      t_1 <- (11*(n9))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7 + 9*n9)
      t_2 <- (11*(n7 + n9))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7 + 9*n9)
      t_3 <- (11*(n5 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7 + 9*n9)
      t_4 <- (11*(n3 + n5 + n7 + n9))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7 + 9*n9)
      t_5 <- (11*(n2 - 3*n3 - 2*n5 - n7))/(n1 + 2*n2 + 3*n3 + 5*n5 + 7*n7 + 9*n9)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
    }
  }else if(max_amplification_split == c("10+0") & is_WGD == TRUE){
    # WGGGGGGGG  
    if(order_event == "WGGGGGGGG"){
      t_1 <- (10*n10)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_2 <- (10*(n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_3 <- (10*(n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_4 <- (10*(n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_5 <- (10*(n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_6 <- (10*(n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_7 <- (10*(n4 + n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_8 <- (10*(n3 + n4 + n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_9 <- (10*(n2 + n3 + n4 + n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
      amplification_results$t_7 <- t_7
      amplification_results$t_8 <- t_8
      amplification_results$t_9 <- t_9
    }else if(order_event == "GWGGGGGG"){# GWGGGGGG 
      t_1 <- (10*n10)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_2 <- (10*(n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_3 <- (10*(n7 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_4 <- (10*(n6 + n7 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_5 <- (10*(n5 + n6 + n7 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_6 <- (10*(n4 + n5 + n6 + n7 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_7 <- (10*(n3 + n4 + n5 + n6 + n7 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_8 <- (10*(n2 + n3 + n4 + n5 + n6 + n7 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
      amplification_results$t_7 <- t_7
      amplification_results$t_8 <- t_8
    }else if(order_event == "GGWGGGG"){# GGWGGGG
      t_1 <- (10*n10)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      t_2 <- (10*(n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      t_3 <- (10*(n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      t_4 <- (10*(n5 + n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      t_5 <- (10*(n4 + n5 + n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      t_6 <- (10*(n3 + n4 + n5 + n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      t_7 <- (10*(n2 + n3 + n4 + n5 - n6 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
      amplification_results$t_7 <- t_7
    }else if(order_event == "GGGWGG"){# GGGWGG
      t_1 <- (10*n10)/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_2 <- (10*(n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_3 <- (10*(n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_4 <- (10*(n4 + n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_5 <- (10*(n3 + n4 + n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_6 <- (10*(n2 + n3 - 2*n4 - n6 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
    }else if(order_event == "GGGGW"){# GGGGW
      t_1 <- (10*n10)/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_2 <- (10*(n8 + n10))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_3 <- (10*(n6 + n8 + n10))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_4 <- (10*(n4 + n6 + n8 + n10))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_5 <- (2*(n2 + 2*n4 + 3*n6 + 4*n8 + 5*n10))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
    }
  }else if(max_amplification_split == c("10+1") & is_WGD == TRUE){
    # WGGGGGGGG  
    if(order_event == "WGGGGGGGG"){
      t_1 <- (11*n10)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_2 <- (11*(n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_3 <- (11*(n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_4 <- (11*(n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_5 <- (11*(n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_6 <- (11*(n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_7 <- (11*(n4 + n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_8 <- (11*(n3 + n4 + n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_9 <- (11*(n2 + n3 + n4 + n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
      amplification_results$t_7 <- t_7
      amplification_results$t_8 <- t_8
      amplification_results$t_9 <- t_9
    }else if(order_event == "GWGGGGGG"){# GWGGGGGG 
      t_1 <- (11*n10)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_2 <- (11*(n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_3 <- (11*(n7 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_4 <- (11*(n6 + n7 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_5 <- (11*(n5 + n6 + n7 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_6 <- (11*(n4 + n5 + n6 + n7 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_7 <- (11*(n3 + n4 + n5 + n6 + n7 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_8 <- (11*(n2 + n3 + n4 + n5 + n6 + n7 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
      amplification_results$t_7 <- t_7
      amplification_results$t_8 <- t_8
    }else if(order_event == "GGWGGGG"){# GGWGGGG
      t_1 <- (11*n10)/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      t_2 <- (11*(n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      t_3 <- (11*(n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      t_4 <- (11*(n5 + n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      t_5 <- (11*(n4 + n5 + n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      t_6 <- (11*(n3 + n4 + n5 + n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      t_7 <- (11*(n2 + n3 + n4 + n5 - n6 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
      amplification_results$t_7 <- t_7
    }else if(order_event == "GGGWGG"){# GGGWGG
      t_1 <- (11*n10)/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_2 <- (11*(n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_3 <- (11*(n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_4 <- (11*(n4 + n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_5 <- (11*(n3 + n4 + n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_6 <- (11*(n2 + n3 - 2*n4 - n6 + n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
    }else if(order_event == "GGGGW"){# GGGGW
      t_1 <- (11*n10)/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_2 <- (11*(n8 + n10))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_3 <- (11*(n6 + n8 + n10))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_4 <- (11*(n4 + n6 + n8 + n10))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_5 <- (11*(n2 + 2*n4 + 3*n6 + 4*n8 + 5*n10))/(5*(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8 + 10*n10))
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
    }
  }else if(max_amplification_split == c("10+2") & is_WGD == TRUE){
    # WGGGGGGGG  
    if(order_event == "WGGGGGGGG"){
      t_1 <- (12*(n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_2 <- (12*(n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_3 <- (12*(n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_4 <- (12*(n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_5 <- (12*(n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_6 <- (12*(n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_7 <- (12*(n4 + n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_8 <- (12*(n3 + n4 + n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      t_9 <- (12*(n2 + n3 + n4 + n5 + n6 + n7 + n8 + n9 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 9*n9 + 10*n10)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
      amplification_results$t_7 <- t_7
      amplification_results$t_8 <- t_8
      amplification_results$t_9 <- t_9
    }else if(order_event == "GWGGGGGG"){# GWGGGGGG 
      t_1 <- (12*(n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_2 <- (12*(n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_3 <- (12*(n7 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_4 <- (12*(n6 + n7 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_5 <- (12*(n5 + n6 + n7 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_6 <- (12*(n4 + n5 + n6 + n7 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_7 <- (12*(n3 + n4 + n5 + n6 + n7 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      t_8 <- (12*(n2 + n3 + n4 + n5 + n6 + n7 - n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 7*n7 + 8*n8 + 10*n10)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
      amplification_results$t_7 <- t_7
      amplification_results$t_8 <- t_8
    }else if(order_event == "GGWGGGG"){# GGWGGGG
      t_1 <- (12*(n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      t_2 <- (12*(n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      t_3 <- (12*(n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      t_4 <- (12*(n5 + n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      t_5 <- (12*(n4 + n5 + n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      t_6 <- (12*(n3 + n4 + n5 + n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      t_7 <- (12*(n2 + n3 + n4 + n5 - 2*n6 - n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 5*n5 + 6*n6 + 8*n8 + 10*n10)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
      amplification_results$t_7 <- t_7
    }else if(order_event == "GGGWGG"){# GGGWGG
      t_1 <- (12*(n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_2 <- (12*(n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_3 <- (12*(n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_4 <- (12*(n4 + n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_5 <- (12*(n3 + n4 + n6 + n8 + n10))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_6 <- (12*(n2 + n3 - 3*n4 - 2*n6 - n8))/(n1 + 2*n2 + 3*n3 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
      amplification_results$t_6 <- t_6
    }else if(order_event == "GGGGW"){# GGGGW
      t_1 <- (12*(n10))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_2 <- (12*(n8 + n10))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_3 <- (12*(n6 + n8 + n10))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_4 <- (12*(n4 + n6 + n8 + n10))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      t_5 <- (2*(n2 + 2*n4 + 3*n6 + 4*n8 + 5*n10))/(n1 + 2*n2 + 4*n4 + 6*n6 + 8*n8 + 10*n10)
      
      amplification_results$t_1 <- t_1
      amplification_results$t_2 <- t_2
      amplification_results$t_3 <- t_3
      amplification_results$t_4 <- t_4
      amplification_results$t_5 <- t_5
    }else{
      amplification_results$event_order <- "Something went wrong"
    }
  }
  return(amplification_results)
}


################################################################################
#' Amplification timing - MODIFIED VERSION FOR SYNTHETIC DATA TESTING!!!!
#'
#' Wrapper function that times individual amplification events for a locus that has been gained multiple times.
#' @param cn_data 
#' Data frame containing copy number information derived from Battenberg.
#' The data frame must contain the following column names: "chr","startpos","endpos","nMaj1_A","nMin1_A"
#' 
#' @param multiplicity_data 
#' Data frame containing multiplicity information derived from DPClust3p.
#' The data frame must contain the following column names: "chr","end","no.chrs.bearing.mut"
#' 
#' @param mutation_data 
#' Data frame containing mutation data, including Ref and Alt alleles. Columns must be "chr","start","end","ref","alt". 
#' This file is required if muts_type = "All", as mutation context is required to 
#' identify clocklike mutations (C>T at CpG), and should contain all mutations. 
#' If muts_type == "SBS1 and SBS5" this file should contain only mutations that 
#' have been assigned to mutational signatures SBS1 or SBS5. 
#' 
#' @param muts_type
#' Must be one of "SBS1 and SBS5" or "All". Default is set to "All".  If set to "All", 
#' the mutation_data field must be supplied, and the code will be restricted to analysis of clock-like mutations (C>T mutations at CpG sites). If set to "SBS1 and SBS5", the multiplicity_data data frame should have been filtered so as to contain only mutations that have been attributed to mutational signatures SBS1 and SBS5.
#' 
#' @param sample_id 
#' ID name or label for sample. Character.
#' 
#' @param amplification_chrom 
#' Chromosome of the amplified region. Must not contain "chr" in the name. 
#' 
#' @param amplification_start 
#' Start position of the amplified region. Numeric.
#' 
#' @param amplification_stop 
#' End position of the amplified region.  Numeric.
#' 
#' @param is_WGD 
#' logical: TRUE indicates that the sample has been whole genome duplicated.
#' FALSE indicates that the sample has not been whole duplicated.
#' 
#' @param genome
#' Reference genome used. Must be one of "hg19" or "hg38".
#' 
#' @param order_to_time the order to time for matching/mismatching equations - additional modification
#' 
#' @return A data frame containing approximate timing of each amplification, and the most likely order of events. 
#' @example inst/example/example.R
#' @export

time_amplification_custom <- function(cn_data, 
                               multiplicity_data, 
                               mutation_data,
                               muts_type="All",
                               sample_id,
                               amplification_chrom, 
                               amplification_start, 
                               amplification_stop, 
                               is_WGD,
                               genome,
                               order_to_time){
  
  ##############################################################################
  # Check input
  
  # Input is right type
  if(class(cn_data)[1] != "data.frame"){
    stop("'cn_data' must be an object of type 'data.frame'")
  }
  if(class(multiplicity_data)[1] != "data.frame"){
    stop("'multiplicity_data' must be an object of class 'data.frame'")
  }

  if(class(mutation_data)[1] != "data.frame"){
    stop("'mutation_data' must be an object of class 'data.frame'")
  }

  if(!is.character(sample_id)){
    stop("'sample_id' must be an object of type 'character'")
  }
  if((amplification_chrom %in% c("1","2","3","4","5","6","7","8","9","10",
                                 "11","12","13","14","15","16","17","18","19","20",
                                 "21","22","X","Y")) == FALSE){
    stop("Invalid chromosome supplied")
  }
  if(!is.numeric(amplification_start)){
    stop("'amplification_start' must be an object of type 'numeric'")
  }
  if(!is.numeric(amplification_stop)){
    stop("'amplification_stop' must be an object of type 'numeric'")
  }
  if(!is.logical(is_WGD)){
    stop("'is_WGD' must be either 'TRUE' or 'FALSE'")
  }
  if(!(muts_type %in% c("All","SBS1 and SBS5"))){
    stop("'muts_type' must be either 'All' or 'SBS1 and SBS5'")
  }
  if(!(genome %in% c("hg19","hg38"))){
    stop("'muts_type' must be either 'hg19' or 'hg38'")
  }
  if(!all(c("chr","start","end","ref","alt") %in% colnames(mutation_data))){
      stop("'mutation_data' must contain the following columns: 'chr','start','end','ref','alt'.")
  }
  if(muts_type == "All"){
    if(is.na(genome)){
      stop("'genome' must be supplied when 'muts_type' = 'All'.")
    }
  }
  
  # Input has right columns
  if(!all(c("chr","startpos","endpos","nMaj1_A","nMin1_A") %in% colnames(cn_data))){
    stop("Incorrect column names in 'cn_data'")
  }
  if(!all(c("chr","end","no.chrs.bearing.mut") %in% colnames(multiplicity_data))){
    stop("Incorrect column names in 'multiplicity_data'")
  }
  # mutation data input is checked in clocklike_muts function
  
  
  # Input has non-zero number of rows
  if(nrow(cn_data) == 0){
    stop("'cn_file' has no content")
  }
  if(nrow(multiplicity_data) == 0){
    stop("'multiplicity_data' has no content")
  }
  if(nrow(mutation_data) == 0){
    stop("'mutation_data' has no content")
  }
  
  # 
  
  ##############################################################################
  # subset copy number file for amplified region
  tmp_cn <- subset(cn_data, chr == amplification_chrom &
                     startpos <= amplification_stop &
                     endpos >= amplification_start)
  
  if(nrow(tmp_cn) == 0){
    stop("Cannot subset 'cn_data' for this region.  Double-check the region specified, and that copy number has been called in this region. ")
  }
  
  tmp_cn$length <- (tmp_cn$end - tmp_cn$start)+1
  
  tmp_cn$n1A <- paste(tmp_cn$nMaj1_A, "+", tmp_cn$nMin1_A, sep = "")
  tmp_cn$n1A_sum <- tmp_cn$nMaj1_A + tmp_cn$nMin1_A
  
  if(c("nMaj2_A") %in% colnames(tmp_cn)){
    tmp_cn$n2A <- paste(tmp_cn$nMaj2_A, "+", tmp_cn$nMin2_A, sep = "")
    tmp_cn$n2A_sum <- tmp_cn$nMaj2_A + tmp_cn$nMin2_A
  }
  
  ##############################################################################
  # subset multiplicity for amplified region based on CN data
  tmp_mult <- subset(multiplicity_data, chr == tmp_cn$chr & 
                       end >= tmp_cn$start & 
                       end <= tmp_cn$end )
  if(nrow(tmp_mult) == 0){
    stop("Cannot subset 'multiplicity_data' for this region.  Cannot run analysis if there are no mutations in this region.")
  }
  if(nrow(tmp_mult) < 3){
    stop("Cannot subset 'multiplicity_data' for this region.  Cannot run analysis if there are fewer than 3 mutations in this region.")
  }
  tmp_mult$no.chrs.bearing.mut.ceiling <- ceiling(tmp_mult$no.chrs.bearing.mut)
  
  ###
  # Assuming region is spanned by 1 copy number segment
  # adjust later to account for partially gained regions
  ###
  
  ##############################################################################
  # Check if region is amplified
  # Cannot run code if region is not amplified
  
  is_amplified <- NA
  
  if(c("n2A_sum") %in% colnames(tmp_cn)){
    if(is_WGD == FALSE & tmp_cn$n1A_sum <= 2 & tmp_cn$n2A_sum <= 2 & tmp_cn$nMin1_A > 0 & tmp_cn$nMin2_A > 0){
      stop("Region not amplified in sample")
      
    }else if(is_WGD == TRUE & tmp_cn$n1A_sum <= 2 & tmp_cn$n2A_sum <= 2 & tmp_cn$nMin1_A > 0 & tmp_cn$nMin2_A > 0){
      stop("Region not amplified in sample")
      
    }else if(tmp_cn$n1A == "1+1" & tmp_cn$n2A == "1+0"){
      stop("Region not amplified in sample")
    }else{
      is_amplified <- TRUE
    }
  }else{
    if(is_WGD == FALSE & tmp_cn$n1A_sum <= 2 & tmp_cn$nMin1_A > 0){
      stop("Region not amplified in sample")
      
    }else if(is_WGD == TRUE & tmp_cn$n1A_sum <= 2 & tmp_cn$nMin1_A > 0){
      stop("Region not amplified in sample")
      
    }else{
      is_amplified <- TRUE
    }
  }
  
  # get the highest copy number value - assume lower value has same timing
  if((c("n2A_sum") %in% colnames(tmp_cn))){
    max_amplification <- names(which.max(tmp_cn[,c("n1A_sum","n2A_sum")]))
    if(max_amplification == c("n1A_sum")){
      max_amplification_split <- tmp_cn$n1A
    }else if(max_amplification == c("n2A_sum")){
      max_amplification_split <- tmp_cn$n2A
    }
    if( !is.na(tmp_cn$n2A_sum)){
      clonality_status <- "subclonal"
    }else{
      clonality_status <- "clonal"
    }
  }else{
    max_amplification_split <- tmp_cn$n1A
    clonality_status <- "clonal"
  }
  
  
  ##############################################################################
  # Infer order of events using all mutations
  
  # Get all of the multiplicities to feed into time_amplification_maths
  tmp_values <- tmp_mult$no.chrs.bearing.mut.ceiling
  event_ordering <- order_to_time
    # commented code below for custom function for looking at mismatch between timing and simulation
    # get_order_events(multiplicity_values = tmp_values, 
    #                                  max_amplification_split = max_amplification_split, 
    #                                  is_WGD = is_WGD)
    # 
  ##############################################################################
  # if "All" mutations have been supplied, identify clock-like mutations
  # then subset multiplicity file for those mutations only
  # Overwrites tmp_mult object
  
  if(muts_type == "All"){
    
    clocklike_mutations <- clocklike_muts(mutation = mutation_data, genome = genome)
    clocklike_mutations$seqnames <- gsub("chr","",clocklike_mutations$seqnames)
    tmp_mult_clocklike <- merge(tmp_mult, clocklike_mutations[,c("seqnames","end")], 
                                by.x = c("chr","end"),
                                by.y = c("seqnames","end"))
    
    tmp_mult <- tmp_mult_clocklike
    
    if(nrow(tmp_mult) == 0){
      stop("Cannot subset 'multiplicity_data' for this region.  There are no clock-like mutations in this region.")
    }
    if(nrow(tmp_mult) < 3){
      stop("Cannot run analysis if there are fewer than 3 mutations in this region.")
    }
    
  }
  
  ##############################################################################
  # if "SBS1 ans SBS5" mutations have been supplied, identify matching multiplicities
  # then subset multiplicity file for those mutations only
  # Overwrites tmp_mult object
  
  if(muts_type == "SBS1 and SBS5"){
    nucleotides <- c("A","T","G","C")
    
    muts <- mutation_data[mutation_data$ref %in% nucleotides & mutation_data$alt %in% nucleotides,]
    
    tmp_mult_clocklike <- merge(tmp_mult, muts,
                                by.x = c("chr","end"),
                                by.y = c("chr","end"))
    
    tmp_mult <- tmp_mult_clocklike
    
    if(nrow(tmp_mult) == 0){
      stop("Cannot subset 'multiplicity_data' for this region.  There are no SBS1 and SBS5 mutations in this region.")
    }
    if(nrow(tmp_mult) < 3){
      stop("Cannot run analysis if there are fewer than 3 mutations in this region.")
    }
  }
  
  ##############################################################################
  # Get all of the multiplicities to feed into time_amplification_maths
  tmp_values <- tmp_mult$no.chrs.bearing.mut.ceiling
  
  ##############################################################################
  # Prepare output table
  
  if(is_amplified == TRUE){
    amplification_results_ci <- as.data.frame(matrix(nrow=1, ncol = 47))
    colnames(amplification_results_ci) <- c("sample","region","highest_copy_number","event_order","num_mutations_used","clonality_status","flags",
                                            "t_1","t_1_mean_bootstrap","t_1_lower_ci","t_1_upper_ci",
                                            "t_2","t_2_mean_bootstrap","t_2_lower_ci","t_2_upper_ci",
                                            "t_3","t_3_mean_bootstrap","t_3_lower_ci","t_3_upper_ci",
                                            "t_4","t_4_mean_bootstrap","t_4_lower_ci","t_4_upper_ci",
                                            "t_5","t_5_mean_bootstrap","t_5_lower_ci","t_5_upper_ci",
                                            "t_6","t_6_mean_bootstrap","t_6_lower_ci","t_6_upper_ci",
                                            "t_7","t_7_mean_bootstrap","t_7_lower_ci","t_7_upper_ci",
                                            "t_8","t_8_mean_bootstrap","t_8_lower_ci","t_8_upper_ci",
                                            "t_9","t_9_mean_bootstrap","t_9_lower_ci","t_9_upper_ci",
                                            "t_10","t_10_mean_bootstrap","t_10_lower_ci","t_10_upper_ci")
    
    amplification_results_ci$sample <- sample_id
    amplification_results_ci$region <- paste(tmp_cn$chr,":",tmp_cn$start,"-",tmp_cn$end, sep = "")
    amplification_results_ci$highest_copy_number <- max_amplification_split
    amplification_results_ci$num_mutations_used <- length(tmp_values)
    amplification_results_ci$clonality_status <- clonality_status
    
    ############################################################################
    # Get timing estimate based on raw data (subsetted for clock-like or signature mutations)
    
    single_time <- time_amplification_maths(mult_data = tmp_values, 
                                            max_amp = max_amplification_split, 
                                            is_WGD = is_WGD, 
                                            ordering_event = event_ordering)
    amplification_results_ci$event_order <- event_ordering                                                                                         
    
    ############################################################################
    # Get a bootstrap estimate of amplification times
    
    bootstrap_amplification <- as.data.frame(matrix(nrow = 500, ncol = 12))
    colnames(bootstrap_amplification) <- c("highest_copy_number","event_order",
                                           "t_1","t_2","t_3","t_4","t_5",
                                           "t_6","t_7","t_8","t_9","t_10")
    
    for(b in 1:nrow(bootstrap_amplification)){
      
      temp_multsample <- sample(tmp_values, length(tmp_values), replace = TRUE)
      bootstrap_amplification[b,1:12] <- time_amplification_maths(mult_data = temp_multsample, 
                                                                  max_amp = max_amplification_split,
                                                                  is_WGD = is_WGD,
                                                                  ordering_event = event_ordering)
    }
    
    ############################################################################
    # Calculate confidence intervals and mean timing from bootstrap results
    # Include everything in the output results
    
    if(!is.na(single_time$t_1)){
      amplification_results_ci$t_1 <- single_time$t_1
      amplification_results_ci$t_1_mean_bootstrap <- mean(bootstrap_amplification$t_1, na.rm = TRUE)
      t_1_lower_ci <- confint(lm(t_1 ~ 1, bootstrap_amplification), level = 0.95)[1]
      # t_1_lower_ci_adj <- ((length(tmp_values)*t_1_lower_ci)/(5 + length(tmp_values)))
      t_1_upper_ci <- confint(lm(t_1 ~ 1, bootstrap_amplification), level = 0.95)[2]
      # t_1_upper_ci_adj <- ((5 + (length(tmp_values)*t_1_upper_ci))/(5 + length(tmp_values)))
      amplification_results_ci$t_1_lower_ci <- t_1_lower_ci
      amplification_results_ci$t_1_upper_ci <- t_1_upper_ci
    }
    if(!is.na(single_time$t_2)){
      amplification_results_ci$t_2 <- single_time$t_2
      amplification_results_ci$t_2_mean_bootstrap <- mean(bootstrap_amplification$t_2, na.rm = TRUE)
      t_2_lower_ci <- confint(lm(t_2 ~ 1, bootstrap_amplification), level = 0.95)[1]
      # t_2_lower_ci_adj <- ((length(tmp_values)*t_2_lower_ci)/(5 + length(tmp_values)))
      t_2_upper_ci <- confint(lm(t_2 ~ 1, bootstrap_amplification), level = 0.95)[2]
      # t_2_upper_ci_adj <- ((5 + (length(tmp_values)*t_2_upper_ci))/(5 + length(tmp_values)))
      amplification_results_ci$t_2_lower_ci <- t_2_lower_ci
      amplification_results_ci$t_2_upper_ci <- t_2_upper_ci
    }
    if(!is.na(single_time$t_3)){
      amplification_results_ci$t_3 <- single_time$t_3
      amplification_results_ci$t_3_mean_bootstrap <- mean(bootstrap_amplification$t_3, na.rm = TRUE)
      t_3_lower_ci <- confint(lm(t_3 ~ 1, bootstrap_amplification), level = 0.95)[1]
      # t_3_lower_ci_adj <- ((length(tmp_values)*t_3_lower_ci)/(5 + length(tmp_values)))
      t_3_upper_ci <- confint(lm(t_3 ~ 1, bootstrap_amplification), level = 0.95)[2]
      # t_3_upper_ci_adj <- ((5 + (length(tmp_values)*t_3_upper_ci))/(5 + length(tmp_values)))
      amplification_results_ci$t_3_lower_ci <- t_3_lower_ci
      amplification_results_ci$t_3_upper_ci <- t_3_upper_ci
    }
    if(!is.na(single_time$t_4)){
      amplification_results_ci$t_4 <- single_time$t_4
      amplification_results_ci$t_4_mean_bootstrap <- mean(bootstrap_amplification$t_4, na.rm = TRUE)
      t_4_lower_ci <- confint(lm(t_4 ~ 1, bootstrap_amplification), level = 0.95)[1]
      # t_4_lower_ci_adj <- ((length(tmp_values)*t_4_lower_ci)/(5 + length(tmp_values)))
      t_4_upper_ci <- confint(lm(t_4 ~ 1, bootstrap_amplification), level = 0.95)[2]
      # t_4_upper_ci_adj <- ((5 + (length(tmp_values)*t_4_upper_ci))/(5 + length(tmp_values)))
      amplification_results_ci$t_4_lower_ci <- t_4_lower_ci
      amplification_results_ci$t_4_upper_ci <- t_4_upper_ci
    }
    if(!is.na(single_time$t_5)){
      amplification_results_ci$t_5 <- single_time$t_5
      amplification_results_ci$t_5_mean_bootstrap <- mean(bootstrap_amplification$t_5, na.rm = TRUE)
      t_5_lower_ci <- confint(lm(t_5 ~ 1, bootstrap_amplification), level = 0.95)[1]
      # t_5_lower_ci_adj <- ((length(tmp_values)*t_5_lower_ci)/(5 + length(tmp_values)))
      t_5_upper_ci <- confint(lm(t_5 ~ 1, bootstrap_amplification), level = 0.95)[2]
      # t_5_upper_ci_adj <- ((5 + (length(tmp_values)*t_5_upper_ci))/(5 + length(tmp_values)))
      amplification_results_ci$t_5_lower_ci <- t_5_lower_ci
      amplification_results_ci$t_5_upper_ci <- t_5_upper_ci
    }
    if(!is.na(single_time$t_6)){
      amplification_results_ci$t_6 <- single_time$t_6
      amplification_results_ci$t_6_mean_bootstrap <- mean(bootstrap_amplification$t_6, na.rm = TRUE)
      t_6_lower_ci <- confint(lm(t_6 ~ 1, bootstrap_amplification), level = 0.95)[1]
      # t_6_lower_ci_adj <- ((length(tmp_values)*t_6_lower_ci)/(5 + length(tmp_values)))
      t_6_upper_ci <- confint(lm(t_6 ~ 1, bootstrap_amplification), level = 0.95)[2]
      # t_6_upper_ci_adj <- ((5 + (length(tmp_values)*t_6_upper_ci))/(5 + length(tmp_values)))
      amplification_results_ci$t_6_lower_ci <- t_6_lower_ci
      amplification_results_ci$t_6_upper_ci <- t_6_upper_ci
    }
    if(!is.na(single_time$t_7)){
      amplification_results_ci$t_7 <- single_time$t_7
      amplification_results_ci$t_7_mean_bootstrap <- mean(bootstrap_amplification$t_7, na.rm = TRUE)
      t_7_lower_ci <- confint(lm(t_7 ~ 1, bootstrap_amplification), level = 0.95)[1]
      # t_7_lower_ci_adj <- ((length(tmp_values)*t_7_lower_ci)/(5 + length(tmp_values)))
      t_7_upper_ci <- confint(lm(t_7 ~ 1, bootstrap_amplification), level = 0.95)[2]
      # t_7_upper_ci_adj <- ((5 + (length(tmp_values)*t_7_upper_ci))/(5 + length(tmp_values)))
      amplification_results_ci$t_7_lower_ci <- t_7_lower_ci
      amplification_results_ci$t_7_upper_ci <- t_7_upper_ci
    }
    if(!is.na(single_time$t_8)){
      amplification_results_ci$t_8 <- single_time$t_8
      amplification_results_ci$t_8_mean_bootstrap <- mean(bootstrap_amplification$t_8, na.rm = TRUE)
      t_8_lower_ci <- confint(lm(t_8 ~ 1, bootstrap_amplification), level = 0.95)[1]
      # t_8_lower_ci_adj <- ((length(tmp_values)*t_8_lower_ci)/(5 + length(tmp_values)))
      t_8_upper_ci <- confint(lm(t_8 ~ 1, bootstrap_amplification), level = 0.95)[2]
      # t_8_upper_ci_adj <- ((5 + (length(tmp_values)*t_8_upper_ci))/(5 + length(tmp_values)))
      amplification_results_ci$t_8_lower_ci <- t_8_lower_ci
      amplification_results_ci$t_8_upper_ci <- t_8_upper_ci
    }
    if(!is.na(single_time$t_9)){
      amplification_results_ci$t_9 <- single_time$t_9
      amplification_results_ci$t_9_mean_bootstrap <- mean(bootstrap_amplification$t_9, na.rm = TRUE)
      t_9_lower_ci <- confint(lm(t_9 ~ 1, bootstrap_amplification), level = 0.95)[1]
      # t_9_lower_ci_adj <- ((length(tmp_values)*t_9_lower_ci)/(5 + length(tmp_values)))
      t_9_upper_ci <- confint(lm(t_9 ~ 1, bootstrap_amplification), level = 0.95)[2]
      # t_9_upper_ci_adj <- ((5 + (length(tmp_values)*t_9_upper_ci))/(5 + length(tmp_values)))
      amplification_results_ci$t_9_lower_ci <- t_9_lower_ci
      amplification_results_ci$t_9_upper_ci <- t_9_upper_ci
    }
    if(!is.na(single_time$t_10)){
      amplification_results_ci$t_10 <- single_time$t_10
      amplification_results_ci$t_10_mean_bootstrap <- mean(bootstrap_amplification$t_10, na.rm = TRUE)
      t_10_lower_ci <- confint(lm(t_10 ~ 1, bootstrap_amplification), level = 0.95)[1]
      # t_10_lower_ci_adj <- ((length(tmp_values)*t_10_lower_ci)/(5 + length(tmp_values)))
      t_10_upper_ci <- confint(lm(t_10 ~ 1, bootstrap_amplification), level = 0.95)[2]
      # t_10_upper_ci_adj <- ((5 + (length(tmp_values)*t_10_upper_ci))/(5 + length(tmp_values)))
      amplification_results_ci$t_10_lower_ci <- t_10_lower_ci
      amplification_results_ci$t_10_upper_ci <- t_10_upper_ci
    }
    
  }
  
  return(amplification_results_ci)
}



```

## Testing equations
### Make mutation bag
```{r}
make_mutation_bag <- function(cn_state, 
                              event_order, 
                              number_of_mutations_to_generate,
                              mutation_rate_m,
                              generated_event_times,
                              multinomial){
  
  # List out equations for all n for all CN states and orders...
  if(cn_state == "2+0" & event_order == "G"){
    mutations_n1 <- (2*mutation_rate_m)*(1 - (generated_event_times[1]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                   rep(2, multinom_out[2]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number))
    }
    
    
  }else if(cn_state == "2+1" & event_order == "G"){
    
    mutations_n1 <- mutation_rate_m*(3 - (2*generated_event_times[1]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                   rep(2, multinom_out[2]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number))
    }
    
    
  }else if(cn_state == "3+0" & event_order == "GG"){
    
    mutations_n1 <- mutation_rate_m*(3 - (generated_event_times[1]) - (2*generated_event_times[2]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n3 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number))
    }
    
    
  }else if(cn_state == "3+1" & event_order == "GG"){
    mutations_n1 <- mutation_rate_m*(4 - (generated_event_times[1]) - (2*generated_event_times[2]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n3 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number))
    }
    
    
  }else if(cn_state == "4+0" & event_order == "GGG"){
    mutations_n1 <- mutation_rate_m*(4 - (generated_event_times[1]) - (generated_event_times[2]) - (2*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n3 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n4 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number))
    }
    
  }else if(cn_state == "4+1" & event_order == "GGG"){
    mutations_n1 <- mutation_rate_m*(5 - (generated_event_times[1]) - (generated_event_times[2]) - (2*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n3 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n4 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number))
    }
    
  }else if(cn_state == "5+0" & event_order == "GGGG"){
    mutations_n1 <- mutation_rate_m*(5 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n5 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number))
    }
    
  }else if(cn_state == "5+1" & event_order == "GGGG"){
    mutations_n1 <- mutation_rate_m*(6 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n5 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number))
    }
    
  }else if(cn_state == "6+0" & event_order == "GGGGG"){
    mutations_n1 <- mutation_rate_m*(6 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number))
    }
    
  }else if(cn_state == "6+1" & event_order == "GGGGG"){
    mutations_n1 <- mutation_rate_m*(7 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number))
    }
    
  }else if(cn_state == "7+0" & event_order == "GGGGGG"){
    mutations_n1 <- mutation_rate_m*(7 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (generated_event_times[5]) - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "7+1" & event_order == "GGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (generated_event_times[5]) - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "8+0" & event_order == "GGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (generated_event_times[5]) - (generated_event_times[6]) - (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n3 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+1" & event_order == "GGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (generated_event_times[5]) - (generated_event_times[6]) - (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n3 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "9+0" & event_order == "GGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (generated_event_times[5]) - (generated_event_times[6]) - (generated_event_times[7]) - (2*generated_event_times[8]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[8] - generated_event_times[7])
    mutations_n3 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n4 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n5 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n6 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n7 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+1" & event_order == "GGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (generated_event_times[5]) - (generated_event_times[6]) - (generated_event_times[7]) - (2*generated_event_times[8]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[8] - generated_event_times[7])
    mutations_n3 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n4 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n5 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n6 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n7 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "10+0" & event_order == "GGGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (generated_event_times[5]) - (generated_event_times[6]) - (generated_event_times[7]) - (generated_event_times[8]) - (2*generated_event_times[9]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[9] - generated_event_times[8])
    mutations_n3 <- mutation_rate_m*(generated_event_times[8] - generated_event_times[7])
    mutations_n4 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n5 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n6 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n7 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n8 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n9 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]),
                        rep(10, multinom_out[10]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+1" & event_order == "GGGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(11 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (generated_event_times[5]) - (generated_event_times[6]) - (generated_event_times[7]) - (generated_event_times[8]) - (2*generated_event_times[9]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[9] - generated_event_times[8])
    mutations_n3 <- mutation_rate_m*(generated_event_times[8] - generated_event_times[7])
    mutations_n4 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n5 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n6 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n7 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n8 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n9 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]),
                        rep(10, multinom_out[10]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "2+0" & event_order == "W"){
    
    mutations_n1 <- (2*mutation_rate_m)*(1 - generated_event_times[1])
    mutations_n2 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number))
    }
    
    
  }else if(cn_state == "2+1" & event_order == "W"){
    
    mutations_n1 <- mutation_rate_m*(3 - (2*generated_event_times[1]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number))
    }
    
    
  }else if(cn_state == "2+2" & event_order == "W"){
    
    mutations_n1 <- (4*mutation_rate_m)*(1 - generated_event_times[1])
    mutations_n2 <- (2*mutation_rate_m)*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                      rep(2,mutations_n2_number))
    }
    
    
  }else if(cn_state == "3+0" & event_order == "WG"){
    
    mutations_n1 <- mutation_rate_m*(3 - generated_event_times[1] - (2*generated_event_times[2]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n3 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number))
    }
    
    
  }else if(cn_state == "3+1" & event_order == "WG"){
    
    mutations_n1 <- mutation_rate_m*(4 - generated_event_times[1] - (2*generated_event_times[2]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n3 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number))
    }
    
    
  }else if(cn_state == "3+2" & event_order == "WG"){
    
    mutations_n1 <- mutation_rate_m*(5 - (3*generated_event_times[1]) - (2*generated_event_times[2]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2])
    mutations_n3 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number))
    }
    
    
  }else if(cn_state == "4+0" & event_order == "WGG"){
    
    mutations_n1 <- mutation_rate_m*(4 - generated_event_times[1] - generated_event_times[2] - (2*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n3 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n4 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number))
    }
    
    
  }else if(cn_state == "4+0" & event_order == "GW"){
    
    mutations_n1 <- mutation_rate_m*(4 - (4*generated_event_times[2]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[2]) - (2*generated_event_times[1]))
    mutations_n4 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number))
    }
    
    
  }else if(cn_state == "4+1" & event_order == "WGG"){

    mutations_n1 <- mutation_rate_m*(5 - (generated_event_times[1]) - generated_event_times[2] - (2*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n3 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n4 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number))
    }
    
        
  }else if(cn_state == "4+1" & event_order == "GW"){
    
    mutations_n1 <- mutation_rate_m*(5 - (4*generated_event_times[2]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[2]) - (2*generated_event_times[1]))
    mutations_n4 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number))
    }
    
    
  }else if(cn_state == "4+2" & event_order == "WGG"){
    
    mutations_n1 <- mutation_rate_m*(6 - (3*generated_event_times[1]) - generated_event_times[2] - (2*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1] + generated_event_times[3] - generated_event_times[2])
    mutations_n3 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n4 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number))
    }
    
    
  }else if(cn_state == "4+2" & event_order == "GW"){
    
    mutations_n1 <- mutation_rate_m*(6 - (6*generated_event_times[2]))
    mutations_n2 <- mutation_rate_m*((3*generated_event_times[2]) - (2*generated_event_times[1]))
    mutations_n4 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number))
    }
    
    
  }else if(cn_state == "5+0" & event_order == "WGGG"){
    
    mutations_n1 <- mutation_rate_m*(5 - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n5 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number))
    }
    
    
  }else if(cn_state == "5+0" & event_order == "GWG"){
    
    mutations_n1 <- mutation_rate_m*(5 - (3*generated_event_times[2]) - (2*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[1])
    mutations_n3 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n5 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n5
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n5/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(5, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(5,mutations_n5_number))
    }
    
    
  }else if(cn_state == "5+1" & event_order == "WGGG"){
    
    mutations_n1 <- mutation_rate_m*(6 - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n5 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number))
    }
    
    
  }else if(cn_state == "5+1" & event_order == "GWG"){
    
    mutations_n1 <- mutation_rate_m*(6 - (3*generated_event_times[2]) - (2*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[1])
    mutations_n3 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n5 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n5
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n5/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(5, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(5,mutations_n5_number))
    }
    
    
  }else if(cn_state == "5+2" & event_order == "WGGG"){
    
    mutations_n1 <- mutation_rate_m*(7 - (3*generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1] + generated_event_times[4] - generated_event_times[3])
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n5 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number))
    }
    
    
  }else if(cn_state == "5+2" & event_order == "GWG"){
    
    mutations_n1 <- mutation_rate_m*(7 - (5*generated_event_times[2]) - (2*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[3])
    mutations_n3 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n5 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n5
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n5/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(5, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(5,mutations_n5_number))
    }
    
    
  }else if(cn_state == "6+0" & event_order == "WGGGG"){
    
    mutations_n1 <- mutation_rate_m*(6 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number))
    }
    
    
  }else if(cn_state == "6+0" & event_order == "GWGG"){
    
    mutations_n1 <- mutation_rate_m*(6 - (3*generated_event_times[2]) - generated_event_times[3] - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[4] - generated_event_times[3])
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(6, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number))
    }
    
    
  }else if(cn_state == "6+0" & event_order == "GGW"){
    
    mutations_n1 <- mutation_rate_m*(6 - (6*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*((3*generated_event_times[3]) - (2*generated_event_times[2]) - generated_event_times[1])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]),
                        rep(6, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number))
    }
    
    
  }else if(cn_state == "6+1" & event_order == "WGGGG"){
    
    mutations_n1 <- mutation_rate_m*(7 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number))
    }
    
    
  }else if(cn_state == "6+1" & event_order == "GWGG"){
    
    mutations_n1 <- mutation_rate_m*(7 - (3*generated_event_times[2]) - generated_event_times[3] - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[4] - generated_event_times[3])
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(6, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number))
    }
    
    
  }else if(cn_state == "6+1" & event_order == "GGW"){
    
    mutations_n1 <- mutation_rate_m*(7 - (6*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*((3*generated_event_times[3]) - (2*generated_event_times[2]) - generated_event_times[1])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]),
                        rep(6, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number))
    }
    
    
  }else if(cn_state == "6+2" & event_order == "WGGGG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (3*generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1] + generated_event_times[5] - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number))
    }
    
    
  }else if(cn_state == "6+2" & event_order == "GWGG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (5*generated_event_times[2]) - generated_event_times[3] - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[2]) - generated_event_times[1] + generated_event_times[4] - generated_event_times[3])
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(6, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number))
    }
    
    
  }else if(cn_state == "6+2" & event_order == "GGW"){
    
    mutations_n1 <- mutation_rate_m*(8 - (8*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*((4*generated_event_times[3]) - (2*generated_event_times[2]) - generated_event_times[1])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]),
                        rep(6, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number))
    }
    
    
  }else if(cn_state == "7+0" & event_order == "WGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(7 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "7+0" & event_order == "GWGGG"){
    
    mutations_n1 <- mutation_rate_m*(7 - (3*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[5] - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(7, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "7+0" & event_order == "GGWG"){
    
    mutations_n1 <- mutation_rate_m*(7 - (5*generated_event_times[3]) - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[1] - generated_event_times[2] + (generated_event_times[3]))
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n5+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(5, multinom_out[4]),
                        rep(7, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "7+1" & event_order == "WGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "7+1" & event_order == "GWGGG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (3*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[5] - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(7, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "7+1" & event_order == "GGWG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (5*generated_event_times[3]) - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[3]) - generated_event_times[2] - generated_event_times[1] + (generated_event_times[4]))
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n5+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(5, multinom_out[4]),
                        rep(7, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "7+2" & event_order == "WGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (3*generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1] + generated_event_times[6] - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "7+2" & event_order == "GWGGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (5*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[2]) - generated_event_times[1] + generated_event_times[5] - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(7, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "7+2" & event_order == "GGWG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (7*generated_event_times[3]) - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[3]) - generated_event_times[2] - generated_event_times[1] + (generated_event_times[4]))
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n5+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(5, multinom_out[4]),
                        rep(7, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "8+0" & event_order == "WGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n3 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+0" & event_order == "GWGGGG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (3*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[6] - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(8, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+0" & event_order == "GGWGG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (5*generated_event_times[3]) - generated_event_times[4] - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[1] - generated_event_times[2] + (2*generated_event_times[3]) - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*((generated_event_times[4]) - (generated_event_times[3]))
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n6+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(6, multinom_out[5]),
                        rep(8, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+0" & event_order == "GGGW"){
    
    mutations_n1 <- mutation_rate_m*(8 - (8*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*((4*generated_event_times[4]) - generated_event_times[1] - generated_event_times[2] - (2*generated_event_times[3]))
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4+mutations_n6+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]),
                        rep(6, multinom_out[4]),
                        rep(8, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+1" & event_order == "WGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n3 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+1" & event_order == "GWGGGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (3*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[6] - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(8, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+1" & event_order == "GGWGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (5*generated_event_times[3]) - generated_event_times[4] - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[1] - generated_event_times[2] + (2*generated_event_times[3]) - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*((generated_event_times[4]) - (generated_event_times[3]))
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n6+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(6, multinom_out[5]),
                        rep(8, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+1" & event_order == "GGGW"){
    
    mutations_n1 <- mutation_rate_m*(9 - (8*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*((4*generated_event_times[4]) - generated_event_times[1] - generated_event_times[2] - (2*generated_event_times[3]))
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4+mutations_n6+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]),
                        rep(6, multinom_out[4]),
                        rep(8, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+2" & event_order == "WGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (3*generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1] + generated_event_times[7] - generated_event_times[6])
    mutations_n3 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+2" & event_order == "GWGGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (5*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[2]) - generated_event_times[1] + generated_event_times[6] - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(8, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+2" & event_order == "GGWGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (7*generated_event_times[3]) - generated_event_times[4] - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((3*generated_event_times[3]) - generated_event_times[1] - generated_event_times[2] + (generated_event_times[5]) - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*((generated_event_times[4]) - (generated_event_times[3]))
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n6+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(6, multinom_out[5]),
                        rep(8, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+2" & event_order == "GGGW"){
    
    mutations_n1 <- mutation_rate_m*(10 - (10*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*((5*generated_event_times[4]) - generated_event_times[1] - generated_event_times[2] - (2*generated_event_times[3]))
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4+mutations_n6+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]),
                        rep(6, multinom_out[4]),
                        rep(8, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "9+0" & event_order == "WGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - generated_event_times[7] - (2*generated_event_times[8]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[8] - generated_event_times[7])
    mutations_n3 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n4 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n5 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n6 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n7 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+0" & event_order == "GWGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (3*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[7] - generated_event_times[6])
    mutations_n3 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(9, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+0" & event_order == "GGWGGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (5*generated_event_times[3]) - generated_event_times[4] - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[3]) - generated_event_times[2] - generated_event_times[1] - generated_event_times[5] + generated_event_times[6])
    mutations_n3 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*((generated_event_times[4]) - (generated_event_times[3]))
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n7+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(7, multinom_out[6]),
                        rep(9, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+0" & event_order == "GGGWG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (7*generated_event_times[4]) - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] + (2*generated_event_times[4]))
    mutations_n3 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n5+mutations_n7+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(5, multinom_out[4]),
                        rep(7, multinom_out[5]),
                        rep(9, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+1" & event_order == "WGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - generated_event_times[7] - (2*generated_event_times[8]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[8] - generated_event_times[7])
    mutations_n3 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n4 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n5 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n6 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n7 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+1" & event_order == "GWGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (3*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[7] - generated_event_times[6])
    mutations_n3 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(9, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+1" & event_order == "GGWGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (5*generated_event_times[3]) - generated_event_times[4] - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[3]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[5] + generated_event_times[6])
    mutations_n3 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*((generated_event_times[4]) - (generated_event_times[3]))
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n7+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(7, multinom_out[6]),
                        rep(9, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+1" & event_order == "GGGWG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (7*generated_event_times[4]) - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] + (2*generated_event_times[4]))
    mutations_n3 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n5+mutations_n7+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(5, multinom_out[4]),
                        rep(7, multinom_out[5]),
                        rep(9, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+2" & event_order == "WGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(11 - (3*generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - generated_event_times[7] - (2*generated_event_times[8]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1] + generated_event_times[8] - generated_event_times[7])
    mutations_n3 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n4 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n5 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n6 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n7 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+2" & event_order == "GWGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(11 - (5*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[2]) - generated_event_times[1] + generated_event_times[7] - generated_event_times[6])
    mutations_n3 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(9, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+2" & event_order == "GGWGGG"){
    
    mutations_n1 <- mutation_rate_m*(11 - (7*generated_event_times[3]) - generated_event_times[4] - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*((3*generated_event_times[3]) - generated_event_times[1] - generated_event_times[2] + generated_event_times[6] - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*((generated_event_times[4]) - (generated_event_times[3]))
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n7+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(7, multinom_out[6]),
                        rep(9, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+2" & event_order == "GGGWG"){
    
    mutations_n1 <- mutation_rate_m*(11 - (9*generated_event_times[4]) - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] + (3*generated_event_times[4]))
    mutations_n3 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n5+mutations_n7+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(5, multinom_out[4]),
                        rep(7, multinom_out[5]),
                        rep(9, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "10+0" & event_order == "WGGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - generated_event_times[7] - generated_event_times[8] - (2*generated_event_times[9]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[9] - generated_event_times[8])
    mutations_n3 <- mutation_rate_m*(generated_event_times[8] - generated_event_times[7])
    mutations_n4 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n5 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n6 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n7 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n8 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n9 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]),
                        rep(10, multinom_out[10]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+0" & event_order == "GWGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (3*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - generated_event_times[7] - (2*generated_event_times[8]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[8] - generated_event_times[7])
    mutations_n3 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n4 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n5 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n6 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n7 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(10, multinom_out[9]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+0" & event_order == "GGWGGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (5*generated_event_times[3]) - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] -  (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[1] - generated_event_times[2] + (2*generated_event_times[3] - generated_event_times[6]))
    mutations_n3 <- mutation_rate_m*((generated_event_times[6]) - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*((generated_event_times[4]) - (generated_event_times[3]))
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(8, multinom_out[7]),
                        rep(10, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+0" & event_order == "GGGWGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (7*generated_event_times[4]) - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[6]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] + (3*generated_event_times[4]) - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n6+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(6, multinom_out[5]),
                        rep(8, multinom_out[6]),
                        rep(10, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+0" & event_order == "GGGGW"){
    
    mutations_n1 <- mutation_rate_m*(10 - (10*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((5*generated_event_times[5]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] - (2*generated_event_times[4]))
    mutations_n4 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4+mutations_n6+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]),
                        rep(6, multinom_out[4]),
                        rep(8, multinom_out[5]),
                        rep(10, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+1" & event_order == "WGGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(11 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - generated_event_times[7] - generated_event_times[8] - (2*generated_event_times[9]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[9] - generated_event_times[8])
    mutations_n3 <- mutation_rate_m*(generated_event_times[8] - generated_event_times[7])
    mutations_n4 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n5 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n6 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n7 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n8 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n9 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]),
                        rep(10, multinom_out[10]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+1" & event_order == "GWGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(11 - (3*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - generated_event_times[7] - (2*generated_event_times[8]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[8] - generated_event_times[7])
    mutations_n3 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n4 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n5 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n6 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n7 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(10, multinom_out[9]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+1" & event_order == "GGWGGGG"){
    
    mutations_n1 <- mutation_rate_m*(11 - (5*generated_event_times[3]) - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] -  (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[1] - generated_event_times[2] + (2*generated_event_times[3] - generated_event_times[6]))
    mutations_n3 <- mutation_rate_m*((generated_event_times[6]) - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*((generated_event_times[4]) - (generated_event_times[3]))
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(8, multinom_out[7]),
                        rep(10, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+1" & event_order == "GGGWGG"){
    
    mutations_n1 <- mutation_rate_m*(11 - (7*generated_event_times[4]) - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[6]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] + (3*generated_event_times[4]) - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n6+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(6, multinom_out[5]),
                        rep(8, multinom_out[6]),
                        rep(10, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+1" & event_order == "GGGGW"){
    
    mutations_n1 <- mutation_rate_m*(11 - (10*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((5*generated_event_times[5]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] - (2*generated_event_times[4]))
    mutations_n4 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4+mutations_n6+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]),
                        rep(6, multinom_out[4]),
                        rep(8, multinom_out[5]),
                        rep(10, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+2" & event_order == "WGGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(12 - (3*generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - generated_event_times[7] - generated_event_times[8] - (2*generated_event_times[9]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1] + generated_event_times[9] - generated_event_times[8])
    mutations_n3 <- mutation_rate_m*(generated_event_times[8] - generated_event_times[7])
    mutations_n4 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n5 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n6 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n7 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n8 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n9 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]),
                        rep(10, multinom_out[10]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+2" & event_order == "GWGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(12 - (5*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - generated_event_times[7] - (2*generated_event_times[8]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[2]) - generated_event_times[1] + generated_event_times[8] - generated_event_times[7])
    mutations_n3 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n4 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n5 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n6 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n7 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(10, multinom_out[9]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+2" & event_order == "GGWGGGG"){
    
    mutations_n1 <- mutation_rate_m*(12 - (7*generated_event_times[3]) - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] -  (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[1] - generated_event_times[2] + (3*generated_event_times[3] - generated_event_times[6]))
    mutations_n3 <- mutation_rate_m*((generated_event_times[6]) - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*((generated_event_times[4]) - (generated_event_times[3]))
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(8, multinom_out[7]),
                        rep(10, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+2" & event_order == "GGGWGG"){
    
    mutations_n1 <- mutation_rate_m*(12 - (9*generated_event_times[4]) - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[6]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] + (4*generated_event_times[4]) - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n6+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(6, multinom_out[5]),
                        rep(8, multinom_out[6]),
                        rep(10, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+2" & event_order == "GGGGW"){
    
    mutations_n1 <- mutation_rate_m*(12 - (12*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((6*generated_event_times[5]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] - (2*generated_event_times[4]))
    mutations_n4 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4+mutations_n6+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]),
                        rep(6, multinom_out[4]),
                        rep(8, multinom_out[5]),
                        rep(10, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }
  return(mutation_bag)
}
```
### Make CN data
```{r}
make_cn_data <- function(cn_state,
                         number_of_mutations_to_select){
  cn_maj <- as.numeric(strsplit(cn_state,"\\+")[[1]][1])
  cn_min <- as.numeric(strsplit(cn_state,"\\+")[[1]][2])
  # CN data 
  data_cn <- as.data.frame(matrix(nrow = 1, ncol = 5, data = c(1,1,number_of_mutations_to_select,cn_maj,cn_min)))
  colnames(data_cn) <- c("chr","startpos","endpos","nMaj1_A","nMin1_A")
  data_cn$startpos <- as.numeric(data_cn$startpos)
  data_cn$endpos <- as.numeric(data_cn$endpos)
  data_cn$nMaj1_A <- as.numeric(data_cn$nMaj1_A)
  data_cn$nMin1_A <- as.numeric(data_cn$nMin1_A)
  
  return(data_cn)
}
```
### Make multiplicity data
```{r}
make_multiplicity_data <- function(number_of_mutations_to_select,
                                   mutation_bag_column_multiplicity
                                   ){
  # Multiplicity data
  data_mult <- as.data.frame(matrix(nrow = number_of_mutations_to_select, 
                                    ncol = 3, 
                                    data = c(rep("1",number_of_mutations_to_select),
                                             1:number_of_mutations_to_select,
                                             mutation_bag_column_multiplicity)))
  colnames(data_mult) <- c("chr","end","no.chrs.bearing.mut")
  data_mult$end <- as.numeric(data_mult$end)
  data_mult$no.chrs.bearing.mut <- as.numeric(data_mult$no.chrs.bearing.mut)
  
  return(data_mult)
}
```
### Make mutation data
```{r}
make_mutation_data <- function(number_of_mutations_to_select
                               ){
  # Mutation data
  data_muts <- as.data.frame(matrix(nrow = number_of_mutations_to_select, 
                                         ncol = 5, 
                                         data = c(rep("1",number_of_mutations_to_select),
                                                  1:number_of_mutations_to_select,
                                                  1:number_of_mutations_to_select,
                                                  rep("C",number_of_mutations_to_select),
                                                  rep("T",number_of_mutations_to_select)))) # ref and alt don't matter here but are neede for proper input data
  colnames(data_muts) <- c("chr", "start", "end", "ref", "alt")
  data_muts$start <- as.numeric(data_muts$start) 
  data_muts$end <- as.numeric(data_muts$end)
  
  return(data_muts)
}
```
### Generate timing test accuracy scenario
```{r}
# to be run once for each cn and order combination
generate_timing_test_accuracy_scenario_mismatched <- function(cn_state, 
                                      event_order, 
                                      number_of_events, 
                                      number_of_mutations_to_select, 
                                      number_of_mutations_to_generate,
                                      multiplicity_states_exp,
                                      mutation_rate_m=1,
                                      number_of_tests=10,
                                      proportion_clocklike=1,
                                      output,
                                      multinomial,
                                      order_to_time){
  
  multiplicity_states <- eval(parse(text=multiplicity_states_exp))
  
  generated_event_times <- sort(round(runif(number_of_events,min = 0.01, max = 0.99), digits = 2))

  # Create bag of mutations
  generated_mutation_bag <- make_mutation_bag(cn_state = cn_state, 
                                              event_order = event_order, 
                                              number_of_mutations_to_generate = (number_of_mutations_to_generate*proportion_clocklike), 
                                              mutation_rate_m = mutation_rate_m,
                                              generated_event_times = generated_event_times,
                                              multinomial)
  
  if(proportion_clocklike < 1){
    proportion_not_clocklike <- 1 - proportion_clocklike
    generated_mutation_bag <- c(generated_mutation_bag,sample(multiplicity_states,(proportion_not_clocklike*number_of_mutations_to_generate), replace = TRUE))
  }
  
  # Create sample of mutations that you intend to use for testing
  if(number_of_mutations_to_select == "All"){
    number_of_mutations_to_select <- length(generated_mutation_bag)
  }
  mutation_sample_from_bag <- replicate(n=number_of_tests, 
                                        expr = {sample(generated_mutation_bag, 
                                                       size = number_of_mutations_to_select, replace = FALSE)})
  # Create sample copy number data
  test_cn_data <- make_cn_data(cn_state = cn_state, number_of_mutations_to_select = number_of_mutations_to_select)
  
  # Create sample mutation data
  test_mut_data <- make_mutation_data(number_of_mutations_to_select = number_of_mutations_to_select)
  
  # Other parameters for timing
  test_data_id <- paste0("test_",cn_state,"_",event_order)
  test_data_id <- gsub(" ","_",test_data_id)
  test_data_chrom <- "1"
  test_data_start <- 1
  test_data_stop <- number_of_mutations_to_select
  test_data_status <- grepl("W",event_order)
  
  number_of_events <- as.numeric(number_of_events)
  
  # Create output table
  timing_test_accuracy_output_results <- as.data.frame(matrix(nrow = number_of_tests, ncol = (5+(2*number_of_events)))) # 5+2*number of timepoints
  colnames(timing_test_accuracy_output_results) <- c("test_number",
                                                     "is_correct_order",
                                                     paste0("t_",1:number_of_events,"_difference"),
                                                     paste0("t_",1:number_of_events,"_error_rate_percent"),
                                                     "average_t_difference",
                                                     "average_absolute_t_difference",
                                                     "average_t_error_rate_percent")
  timing_test_accuracy_output_results$test_number <- 1:number_of_tests
  
  # run timing test
  
  for(i in 1:number_of_tests){
    # Multiplicity data
    # Create sample multiplicity data - has to be done in loop or apply because it uses each column of the mutation_sample_from_bag for the number of tests

    test_data_mult <- make_multiplicity_data(number_of_mutations_to_select = number_of_mutations_to_select, 
                                             mutation_bag_column_multiplicity = mutation_sample_from_bag[,i])
    
    orders_to_time <- eval(parse(text=order_to_time))
    
    for(option in 1:length(orders_to_time)){
      segment_time_version <- time_amplification_custom(
        cn_data = test_cn_data,
        multiplicity_data = test_data_mult,
        mutation_data = test_mut_data,
        muts_type = "SBS1 and SBS5",
        sample_id = test_data_id,
        amplification_chrom = test_data_chrom,
        amplification_start = test_data_start,
        amplification_stop = test_data_stop,
        is_WGD = test_data_status,
        genome = "hg19",
        order_to_time = orders_to_time[option])
      
      colnames(segment_time_version) <- paste0(colnames(segment_time_version),"_",orders_to_time[option])
      
      if(option == 1){
        segment_time <- segment_time_version
      }else{
        segment_time <- cbind(segment_time, segment_time_version)
      }
      
    }
  }
  

  # add generated times to calculated times
  segment_and_generated_times <- segment_time
  names(generated_event_times) <- paste0("gt",1:number_of_events)
  segment_and_generated_times <- cbind(segment_and_generated_times,as.data.frame(t(generated_event_times)))
  
  if(output == "Averaged"){
    return(timing_test_accuracy_output_results_averaged)
  }else if(output == "Individual times"){
    return(segment_and_generated_times)
  # return(c("generated_event_times" = generated_event_times,
  #          "timing_results" = segment_time,
  #          "timing_test_accuracy_output_results"= timing_test_accuracy_output_results,
  #          "timing_test_accuracy_output_results_averaged" = timing_test_accuracy_output_results_averaged))
  }
  
  # return(timing_test_accuracy_output_results)
  
  # return(generated_event_times) # Checking if seed issue resolved

}
```





# Experiments
## 4+x
```{r}
x4_timing_states <- subset(states_and_order, (State %in% c("4+0","4+1","4+2")) &
                             is_wgd == "Yes")
```
```{r}
n_replicates <- 100
n_mutations <- 100
for(i in 1:nrow(x4_timing_states)){
  orders <- eval(parse(text=x4_timing_states$potential_alternative_order[i]))
  # test each scenario x times
  test_individual <- replicate(n_replicates,{generate_timing_test_accuracy_scenario_mismatched(cn_state = x4_timing_states$State[i],
                                                                          event_order = x4_timing_states$Order[i],
                                                                          number_of_events = x4_timing_states$number_of_timepoints[i],
                                                                          number_of_mutations_to_select = "All",
                                                                          number_of_mutations_to_generate = n_mutations,
                                                                          multiplicity_states_exp = x4_timing_states$multiplicity_states[i],
                                                                          mutation_rate_m = 1,
                                                                          number_of_tests = 1,
                                                                          proportion_clocklike=1,
                                                                          output = "Individual times",
                                                                          multinomial = multinomial_TF, 
                                                                          order_to_time = x4_timing_states$potential_alternative_order[i])})
  # get the results of the x replicates and turn them into a data frame
  og_colnames <- c("sample","region","highest_copy_number","event_order","num_mutations_used","clonality_status","flags",
                                 "t_1","t_1_mean_bootstrap","t_1_lower_ci","t_1_upper_ci","t_2","t_2_mean_bootstrap","t_2_lower_ci","t_2_upper_ci",
                                 "t_3","t_3_mean_bootstrap","t_3_lower_ci","t_3_upper_ci","t_4","t_4_mean_bootstrap","t_4_lower_ci","t_4_upper_ci",
                                 "t_5","t_5_mean_bootstrap","t_5_lower_ci","t_5_upper_ci","t_6","t_6_mean_bootstrap","t_6_lower_ci","t_6_upper_ci",
                                 "t_7","t_7_mean_bootstrap","t_7_lower_ci","t_7_upper_ci","t_8","t_8_mean_bootstrap","t_8_lower_ci","t_8_upper_ci",
                                 "t_9","t_9_mean_bootstrap","t_9_lower_ci","t_9_upper_ci","t_10","t_10_mean_bootstrap","t_10_lower_ci","t_10_upper_ci")
  test_individual <- as.data.frame(matrix(data = unlist(test_individual), nrow = n_replicates, byrow = TRUE))
  
  colnames(test_individual) <- c(paste0(og_colnames,"_",orders[1]),
                                 paste0(og_colnames,"_",orders[2]),
                                 paste0("tg",1:x4_timing_states$number_of_timepoints[i]))
  # create a unique identifier for each replicate
  test_individual$sample_number <- paste0(x4_timing_states$State[i],"_",x4_timing_states$Order[i],"_",rownames(test_individual))
  
  # Melt the calculated and the generated data
  test_individual_melt_calculated <- melt(as.data.table(test_individual), id.vars = c("sample_number"), 
                                          measure.vars = c(colnames(test_individual)[grep("_mean_bootstrap",colnames(test_individual))]))
  
  test_individual_melt_generated <- melt(as.data.table(test_individual), id.vars = c("sample_number"), 
                                         measure.vars = c(colnames(test_individual)[grep("tg",colnames(test_individual))]))
  # rename columns
  colnames(test_individual_melt_calculated) <- c("sample_number","calculated_variable","calculated_value")
  colnames(test_individual_melt_generated) <- c("sample_number","generated_variable","generated_value")
  
  # create event and order used column
  test_individual_melt_calculated$applied_order <- gsub(".*_","",test_individual_melt_calculated$calculated_variable)
  test_individual_melt_calculated$event_number <- gsub("_mean_bootstrap","",test_individual_melt_calculated$calculated_variable)
  test_individual_melt_calculated$event_number <- gsub("t_","",test_individual_melt_calculated$event_number)
  test_individual_melt_calculated$event_number <- gsub("_.*","",test_individual_melt_calculated$event_number)
  
  test_individual_melt_generated$event_number <- gsub("tg","",test_individual_melt_generated$generated_variable)
  
  # create a sample and event number id
  test_individual_melt_calculated$sample_number_id <- paste0(test_individual_melt_calculated$sample_number," ",
                                                             test_individual_melt_calculated$event_number)
  test_individual_melt_generated$sample_number_id <- paste0(test_individual_melt_generated$sample_number," ",
                                                            test_individual_melt_generated$event_number)
  
  # combine the melted data for plotting and testing
  test_individual_melt_combined <- merge(test_individual_melt_calculated,
                                         test_individual_melt_generated,
                                         by = c("sample_number_id","sample_number"))
  test_individual_melt_combined$event_number_t <- paste0("t_",test_individual_melt_combined$event_number.x)
  
  # Do a Spearman correlation test
  test_individual_correlation <- as.data.frame(matrix(data = NA, 
                                                      nrow = as.numeric(max(as.numeric(test_individual_melt_combined$event_number.x))*length(orders)),
                                                      ncol = 7))
  colnames(test_individual_correlation) <- c("CN_state","True_order","Applied_order","Timepoint",
                                             "Spearman_rho","Spearman_p_value","Spearman_adjusted_p")
  test_individual_correlation$CN_state <- x4_timing_states$State[i]
  test_individual_correlation$Timepoint <- paste0("t_",1:max(as.numeric(test_individual_melt_combined$event_number.x)))
  test_individual_correlation$True_order <- x4_timing_states$Order[i]
  test_individual_correlation$Applied_order <- c(rep(orders[1],max(as.numeric(test_individual_melt_combined$event_number.x))),
                                                 rep(orders[2],max(as.numeric(test_individual_melt_combined$event_number.x))))
  
  for(t in 1:nrow(test_individual_correlation)){
    test_subset <- subset(test_individual_melt_combined, (applied_order == test_individual_correlation$Applied_order[t]) &
                            (event_number_t == test_individual_correlation$Timepoint[t]))
    if(sum(!is.na(as.numeric(test_subset$calculated_value))) < 3){
      next
    }else{
      test_individual_correlation$Spearman_rho[t] <- cor.test(as.numeric(test_subset$calculated_value),
                                                              as.numeric(test_subset$generated_value),
                                                              method = "spearman")[[4]]
      test_individual_correlation$Spearman_p_value[t] <- cor.test(as.numeric(test_subset$calculated_value),
                                                                  as.numeric(test_subset$generated_value),
                                                                  method = "spearman")[[3]]
    }
    
  }
  test_individual_correlation$Spearman_adjusted_p <- p.adjust(test_individual_correlation$Spearman_p_value, method = "BH")
  # table grob for plotting table
  table_individual_cor <- tableGrob(test_individual_correlation)
  
  
  plot_individual_cor <- ggplot(test_individual_melt_combined, aes(x = as.numeric(calculated_value), y = as.numeric(generated_value), colour = applied_order))+
    geom_point(alpha = 0.8)+
    # geom_smooth(method = "lm")+
    facet_wrap(~(event_number_t), scales = "free")+
    theme_light()+
    scale_colour_viridis(name = "Order Applied", discrete = TRUE)+
    xlab("Calculated time")+
    ylab("Generated time")+
    ggtitle(paste0(x4_timing_states$State_and_order[i], " - ",data_type_title))+
    theme(axis.text.x = element_text(angle = 70,vjust = 0.5), plot.title = element_text(hjust = 0.5))+
    scale_x_continuous(labels = label_number(accuracy = 0.01))+
    geom_abline(slope = 1, intercept = 0, linetype = 2, colour = "grey")
  
  # combine plot and table
  png(paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_",
             x4_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".png"),
      res = 300, width = 24, height = 20, units = "cm")
  
  grid.arrange(plot_individual_cor, table_individual_cor,
               nrow = 2,
               as.table = TRUE,
               heights = c(2, 1))
  dev.off()
  
  # Save numerical results as well
  write.table(test_individual_correlation,
              paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_spearman_correlation_",
             x4_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".txt"), sep = "\t", row.names = FALSE, quote = FALSE)
  write.table(test_individual_melt_combined,
              paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_melted_values_",
             x4_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".txt"), sep = "\t", row.names = FALSE, quote = FALSE)
}

```


## 5+x
```{r}
x5_timing_states <- subset(states_and_order, (State %in% c("5+0","5+1","5+2")) &
                             is_wgd == "Yes")
```
```{r}
n_replicates <- 100
n_mutations <- 100
for(i in 1:nrow(x5_timing_states)){
  orders <- eval(parse(text=x5_timing_states$potential_alternative_order[i]))
  # test each scenario x times
  test_individual <- replicate(n_replicates,{generate_timing_test_accuracy_scenario_mismatched(cn_state = x5_timing_states$State[i],
                                                                          event_order = x5_timing_states$Order[i],
                                                                          number_of_events = x5_timing_states$number_of_timepoints[i],
                                                                          number_of_mutations_to_select = "All",
                                                                          number_of_mutations_to_generate = n_mutations,
                                                                          multiplicity_states_exp = x5_timing_states$multiplicity_states[i],
                                                                          mutation_rate_m = 1,
                                                                          number_of_tests = 1,
                                                                          proportion_clocklike=1,
                                                                          output = "Individual times",
                                                                          multinomial = multinomial_TF, 
                                                                          order_to_time = x5_timing_states$potential_alternative_order[i])})
  # get the results of the x replicates and turn them into a data frame
  og_colnames <- c("sample","region","highest_copy_number","event_order","num_mutations_used","clonality_status","flags",
                                 "t_1","t_1_mean_bootstrap","t_1_lower_ci","t_1_upper_ci","t_2","t_2_mean_bootstrap","t_2_lower_ci","t_2_upper_ci",
                                 "t_3","t_3_mean_bootstrap","t_3_lower_ci","t_3_upper_ci","t_4","t_4_mean_bootstrap","t_4_lower_ci","t_4_upper_ci",
                                 "t_5","t_5_mean_bootstrap","t_5_lower_ci","t_5_upper_ci","t_6","t_6_mean_bootstrap","t_6_lower_ci","t_6_upper_ci",
                                 "t_7","t_7_mean_bootstrap","t_7_lower_ci","t_7_upper_ci","t_8","t_8_mean_bootstrap","t_8_lower_ci","t_8_upper_ci",
                                 "t_9","t_9_mean_bootstrap","t_9_lower_ci","t_9_upper_ci","t_10","t_10_mean_bootstrap","t_10_lower_ci","t_10_upper_ci")
  test_individual <- as.data.frame(matrix(data = unlist(test_individual), nrow = n_replicates, byrow = TRUE))
  
  colnames(test_individual) <- c(paste0(og_colnames,"_",orders[1]),
                                 paste0(og_colnames,"_",orders[2]),
                                 paste0("tg",1:x5_timing_states$number_of_timepoints[i]))
  # create a unique identifier for each replicate
  test_individual$sample_number <- paste0(x5_timing_states$State[i],"_",x5_timing_states$Order[i],"_",rownames(test_individual))
  
  # Melt the calculated and the generated data
  test_individual_melt_calculated <- melt(as.data.table(test_individual), id.vars = c("sample_number"), 
                                          measure.vars = c(colnames(test_individual)[grep("_mean_bootstrap",colnames(test_individual))]))
  
  test_individual_melt_generated <- melt(as.data.table(test_individual), id.vars = c("sample_number"), 
                                         measure.vars = c(colnames(test_individual)[grep("tg",colnames(test_individual))]))
  # rename columns
  colnames(test_individual_melt_calculated) <- c("sample_number","calculated_variable","calculated_value")
  colnames(test_individual_melt_generated) <- c("sample_number","generated_variable","generated_value")
  
  # create event and order used column
  test_individual_melt_calculated$applied_order <- gsub(".*_","",test_individual_melt_calculated$calculated_variable)
  test_individual_melt_calculated$event_number <- gsub("_mean_bootstrap","",test_individual_melt_calculated$calculated_variable)
  test_individual_melt_calculated$event_number <- gsub("t_","",test_individual_melt_calculated$event_number)
  test_individual_melt_calculated$event_number <- gsub("_.*","",test_individual_melt_calculated$event_number)
  
  test_individual_melt_generated$event_number <- gsub("tg","",test_individual_melt_generated$generated_variable)
  
  # create a sample and event number id
  test_individual_melt_calculated$sample_number_id <- paste0(test_individual_melt_calculated$sample_number," ",
                                                             test_individual_melt_calculated$event_number)
  test_individual_melt_generated$sample_number_id <- paste0(test_individual_melt_generated$sample_number," ",
                                                            test_individual_melt_generated$event_number)
  
  # combine the melted data for plotting and testing
  test_individual_melt_combined <- merge(test_individual_melt_calculated,
                                         test_individual_melt_generated,
                                         by = c("sample_number_id","sample_number"))
  test_individual_melt_combined$event_number_t <- paste0("t_",test_individual_melt_combined$event_number.x)
  
  # Do a Spearman correlation test
  test_individual_correlation <- as.data.frame(matrix(data = NA, 
                                                      nrow = as.numeric(max(as.numeric(test_individual_melt_combined$event_number.x))*length(orders)),
                                                      ncol = 7))
  colnames(test_individual_correlation) <- c("CN_state","True_order","Applied_order","Timepoint",
                                             "Spearman_rho","Spearman_p_value","Spearman_adjusted_p")
  test_individual_correlation$CN_state <- x5_timing_states$State[i]
  test_individual_correlation$Timepoint <- paste0("t_",1:max(as.numeric(test_individual_melt_combined$event_number.x)))
  test_individual_correlation$True_order <- x5_timing_states$Order[i]
  test_individual_correlation$Applied_order <- c(rep(orders[1],max(as.numeric(test_individual_melt_combined$event_number.x))),
                                                 rep(orders[2],max(as.numeric(test_individual_melt_combined$event_number.x))))
  
  for(t in 1:nrow(test_individual_correlation)){
    test_subset <- subset(test_individual_melt_combined, (applied_order == test_individual_correlation$Applied_order[t]) &
                            (event_number_t == test_individual_correlation$Timepoint[t]))
    if(sum(!is.na(as.numeric(test_subset$calculated_value))) < 3){
      next
    }else{
      test_individual_correlation$Spearman_rho[t] <- cor.test(as.numeric(test_subset$calculated_value),
                                                              as.numeric(test_subset$generated_value),
                                                              method = "spearman")[[4]]
      test_individual_correlation$Spearman_p_value[t] <- cor.test(as.numeric(test_subset$calculated_value),
                                                                  as.numeric(test_subset$generated_value),
                                                                  method = "spearman")[[3]]
    }
    
  }
  test_individual_correlation$Spearman_adjusted_p <- p.adjust(test_individual_correlation$Spearman_p_value, method = "BH")
  # table grob for plotting table
  table_individual_cor <- tableGrob(test_individual_correlation)
  
  
  plot_individual_cor <- ggplot(test_individual_melt_combined, aes(x = as.numeric(calculated_value), y = as.numeric(generated_value), colour = applied_order))+
    geom_point(alpha = 0.8)+
    # geom_smooth(method = "lm")+
    facet_wrap(~(event_number_t), scales = "free")+
    theme_light()+
    scale_colour_viridis(name = "Order Applied", discrete = TRUE)+
    xlab("Calculated time")+
    ylab("Generated time")+
    ggtitle(paste0(x5_timing_states$State_and_order[i], " - ",data_type_title))+
    theme(axis.text.x = element_text(angle = 70,vjust = 0.5), plot.title = element_text(hjust = 0.5))+
    scale_x_continuous(labels = label_number(accuracy = 0.01))+
    geom_abline(slope = 1, intercept = 0, linetype = 2, colour = "grey")
  
  # combine plot and table
  png(paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_",
             x5_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".png"),
      res = 300, width = 24, height = 20, units = "cm")
  
  grid.arrange(plot_individual_cor, table_individual_cor,
               nrow = 2,
               as.table = TRUE,
               heights = c(2, 1))
  dev.off()
  
  # Save numerical results as well
  write.table(test_individual_correlation,
              paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_spearman_correlation_",
             x5_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".txt"), sep = "\t", row.names = FALSE, quote = FALSE)
  write.table(test_individual_melt_combined,
              paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_melted_values_",
             x5_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".txt"), sep = "\t", row.names = FALSE, quote = FALSE)
}

```

## 6+x
```{r}
x6_timing_states <- subset(states_and_order, (State %in% c("6+0","6+1","6+2")) &
                             is_wgd == "Yes")
```
```{r}
n_replicates <- 100
n_mutations <- 100
for(i in 1:nrow(x6_timing_states)){
  orders <- eval(parse(text=x6_timing_states$potential_alternative_order[i]))
  # test each scenario x times
  test_individual <- replicate(n_replicates,{generate_timing_test_accuracy_scenario_mismatched(cn_state = x6_timing_states$State[i],
                                                                          event_order = x6_timing_states$Order[i],
                                                                          number_of_events = x6_timing_states$number_of_timepoints[i],
                                                                          number_of_mutations_to_select = "All",
                                                                          number_of_mutations_to_generate = n_mutations,
                                                                          multiplicity_states_exp = x6_timing_states$multiplicity_states[i],
                                                                          mutation_rate_m = 1,
                                                                          number_of_tests = 1,
                                                                          proportion_clocklike=1,
                                                                          output = "Individual times",
                                                                          multinomial = multinomial_TF, 
                                                                          order_to_time = x6_timing_states$potential_alternative_order[i])})
  # get the results of the x replicates and turn them into a data frame
  og_colnames <- c("sample","region","highest_copy_number","event_order","num_mutations_used","clonality_status","flags",
                                 "t_1","t_1_mean_bootstrap","t_1_lower_ci","t_1_upper_ci","t_2","t_2_mean_bootstrap","t_2_lower_ci","t_2_upper_ci",
                                 "t_3","t_3_mean_bootstrap","t_3_lower_ci","t_3_upper_ci","t_4","t_4_mean_bootstrap","t_4_lower_ci","t_4_upper_ci",
                                 "t_5","t_5_mean_bootstrap","t_5_lower_ci","t_5_upper_ci","t_6","t_6_mean_bootstrap","t_6_lower_ci","t_6_upper_ci",
                                 "t_7","t_7_mean_bootstrap","t_7_lower_ci","t_7_upper_ci","t_8","t_8_mean_bootstrap","t_8_lower_ci","t_8_upper_ci",
                                 "t_9","t_9_mean_bootstrap","t_9_lower_ci","t_9_upper_ci","t_10","t_10_mean_bootstrap","t_10_lower_ci","t_10_upper_ci")
  test_individual <- as.data.frame(matrix(data = unlist(test_individual), nrow = n_replicates, byrow = TRUE))
  
  colnames(test_individual) <- c(paste0(og_colnames,"_",orders[1]),
                                 paste0(og_colnames,"_",orders[2]),
                                 paste0(og_colnames,"_",orders[3]),
                                 paste0("tg",1:x6_timing_states$number_of_timepoints[i]))
  # create a unique identifier for each replicate
  test_individual$sample_number <- paste0(x6_timing_states$State[i],"_",x6_timing_states$Order[i],"_",rownames(test_individual))
  
  # Melt the calculated and the generated data
  test_individual_melt_calculated <- melt(as.data.table(test_individual), id.vars = c("sample_number"), 
                                          measure.vars = c(colnames(test_individual)[grep("_mean_bootstrap",colnames(test_individual))]))
  
  test_individual_melt_generated <- melt(as.data.table(test_individual), id.vars = c("sample_number"), 
                                         measure.vars = c(colnames(test_individual)[grep("tg",colnames(test_individual))]))
  # rename columns
  colnames(test_individual_melt_calculated) <- c("sample_number","calculated_variable","calculated_value")
  colnames(test_individual_melt_generated) <- c("sample_number","generated_variable","generated_value")
  
  # create event and order used column
  test_individual_melt_calculated$applied_order <- gsub(".*_","",test_individual_melt_calculated$calculated_variable)
  test_individual_melt_calculated$event_number <- gsub("_mean_bootstrap","",test_individual_melt_calculated$calculated_variable)
  test_individual_melt_calculated$event_number <- gsub("t_","",test_individual_melt_calculated$event_number)
  test_individual_melt_calculated$event_number <- gsub("_.*","",test_individual_melt_calculated$event_number)
  
  test_individual_melt_generated$event_number <- gsub("tg","",test_individual_melt_generated$generated_variable)
  
  # create a sample and event number id
  test_individual_melt_calculated$sample_number_id <- paste0(test_individual_melt_calculated$sample_number," ",
                                                             test_individual_melt_calculated$event_number)
  test_individual_melt_generated$sample_number_id <- paste0(test_individual_melt_generated$sample_number," ",
                                                            test_individual_melt_generated$event_number)
  
  # combine the melted data for plotting and testing
  test_individual_melt_combined <- merge(test_individual_melt_calculated,
                                         test_individual_melt_generated,
                                         by = c("sample_number_id","sample_number"))
  test_individual_melt_combined$event_number_t <- paste0("t_",test_individual_melt_combined$event_number.x)
  
  # Do a Spearman correlation test
  test_individual_correlation <- as.data.frame(matrix(data = NA, 
                                                      nrow = as.numeric(max(as.numeric(test_individual_melt_combined$event_number.x))*length(orders)),
                                                      ncol = 7))
  colnames(test_individual_correlation) <- c("CN_state","True_order","Applied_order","Timepoint",
                                             "Spearman_rho","Spearman_p_value","Spearman_adjusted_p")
  test_individual_correlation$CN_state <- x6_timing_states$State[i]
  test_individual_correlation$Timepoint <- paste0("t_",1:max(as.numeric(test_individual_melt_combined$event_number.x)))
  test_individual_correlation$True_order <- x6_timing_states$Order[i]
  test_individual_correlation$Applied_order <- c(rep(orders[1],max(as.numeric(test_individual_melt_combined$event_number.x))),
                                                 rep(orders[2],max(as.numeric(test_individual_melt_combined$event_number.x))),
                                                 rep(orders[3],max(as.numeric(test_individual_melt_combined$event_number.x))))
  
  for(t in 1:nrow(test_individual_correlation)){
    test_subset <- subset(test_individual_melt_combined, (applied_order == test_individual_correlation$Applied_order[t]) &
                            (event_number_t == test_individual_correlation$Timepoint[t]))
    if(sum(!is.na(as.numeric(test_subset$calculated_value))) < 3){
      next
    }else{
      test_individual_correlation$Spearman_rho[t] <- cor.test(as.numeric(test_subset$calculated_value),
                                                              as.numeric(test_subset$generated_value),
                                                              method = "spearman")[[4]]
      test_individual_correlation$Spearman_p_value[t] <- cor.test(as.numeric(test_subset$calculated_value),
                                                                  as.numeric(test_subset$generated_value),
                                                                  method = "spearman")[[3]]
    }
    
  }
  test_individual_correlation$Spearman_adjusted_p <- p.adjust(test_individual_correlation$Spearman_p_value, method = "BH")
  # table grob for plotting table
  table_individual_cor <- tableGrob(test_individual_correlation, theme = ttheme_default(base_size = 10))
  
  
  plot_individual_cor <- ggplot(test_individual_melt_combined, aes(x = as.numeric(calculated_value), y = as.numeric(generated_value), colour = applied_order))+
    geom_point(alpha = 0.8)+
    # geom_smooth(method = "lm")+
    facet_wrap(~(event_number_t), scales = "free")+
    theme_light()+
    scale_colour_viridis(name = "Order Applied", discrete = TRUE)+
    xlab("Calculated time")+
    ylab("Generated time")+
    ggtitle(paste0(x6_timing_states$State_and_order[i], " - ",data_type_title))+
    theme(axis.text.x = element_text(angle = 70,vjust = 0.5), plot.title = element_text(hjust = 0.5))+
    scale_x_continuous(labels = label_number(accuracy = 0.01))+
    geom_abline(slope = 1, intercept = 0, linetype = 2, colour = "grey")
  
  # combine plot and table
  png(paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_",
             x6_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".png"),
      res = 300, width = 24, height = 28, units = "cm")
  
  grid.arrange(plot_individual_cor, table_individual_cor,
               nrow = 2,
               as.table = TRUE,
               heights = c(3, 2))
  dev.off()
  
  # Save numerical results as well
  write.table(test_individual_correlation,
              paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_spearman_correlation_",
             x6_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".txt"), sep = "\t", row.names = FALSE, quote = FALSE)
  write.table(test_individual_melt_combined,
              paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_melted_values_",
             x6_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".txt"), sep = "\t", row.names = FALSE, quote = FALSE)
}

```

## 7+x
```{r}
x7_timing_states <- subset(states_and_order, (State %in% c("7+0","7+1","7+2")) &
                             is_wgd == "Yes")
```
```{r}
n_replicates <- 100
n_mutations <- 100
for(i in 1:nrow(x7_timing_states)){
  orders <- eval(parse(text=x7_timing_states$potential_alternative_order[i]))
  # test each scenario x times
  test_individual <- replicate(n_replicates,{generate_timing_test_accuracy_scenario_mismatched(cn_state = x7_timing_states$State[i],
                                                                          event_order = x7_timing_states$Order[i],
                                                                          number_of_events = x7_timing_states$number_of_timepoints[i],
                                                                          number_of_mutations_to_select = "All",
                                                                          number_of_mutations_to_generate = n_mutations,
                                                                          multiplicity_states_exp = x7_timing_states$multiplicity_states[i],
                                                                          mutation_rate_m = 1,
                                                                          number_of_tests = 1,
                                                                          proportion_clocklike=1,
                                                                          output = "Individual times",
                                                                          multinomial = multinomial_TF, 
                                                                          order_to_time = x7_timing_states$potential_alternative_order[i])})
  # get the results of the x replicates and turn them into a data frame
  og_colnames <- c("sample","region","highest_copy_number","event_order","num_mutations_used","clonality_status","flag",
                                 "t_1","t_1_mean_bootstrap","t_1_lower_ci","t_1_upper_ci","t_2","t_2_mean_bootstrap","t_2_lower_ci","t_2_upper_ci",
                                 "t_3","t_3_mean_bootstrap","t_3_lower_ci","t_3_upper_ci","t_4","t_4_mean_bootstrap","t_4_lower_ci","t_4_upper_ci",
                                 "t_5","t_5_mean_bootstrap","t_5_lower_ci","t_5_upper_ci","t_6","t_6_mean_bootstrap","t_6_lower_ci","t_6_upper_ci",
                                 "t_7","t_7_mean_bootstrap","t_7_lower_ci","t_7_upper_ci","t_8","t_8_mean_bootstrap","t_8_lower_ci","t_8_upper_ci",
                                 "t_9","t_9_mean_bootstrap","t_9_lower_ci","t_9_upper_ci","t_10","t_10_mean_bootstrap","t_10_lower_ci","t_10_upper_ci")
  test_individual <- as.data.frame(matrix(data = unlist(test_individual), nrow = n_replicates, byrow = TRUE))
  
  colnames(test_individual) <- c(paste0(og_colnames,"_",orders[1]),
                                 paste0(og_colnames,"_",orders[2]),
                                 paste0(og_colnames,"_",orders[3]),
                                 paste0("tg",1:x7_timing_states$number_of_timepoints[i]))
  # create a unique identifier for each replicate
  test_individual$sample_number <- paste0(x7_timing_states$State[i],"_",x7_timing_states$Order[i],"_",rownames(test_individual))
  
  # Melt the calculated and the generated data
  test_individual_melt_calculated <- melt(as.data.table(test_individual), id.vars = c("sample_number"), 
                                          measure.vars = c(colnames(test_individual)[grep("_mean_bootstrap",colnames(test_individual))]))
  
  test_individual_melt_generated <- melt(as.data.table(test_individual), id.vars = c("sample_number"), 
                                         measure.vars = c(colnames(test_individual)[grep("tg",colnames(test_individual))]))
  # rename columns
  colnames(test_individual_melt_calculated) <- c("sample_number","calculated_variable","calculated_value")
  colnames(test_individual_melt_generated) <- c("sample_number","generated_variable","generated_value")
  
  # create event and order used column
  test_individual_melt_calculated$applied_order <- gsub(".*_","",test_individual_melt_calculated$calculated_variable)
  test_individual_melt_calculated$event_number <- gsub("_mean_bootstrap","",test_individual_melt_calculated$calculated_variable)
  test_individual_melt_calculated$event_number <- gsub("t_","",test_individual_melt_calculated$event_number)
  test_individual_melt_calculated$event_number <- gsub("_.*","",test_individual_melt_calculated$event_number)
  
  test_individual_melt_generated$event_number <- gsub("tg","",test_individual_melt_generated$generated_variable)
  
  # create a sample and event number id
  test_individual_melt_calculated$sample_number_id <- paste0(test_individual_melt_calculated$sample_number," ",
                                                             test_individual_melt_calculated$event_number)
  test_individual_melt_generated$sample_number_id <- paste0(test_individual_melt_generated$sample_number," ",
                                                            test_individual_melt_generated$event_number)
  
  # combine the melted data for plotting and testing
  test_individual_melt_combined <- merge(test_individual_melt_calculated,
                                         test_individual_melt_generated,
                                         by = c("sample_number_id","sample_number"))
  test_individual_melt_combined$event_number_t <- paste0("t_",test_individual_melt_combined$event_number.x)
  
  # Do a Spearman correlation test
  test_individual_correlation <- as.data.frame(matrix(data = NA, 
                                                      nrow = as.numeric(max(as.numeric(test_individual_melt_combined$event_number.x))*length(orders)),
                                                      ncol = 7))
  colnames(test_individual_correlation) <- c("CN_state","True_order","Applied_order","Timepoint",
                                             "Spearman_rho","Spearman_p_value","Spearman_adjusted_p")
  test_individual_correlation$CN_state <- x7_timing_states$State[i]
  test_individual_correlation$Timepoint <- paste0("t_",1:max(as.numeric(test_individual_melt_combined$event_number.x)))
  test_individual_correlation$True_order <- x7_timing_states$Order[i]
  test_individual_correlation$Applied_order <- c(rep(orders[1],max(as.numeric(test_individual_melt_combined$event_number.x))),
                                                 rep(orders[2],max(as.numeric(test_individual_melt_combined$event_number.x))),
                                                 rep(orders[3],max(as.numeric(test_individual_melt_combined$event_number.x))))
  
  for(t in 1:nrow(test_individual_correlation)){
    test_subset <- subset(test_individual_melt_combined, (applied_order == test_individual_correlation$Applied_order[t]) &
                            (event_number_t == test_individual_correlation$Timepoint[t]))
    if(sum(!is.na(as.numeric(test_subset$calculated_value))) < 3){
      next
    }else{
      test_individual_correlation$Spearman_rho[t] <- cor.test(as.numeric(test_subset$calculated_value),
                                                              as.numeric(test_subset$generated_value),
                                                              method = "spearman")[[4]]
      test_individual_correlation$Spearman_p_value[t] <- cor.test(as.numeric(test_subset$calculated_value),
                                                                  as.numeric(test_subset$generated_value),
                                                                  method = "spearman")[[3]]
    }
    
  }
  test_individual_correlation$Spearman_adjusted_p <- p.adjust(test_individual_correlation$Spearman_p_value, method = "BH")
  # table grob for plotting table
  table_individual_cor <- tableGrob(test_individual_correlation, theme = ttheme_default(base_size = 8))
  
  
  plot_individual_cor <- ggplot(test_individual_melt_combined, aes(x = as.numeric(calculated_value), y = as.numeric(generated_value), colour = applied_order))+
    geom_point(alpha = 0.8)+
    # geom_smooth(method = "lm")+
    facet_wrap(~(event_number_t), scales = "free")+
    theme_light()+
    scale_colour_viridis(name = "Order Applied", discrete = TRUE)+
    xlab("Calculated time")+
    ylab("Generated time")+
    ggtitle(paste0(x7_timing_states$State_and_order[i], " - ",data_type_title))+
    theme(axis.text.x = element_text(angle = 70,vjust = 0.5), plot.title = element_text(hjust = 0.5))+
    scale_x_continuous(labels = label_number(accuracy = 0.01))+
    geom_abline(slope = 1, intercept = 0, linetype = 2, colour = "grey")
  
  # combine plot and table
  png(paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_",
             x7_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".png"),
      res = 300, width = 24, height = 30, units = "cm")
  
  grid.arrange(plot_individual_cor, table_individual_cor,
               nrow = 2,
               as.table = TRUE,
               heights = c(3, 2))
  dev.off()
  
  # Save numerical results as well
  write.table(test_individual_correlation,
              paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_spearman_correlation_",
             x7_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".txt"), sep = "\t", row.names = FALSE, quote = FALSE)
  write.table(test_individual_melt_combined,
              paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_melted_values_",
             x7_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".txt"), sep = "\t", row.names = FALSE, quote = FALSE)
}

```

## 8+x
```{r}
x8_timing_states <- subset(states_and_order, (State %in% c("8+0","8+1","8+2")) &
                             is_wgd == "Yes")
```
```{r}
n_replicates <- 100
n_mutations <- 100
for(i in 1:nrow(x8_timing_states)){
  orders <- eval(parse(text=x8_timing_states$potential_alternative_order[i]))
  # test each scenario x times
  test_individual <- replicate(n_replicates,{generate_timing_test_accuracy_scenario_mismatched(cn_state = x8_timing_states$State[i],
                                                                          event_order = x8_timing_states$Order[i],
                                                                          number_of_events = x8_timing_states$number_of_timepoints[i],
                                                                          number_of_mutations_to_select = "All",
                                                                          number_of_mutations_to_generate = n_mutations,
                                                                          multiplicity_states_exp = x8_timing_states$multiplicity_states[i],
                                                                          mutation_rate_m = 1,
                                                                          number_of_tests = 1,
                                                                          proportion_clocklike=1,
                                                                          output = "Individual times",
                                                                          multinomial = multinomial_TF, 
                                                                          order_to_time = x8_timing_states$potential_alternative_order[i])})
  # get the results of the x replicates and turn them into a data frame
  og_colnames <- c("sample","region","highest_copy_number","event_order","num_mutations_used","clonality_status","flag",
                                 "t_1","t_1_mean_bootstrap","t_1_lower_ci","t_1_upper_ci","t_2","t_2_mean_bootstrap","t_2_lower_ci","t_2_upper_ci",
                                 "t_3","t_3_mean_bootstrap","t_3_lower_ci","t_3_upper_ci","t_4","t_4_mean_bootstrap","t_4_lower_ci","t_4_upper_ci",
                                 "t_5","t_5_mean_bootstrap","t_5_lower_ci","t_5_upper_ci","t_6","t_6_mean_bootstrap","t_6_lower_ci","t_6_upper_ci",
                                 "t_7","t_7_mean_bootstrap","t_7_lower_ci","t_7_upper_ci","t_8","t_8_mean_bootstrap","t_8_lower_ci","t_8_upper_ci",
                                 "t_9","t_9_mean_bootstrap","t_9_lower_ci","t_9_upper_ci","t_10","t_10_mean_bootstrap","t_10_lower_ci","t_10_upper_ci")
  test_individual <- as.data.frame(matrix(data = unlist(test_individual), nrow = n_replicates, byrow = TRUE))
  
  colnames(test_individual) <- c(paste0(og_colnames,"_",orders[1]),
                                 paste0(og_colnames,"_",orders[2]),
                                 paste0(og_colnames,"_",orders[3]),
                                 paste0(og_colnames,"_",orders[4]),
                                 paste0("tg",1:x8_timing_states$number_of_timepoints[i]))
  # create a unique identifier for each replicate
  test_individual$sample_number <- paste0(x8_timing_states$State[i],"_",x8_timing_states$Order[i],"_",rownames(test_individual))
  
  # Melt the calculated and the generated data
  test_individual_melt_calculated <- melt(as.data.table(test_individual), id.vars = c("sample_number"), 
                                          measure.vars = c(colnames(test_individual)[grep("_mean_bootstrap",colnames(test_individual))]))
  
  test_individual_melt_generated <- melt(as.data.table(test_individual), id.vars = c("sample_number"), 
                                         measure.vars = c(colnames(test_individual)[grep("tg",colnames(test_individual))]))
  # rename columns
  colnames(test_individual_melt_calculated) <- c("sample_number","calculated_variable","calculated_value")
  colnames(test_individual_melt_generated) <- c("sample_number","generated_variable","generated_value")
  
  # create event and order used column
  test_individual_melt_calculated$applied_order <- gsub(".*_","",test_individual_melt_calculated$calculated_variable)
  test_individual_melt_calculated$event_number <- gsub("_mean_bootstrap","",test_individual_melt_calculated$calculated_variable)
  test_individual_melt_calculated$event_number <- gsub("t_","",test_individual_melt_calculated$event_number)
  test_individual_melt_calculated$event_number <- gsub("_.*","",test_individual_melt_calculated$event_number)
  
  test_individual_melt_generated$event_number <- gsub("tg","",test_individual_melt_generated$generated_variable)
  
  # create a sample and event number id
  test_individual_melt_calculated$sample_number_id <- paste0(test_individual_melt_calculated$sample_number," ",
                                                             test_individual_melt_calculated$event_number)
  test_individual_melt_generated$sample_number_id <- paste0(test_individual_melt_generated$sample_number," ",
                                                            test_individual_melt_generated$event_number)
  
  # combine the melted data for plotting and testing
  test_individual_melt_combined <- merge(test_individual_melt_calculated,
                                         test_individual_melt_generated,
                                         by = c("sample_number_id","sample_number"))
  test_individual_melt_combined$event_number_t <- paste0("t_",test_individual_melt_combined$event_number.x)
  
  # Do a Spearman correlation test
  test_individual_correlation <- as.data.frame(matrix(data = NA, 
                                                      nrow = as.numeric(max(as.numeric(test_individual_melt_combined$event_number.x))*length(orders)),
                                                      ncol = 7))
  colnames(test_individual_correlation) <- c("CN_state","True_order","Applied_order","Timepoint",
                                             "Spearman_rho","Spearman_p_value","Spearman_adjusted_p")
  test_individual_correlation$CN_state <- x8_timing_states$State[i]
  test_individual_correlation$Timepoint <- paste0("t_",1:max(as.numeric(test_individual_melt_combined$event_number.x)))
  test_individual_correlation$True_order <- x8_timing_states$Order[i]
  test_individual_correlation$Applied_order <- c(rep(orders[1],max(as.numeric(test_individual_melt_combined$event_number.x))),
                                                 rep(orders[2],max(as.numeric(test_individual_melt_combined$event_number.x))),
                                                 rep(orders[3],max(as.numeric(test_individual_melt_combined$event_number.x))),
                                                 rep(orders[4],max(as.numeric(test_individual_melt_combined$event_number.x))))
  
  for(t in 1:nrow(test_individual_correlation)){
    test_subset <- subset(test_individual_melt_combined, (applied_order == test_individual_correlation$Applied_order[t]) &
                            (event_number_t == test_individual_correlation$Timepoint[t]))
    if(sum(!is.na(as.numeric(test_subset$calculated_value))) < 3){
      next
    }else{
      test_individual_correlation$Spearman_rho[t] <- cor.test(as.numeric(test_subset$calculated_value),
                                                              as.numeric(test_subset$generated_value),
                                                              method = "spearman")[[4]]
      test_individual_correlation$Spearman_p_value[t] <- cor.test(as.numeric(test_subset$calculated_value),
                                                                  as.numeric(test_subset$generated_value),
                                                                  method = "spearman")[[3]]
    }
    
  }
  test_individual_correlation$Spearman_adjusted_p <- p.adjust(test_individual_correlation$Spearman_p_value, method = "BH")
  # table grob for plotting table
  table_individual_cor <- tableGrob(test_individual_correlation, theme = ttheme_default(base_size = 8))
  
  
  plot_individual_cor <- ggplot(test_individual_melt_combined, aes(x = as.numeric(calculated_value), y = as.numeric(generated_value), colour = applied_order))+
    geom_point(alpha = 0.8)+
    # geom_smooth(method = "lm")+
    facet_wrap(~(event_number_t), scales = "free")+
    theme_light()+
    scale_colour_viridis(name = "Order Applied", discrete = TRUE)+
    xlab("Calculated time")+
    ylab("Generated time")+
    ggtitle(paste0(x8_timing_states$State_and_order[i], " - ",data_type_title))+
    theme(axis.text.x = element_text(angle = 70,vjust = 0.5), plot.title = element_text(hjust = 0.5))+
    scale_x_continuous(labels = label_number(accuracy = 0.01))+
    geom_abline(slope = 1, intercept = 0, linetype = 2, colour = "grey")
  
  # combine plot and table
  png(paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_",
             x8_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".png"),
      res = 300, width = 24, height = 30, units = "cm")
  
  grid.arrange(plot_individual_cor, table_individual_cor,
               nrow = 2,
               as.table = TRUE,
               heights = c(2, 3))
  dev.off()
  
  # Save numerical results as well
  write.table(test_individual_correlation,
              paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_spearman_correlation_",
             x8_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".txt"), sep = "\t", row.names = FALSE, quote = FALSE)
  write.table(test_individual_melt_combined,
              paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_melted_values_",
             x8_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".txt"), sep = "\t", row.names = FALSE, quote = FALSE)
}

```

## 9+x
```{r}
x9_timing_states <- subset(states_and_order, (State %in% c("9+0","9+1","9+2")) &
                             is_wgd == "Yes")
```
```{r}
n_replicates <- 100
n_mutations <- 100
for(i in 1:nrow(x9_timing_states)){
  orders <- eval(parse(text=x9_timing_states$potential_alternative_order[i]))
  # test each scenario x times
  test_individual <- replicate(n_replicates,{generate_timing_test_accuracy_scenario_mismatched(cn_state = x9_timing_states$State[i],
                                                                          event_order = x9_timing_states$Order[i],
                                                                          number_of_events = x9_timing_states$number_of_timepoints[i],
                                                                          number_of_mutations_to_select = "All",
                                                                          number_of_mutations_to_generate = n_mutations,
                                                                          multiplicity_states_exp = x9_timing_states$multiplicity_states[i],
                                                                          mutation_rate_m = 1,
                                                                          number_of_tests = 1,
                                                                          proportion_clocklike=1,
                                                                          output = "Individual times",
                                                                          multinomial = multinomial_TF, 
                                                                          order_to_time = x9_timing_states$potential_alternative_order[i])})
  # get the results of the x replicates and turn them into a data frame
  og_colnames <- c("sample","region","highest_copy_number","event_order","num_mutations_used","clonality_status","flags",
                                 "t_1","t_1_mean_bootstrap","t_1_lower_ci","t_1_upper_ci","t_2","t_2_mean_bootstrap","t_2_lower_ci","t_2_upper_ci",
                                 "t_3","t_3_mean_bootstrap","t_3_lower_ci","t_3_upper_ci","t_4","t_4_mean_bootstrap","t_4_lower_ci","t_4_upper_ci",
                                 "t_5","t_5_mean_bootstrap","t_5_lower_ci","t_5_upper_ci","t_6","t_6_mean_bootstrap","t_6_lower_ci","t_6_upper_ci",
                                 "t_7","t_7_mean_bootstrap","t_7_lower_ci","t_7_upper_ci","t_8","t_8_mean_bootstrap","t_8_lower_ci","t_8_upper_ci",
                                 "t_9","t_9_mean_bootstrap","t_9_lower_ci","t_9_upper_ci","t_10","t_10_mean_bootstrap","t_10_lower_ci","t_10_upper_ci")
  test_individual <- as.data.frame(matrix(data = unlist(test_individual), nrow = n_replicates, byrow = TRUE))
  
  colnames(test_individual) <- c(paste0(og_colnames,"_",orders[1]),
                                 paste0(og_colnames,"_",orders[2]),
                                 paste0(og_colnames,"_",orders[3]),
                                 paste0(og_colnames,"_",orders[4]),
                                 paste0("tg",1:x9_timing_states$number_of_timepoints[i]))
  # create a unique identifier for each replicate
  test_individual$sample_number <- paste0(x9_timing_states$State[i],"_",x9_timing_states$Order[i],"_",rownames(test_individual))
  
  # Melt the calculated and the generated data
  test_individual_melt_calculated <- melt(as.data.table(test_individual), id.vars = c("sample_number"), 
                                          measure.vars = c(colnames(test_individual)[grep("_mean_bootstrap",colnames(test_individual))]))
  
  test_individual_melt_generated <- melt(as.data.table(test_individual), id.vars = c("sample_number"), 
                                         measure.vars = c(colnames(test_individual)[grep("tg",colnames(test_individual))]))
  # rename columns
  colnames(test_individual_melt_calculated) <- c("sample_number","calculated_variable","calculated_value")
  colnames(test_individual_melt_generated) <- c("sample_number","generated_variable","generated_value")
  
  # create event and order used column
  test_individual_melt_calculated$applied_order <- gsub(".*_","",test_individual_melt_calculated$calculated_variable)
  test_individual_melt_calculated$event_number <- gsub("_mean_bootstrap","",test_individual_melt_calculated$calculated_variable)
  test_individual_melt_calculated$event_number <- gsub("t_","",test_individual_melt_calculated$event_number)
  test_individual_melt_calculated$event_number <- gsub("_.*","",test_individual_melt_calculated$event_number)
  
  test_individual_melt_generated$event_number <- gsub("tg","",test_individual_melt_generated$generated_variable)
  
  # create a sample and event number id
  test_individual_melt_calculated$sample_number_id <- paste0(test_individual_melt_calculated$sample_number," ",
                                                             test_individual_melt_calculated$event_number)
  test_individual_melt_generated$sample_number_id <- paste0(test_individual_melt_generated$sample_number," ",
                                                            test_individual_melt_generated$event_number)
  
  # combine the melted data for plotting and testing
  test_individual_melt_combined <- merge(test_individual_melt_calculated,
                                         test_individual_melt_generated,
                                         by = c("sample_number_id","sample_number"))
  test_individual_melt_combined$event_number_t <- paste0("t_",test_individual_melt_combined$event_number.x)
  
  # Do a Spearman correlation test
  test_individual_correlation <- as.data.frame(matrix(data = NA, 
                                                      nrow = as.numeric(max(as.numeric(test_individual_melt_combined$event_number.x))*length(orders)),
                                                      ncol = 7))
  colnames(test_individual_correlation) <- c("CN_state","True_order","Applied_order","Timepoint",
                                             "Spearman_rho","Spearman_p_value","Spearman_adjusted_p")
  test_individual_correlation$CN_state <- x9_timing_states$State[i]
  test_individual_correlation$Timepoint <- paste0("t_",1:max(as.numeric(test_individual_melt_combined$event_number.x)))
  test_individual_correlation$True_order <- x9_timing_states$Order[i]
  test_individual_correlation$Applied_order <- c(rep(orders[1],max(as.numeric(test_individual_melt_combined$event_number.x))),
                                                 rep(orders[2],max(as.numeric(test_individual_melt_combined$event_number.x))),
                                                 rep(orders[3],max(as.numeric(test_individual_melt_combined$event_number.x))),
                                                 rep(orders[4],max(as.numeric(test_individual_melt_combined$event_number.x))))
  
  for(t in 1:nrow(test_individual_correlation)){
    test_subset <- subset(test_individual_melt_combined, (applied_order == test_individual_correlation$Applied_order[t]) &
                            (event_number_t == test_individual_correlation$Timepoint[t]))
    if(sum(!is.na(as.numeric(test_subset$calculated_value))) < 3){
      next
    }else{
      test_individual_correlation$Spearman_rho[t] <- cor.test(as.numeric(test_subset$calculated_value),
                                                              as.numeric(test_subset$generated_value),
                                                              method = "spearman")[[4]]
      test_individual_correlation$Spearman_p_value[t] <- cor.test(as.numeric(test_subset$calculated_value),
                                                                  as.numeric(test_subset$generated_value),
                                                                  method = "spearman")[[3]]
    }
    
  }
  test_individual_correlation$Spearman_adjusted_p <- p.adjust(test_individual_correlation$Spearman_p_value, method = "BH")
  # table grob for plotting table
  table_individual_cor <- tableGrob(test_individual_correlation, theme = ttheme_default(base_size = 8))
  
  
  plot_individual_cor <- ggplot(test_individual_melt_combined, aes(x = as.numeric(calculated_value), y = as.numeric(generated_value), colour = applied_order))+
    geom_point(alpha = 0.8)+
    # geom_smooth(method = "lm")+
    facet_wrap(~(event_number_t), scales = "free")+
    theme_light()+
    scale_colour_viridis(name = "Order Applied", discrete = TRUE)+
    xlab("Calculated time")+
    ylab("Generated time")+
    ggtitle(paste0(x9_timing_states$State_and_order[i], " - ",data_type_title))+
    theme(axis.text.x = element_text(angle = 70,vjust = 0.5), plot.title = element_text(hjust = 0.5))+
    scale_x_continuous(labels = label_number(accuracy = 0.01))+
    geom_abline(slope = 1, intercept = 0, linetype = 2, colour = "grey")
  
  # combine plot and table
  png(paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_",
             x9_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".png"),
      res = 300, width = 22, height = 34, units = "cm")
  
  grid.arrange(plot_individual_cor, table_individual_cor,
               nrow = 2,
               as.table = TRUE,
               heights = c(2, 3))
  dev.off()
  
  # Save numerical results as well
  write.table(test_individual_correlation,
              paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_spearman_correlation_",
             x9_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".txt"), sep = "\t", row.names = FALSE, quote = FALSE)
  write.table(test_individual_melt_combined,
              paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_melted_values_",
             x9_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".txt"), sep = "\t", row.names = FALSE, quote = FALSE)
}

```

## 10+x
```{r}
x10_timing_states <- subset(states_and_order, (State %in% c("10+0","10+1","10+2")) &
                             is_wgd == "Yes")
```
```{r}
n_replicates <- 100
n_mutations <- 100
for(i in 1:nrow(x10_timing_states)){
  orders <- eval(parse(text=x10_timing_states$potential_alternative_order[i]))
  # test each scenario x times
  test_individual <- replicate(n_replicates,{generate_timing_test_accuracy_scenario_mismatched(cn_state = x10_timing_states$State[i],
                                                                          event_order = x10_timing_states$Order[i],
                                                                          number_of_events = x10_timing_states$number_of_timepoints[i],
                                                                          number_of_mutations_to_select = "All",
                                                                          number_of_mutations_to_generate = n_mutations,
                                                                          multiplicity_states_exp = x10_timing_states$multiplicity_states[i],
                                                                          mutation_rate_m = 1,
                                                                          number_of_tests = 1,
                                                                          proportion_clocklike=1,
                                                                          output = "Individual times",
                                                                          multinomial = multinomial_TF, 
                                                                          order_to_time = x10_timing_states$potential_alternative_order[i])})
  # get the results of the x replicates and turn them into a data frame
  og_colnames <- c("sample","region","highest_copy_number","event_order","num_mutations_used","clonality_status","flags",
                                 "t_1","t_1_mean_bootstrap","t_1_lower_ci","t_1_upper_ci","t_2","t_2_mean_bootstrap","t_2_lower_ci","t_2_upper_ci",
                                 "t_3","t_3_mean_bootstrap","t_3_lower_ci","t_3_upper_ci","t_4","t_4_mean_bootstrap","t_4_lower_ci","t_4_upper_ci",
                                 "t_5","t_5_mean_bootstrap","t_5_lower_ci","t_5_upper_ci","t_6","t_6_mean_bootstrap","t_6_lower_ci","t_6_upper_ci",
                                 "t_7","t_7_mean_bootstrap","t_7_lower_ci","t_7_upper_ci","t_8","t_8_mean_bootstrap","t_8_lower_ci","t_8_upper_ci",
                                 "t_9","t_9_mean_bootstrap","t_9_lower_ci","t_9_upper_ci","t_10","t_10_mean_bootstrap","t_10_lower_ci","t_10_upper_ci")
  test_individual <- as.data.frame(matrix(data = unlist(test_individual), nrow = n_replicates, byrow = TRUE))
  
  colnames(test_individual) <- c(paste0(og_colnames,"_",orders[1]),
                                 paste0(og_colnames,"_",orders[2]),
                                 paste0(og_colnames,"_",orders[3]),
                                 paste0(og_colnames,"_",orders[4]),
                                 paste0(og_colnames,"_",orders[5]),
                                 paste0("tg",1:x10_timing_states$number_of_timepoints[i]))
  # create a unique identifier for each replicate
  test_individual$sample_number <- paste0(x10_timing_states$State[i],"_",x10_timing_states$Order[i],"_",rownames(test_individual))
  
  # Melt the calculated and the generated data
  test_individual_melt_calculated <- melt(as.data.table(test_individual), id.vars = c("sample_number"), 
                                          measure.vars = c(colnames(test_individual)[grep("_mean_bootstrap",colnames(test_individual))]))
  
  test_individual_melt_generated <- melt(as.data.table(test_individual), id.vars = c("sample_number"), 
                                         measure.vars = c(colnames(test_individual)[grep("tg",colnames(test_individual))]))
  # rename columns
  colnames(test_individual_melt_calculated) <- c("sample_number","calculated_variable","calculated_value")
  colnames(test_individual_melt_generated) <- c("sample_number","generated_variable","generated_value")
  
  # create event and order used column
  test_individual_melt_calculated$applied_order <- gsub(".*_","",test_individual_melt_calculated$calculated_variable)
  test_individual_melt_calculated$event_number <- gsub("_mean_bootstrap","",test_individual_melt_calculated$calculated_variable)
  test_individual_melt_calculated$event_number <- gsub("t_","",test_individual_melt_calculated$event_number)
  test_individual_melt_calculated$event_number <- gsub("_.*","",test_individual_melt_calculated$event_number)
  
  test_individual_melt_generated$event_number <- gsub("tg","",test_individual_melt_generated$generated_variable)
  
  # create a sample and event number id
  test_individual_melt_calculated$sample_number_id <- paste0(test_individual_melt_calculated$sample_number," ",
                                                             test_individual_melt_calculated$event_number)
  test_individual_melt_generated$sample_number_id <- paste0(test_individual_melt_generated$sample_number," ",
                                                            test_individual_melt_generated$event_number)
  
  # combine the melted data for plotting and testing
  test_individual_melt_combined <- merge(test_individual_melt_calculated,
                                         test_individual_melt_generated,
                                         by = c("sample_number_id","sample_number"))
  test_individual_melt_combined$event_number_t <- paste0("t_",test_individual_melt_combined$event_number.x)
  
  # Do a Spearman correlation test
  test_individual_correlation <- as.data.frame(matrix(data = NA, 
                                                      nrow = as.numeric(max(as.numeric(test_individual_melt_combined$event_number.x))*length(orders)),
                                                      ncol = 7))
  colnames(test_individual_correlation) <- c("CN_state","True_order","Applied_order","Timepoint",
                                             "Spearman_rho","Spearman_p_value","Spearman_adjusted_p")
  test_individual_correlation$CN_state <- x10_timing_states$State[i]
  test_individual_correlation$Timepoint <- paste0("t_",1:max(as.numeric(test_individual_melt_combined$event_number.x)))
  test_individual_correlation$True_order <- x10_timing_states$Order[i]
  test_individual_correlation$Applied_order <- c(rep(orders[1],max(as.numeric(test_individual_melt_combined$event_number.x))),
                                                 rep(orders[2],max(as.numeric(test_individual_melt_combined$event_number.x))),
                                                 rep(orders[3],max(as.numeric(test_individual_melt_combined$event_number.x))),
                                                 rep(orders[4],max(as.numeric(test_individual_melt_combined$event_number.x))),
                                                 rep(orders[5],max(as.numeric(test_individual_melt_combined$event_number.x))))
  
  for(t in 1:nrow(test_individual_correlation)){
    test_subset <- subset(test_individual_melt_combined, (applied_order == test_individual_correlation$Applied_order[t]) &
                            (event_number_t == test_individual_correlation$Timepoint[t]))
    if(sum(!is.na(as.numeric(test_subset$calculated_value))) < 3){
      next
    }else{
      test_individual_correlation$Spearman_rho[t] <- cor.test(as.numeric(test_subset$calculated_value),
                                                              as.numeric(test_subset$generated_value),
                                                              method = "spearman")[[4]]
      test_individual_correlation$Spearman_p_value[t] <- cor.test(as.numeric(test_subset$calculated_value),
                                                                  as.numeric(test_subset$generated_value),
                                                                  method = "spearman")[[3]]
    }
    
  }
  test_individual_correlation$Spearman_adjusted_p <- p.adjust(test_individual_correlation$Spearman_p_value, method = "BH")
  # table grob for plotting table
  table_individual_cor <- tableGrob(test_individual_correlation, theme = ttheme_default(base_size = 8))
  
  
  plot_individual_cor <- ggplot(test_individual_melt_combined, aes(x = as.numeric(calculated_value), y = as.numeric(generated_value), colour = applied_order))+
    geom_point(alpha = 0.8)+
    # geom_smooth(method = "lm")+
    facet_wrap(~(event_number_t), scales = "free")+
    theme_light()+
    scale_colour_viridis(name = "Order Applied", discrete = TRUE)+
    xlab("Calculated time")+
    ylab("Generated time")+
    ggtitle(paste0(x10_timing_states$State_and_order[i], " - ",data_type_title))+
    theme(axis.text.x = element_text(angle = 70,vjust = 0.5), plot.title = element_text(hjust = 0.5))+
    scale_x_continuous(labels = label_number(accuracy = 0.01))+
    geom_abline(slope = 1, intercept = 0, linetype = 2, colour = "grey")
  
  # combine plot and table
  png(paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_",
             x10_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".png"),
      res = 300, width = 22, height = 38, units = "cm")
  
  grid.arrange(plot_individual_cor, table_individual_cor,
               nrow = 2,
               as.table = TRUE,
               heights = c(1, 3))
  dev.off()
  
  # Save numerical results as well
  write.table(test_individual_correlation,
              paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_spearman_correlation_",
             x10_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".txt"), sep = "\t", row.names = FALSE, quote = FALSE)
  write.table(test_individual_melt_combined,
              paste0(outdir,"applying_right_and_wrong_equations/",
             "right_vs_wrong_equations_melted_values_",
             x10_timing_states$State_and_order[i],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".txt"), sep = "\t", row.names = FALSE, quote = FALSE)
}

```

# Session Info
```{r}
sessionInfo()
```

Save session info
```{r}
writeLines(capture.output(sessionInfo()), paste0(outdir,data_type,"_right_and_wrong_equations_sessionInfo_",Sys.Date(),".txt"))
```

