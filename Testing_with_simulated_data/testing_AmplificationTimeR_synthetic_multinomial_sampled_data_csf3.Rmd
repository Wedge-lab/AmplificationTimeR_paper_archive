---
title: "Measuring accuracy and robustness of AmplificationTimeR estimates - csf3 - Multinomial data"
author: "Maria Jakobsdottir"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    df_print: paged
---

Using multinomially simulated data. Output saved in: `/mnt/bmh01-rds/UoOxford_David_W/b05055gj/AmplificationTimeR_synthetic_tests/multinomial_sampled_data`

```{r}
outdir <- c("/mnt/bmh01-rds/UoOxford_David_W/b05055gj/AmplificationTimeR_synthetic_tests/multinomial_sampled_data/")
data_type <- "multinomial_sampled_data"
data_type_title <- "Multinomial sampled simulated data"
multinomial_TF <- TRUE

options(bitmapType='cairo')
```


# Libraries
```{r}
# devtools::install_github("Wedge-lab/AmplificationTimeR", force = TRUE)
library(AmplificationTimeR)
library(ggplot2)
library(viridis)
library(BSgenome.Hsapiens.UCSC.hg19)
library(pheatmap)
library(grid)
library(data.table)
library(gridExtra)
library(scales)
```

# Data
List possible copy number states and their order.

```{r}
states_and_order <- as.data.frame(matrix(data = c("State_and_order" = c("2+0 G","2+1 G","3+0 GG","3+1 GG","4+0 GGG",
                                                    "4+1 GGG","5+0 GGGG","5+1 GGGG","6+0 GGGGG","6+1 GGGGG",
                                                    "7+0 GGGGGG","7+1 GGGGGG","8+0 GGGGGGG","8+1 GGGGGGG","9+0 GGGGGGGG",
                                                    "9+1 GGGGGGGG","10+0 GGGGGGGGG","10+1 GGGGGGGGG","2+0 W","2+1 W",
                                                    "2+2 W","3+0 WG","3+1 WG","3+2 WG","4+0 WGG",
                                                    "4+0 GW","4+1 WGG","4+1 GW","4+2 WGG","4+2 GW",
                                                    "5+0 WGGG","5+0 GWG","5+1 WGGG","5+1 GWG","5+2 WGGG",
                                                    "5+2 GWG","6+0 WGGGG","6+0 GWGG","6+0 GGW","6+1 WGGGG",
                                                    "6+1 GWGG","6+1 GGW","6+2 WGGGG","6+2 GWGG","6+2 GGW",
                                                    "7+0 WGGGGG","7+0 GWGGG","7+0 GGWG","7+1 WGGGGG","7+1 GWGGG",
                                                    "7+1 GGWG","7+2 WGGGGG","7+2 GWGGG","7+2 GGWG","8+0 WGGGGGG",
                                                    "8+0 GWGGGG","8+0 GGWGG","8+0 GGGW","8+1 WGGGGGG","8+1 GWGGGG",
                                                    "8+1 GGWGG","8+1 GGGW","8+2 WGGGGGG","8+2 GWGGGG","8+2 GGWGG",
                                                    "8+2 GGGW","9+0 WGGGGGGG","9+0 GWGGGGG","9+0 GGWGGG","9+0 GGGWG",
                                                    "9+1 WGGGGGGG","9+1 GWGGGGG","9+1 GGWGGG","9+1 GGGWG","9+2 WGGGGGGG",
                                                    "9+2 GWGGGGG","9+2 GGWGGG","9+2 GGGWG","10+0 WGGGGGGGG","10+0 GWGGGGGG",
                                                    "10+0 GGWGGGG","10+0 GGGWGG","10+0 GGGGW","10+1 WGGGGGGGG","10+1 GWGGGGGG",
                                                    "10+1 GGWGGGG","10+1 GGGWGG","10+1 GGGGW","10+2 WGGGGGGGG","10+2 GWGGGGGG",
                                                    "10+2 GGWGGGG","10+2 GGGWGG","10+2 GGGGW"),
                                                "multiplicity_states"=c("c(1,2)","c(1,2)","c(1,2,3)","c(1,2,3)","c(1,2,3,4)",#5
                                                                        "c(1,2,3,4)","c(1,2,3,4,5)","c(1,2,3,4,5)","c(1,2,3,4,5,6)","c(1,2,3,4,5,6)",#10
                                                                        "c(1,2,3,4,5,6,7)","c(1,2,3,4,5,6,7)","c(1,2,3,4,5,6,7,8)","c(1,2,3,4,5,6,7,8)","c(1,2,3,4,5,6,7,8,9)",#15
                                                                        "c(1,2,3,4,5,6,7,8,9)","c(1,2,3,4,5,6,7,8,9,10)","c(1,2,3,4,5,6,7,8,9,10)","c(1,2)","c(1,2)",#20
                                                                        "c(1,2)","c(1,2,3)","c(1,2,3)","c(1,2,3)","c(1,2,3,4)",#25
                                                                        "c(1,2,4)","c(1,2,3,4)","c(1,2,4)","c(1,2,3,4)","c(1,2,4)",#30
                                                                        "c(1,2,3,4,5)","c(1,2,3,5)","c(1,2,3,4,5)","c(1,2,3,5)","c(1,2,3,4,5)",#35
                                                                        "c(1,2,3,5)","c(1,2,3,4,5,6)","c(1,2,3,4,6)","c(1,2,4,6)","c(1,2,3,4,5,6)",#40
                                                                        "c(1,2,3,4,6)","c(1,2,4,6)","c(1,2,3,4,5,6)","c(1,2,3,4,6)","c(1,2,4,6)",#45
                                                                        "c(1,2,3,4,5,6,7)","c(1,2,3,4,5,7)","c(1,2,3,5,7)","c(1,2,3,4,5,6,7)","c(1,2,3,4,5,7)",#50
                                                                        "c(1,2,3,5,7)","c(1,2,3,4,5,6,7)","c(1,2,3,4,5,7)","c(1,2,3,5,7)","c(1,2,3,4,5,6,7,8)",#55
                                                                        "c(1,2,3,4,5,6,8)","c(1,2,3,4,6,8)","c(1,2,4,6,8)","c(1,2,3,4,5,6,7,8)","c(1,2,3,4,5,6,8)",#60
                                                                        "c(1,2,3,4,6,8)","c(1,2,4,6,8)","c(1,2,3,4,5,6,7,8)","c(1,2,3,4,5,6,8)","c(1,2,3,4,6,8)",#65
                                                                        "c(1,2,4,6,8)","c(1,2,3,4,5,6,7,8,9)","c(1,2,3,4,5,6,7,9)","c(1,2,3,4,5,7,9)","c(1,2,3,5,7,9)",#70
                                                                        "c(1,2,3,4,5,6,7,8,9)","c(1,2,3,4,5,6,7,9)","c(1,2,3,4,5,7,9)","c(1,2,3,5,7,9)","c(1,2,3,4,5,6,7,8,9)",#75
                                                                        "c(1,2,3,4,5,6,7,9)","c(1,2,3,4,5,7,9)","c(1,2,3,5,7,9)","c(1,2,3,4,5,6,7,8,9,10)","c(1,2,3,4,5,6,7,8,10)",#80
                                                                        "c(1,2,3,4,5,6,8,10)","c(1,2,3,4,6,8,10)","c(1,2,4,6,8,10)","c(1,2,3,4,5,6,7,8,9,10)","c(1,2,3,4,5,6,7,8,10)",#85
                                                                        "c(1,2,3,4,5,6,8,10)","c(1,2,3,4,6,8,10)","c(1,2,4,6,8,10)","c(1,2,3,4,5,6,7,8,9,10)","c(1,2,3,4,5,6,7,8,10)",#90
                                                                        "c(1,2,3,4,5,6,8,10)","c(1,2,3,4,6,8,10)","c(1,2,4,6,8,10)"),#93
                              "is_wgd"=c("No","No","No","No","No",
                                         "No","No","No","No","No",
                                         "No","No","No","No","No",
                                         "No","No","No","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes","Yes","Yes",
                                         "Yes","Yes","Yes"),
                              "number_of_timepoints" = c(1,1,2,2,3,
                                                         3,4,4,5,5,
                                                         6,6,7,7,8,
                                                         8,9,9,1,1,
                                                         1,2,2,2,3,
                                                         2,3,2,3,2,
                                                         4,3,4,3,4,
                                                         3,5,4,3,5,
                                                         4,3,5,4,3,
                                                         6,5,4,6,5,
                                                         4,6,5,4,7,
                                                         6,5,4,7,6,
                                                         5,4,7,6,5,
                                                         4,8,7,6,5,
                                                         8,7,6,5,8,
                                                         7,6,5,9,8,
                                                         7,6,5,9,8,
                                                         7,6,5,9,8,
                                                         7,6,5)), ncol = 4, byrow = FALSE))
colnames(states_and_order) <- c("State_and_order","multiplicity_states","is_wgd","number_of_timepoints")
states_and_order$Order <- gsub(".* ","",states_and_order$State_and_order)
states_and_order$State <- gsub(" .*","",states_and_order$State_and_order)
```

# Functions
## Testing equations
### Make mutation bag
```{r}
make_mutation_bag <- function(cn_state, 
                              event_order, 
                              number_of_mutations_to_generate,
                              mutation_rate_m,
                              generated_event_times,
                              multinomial){
  
  # List out equations for all n for all CN states and orders...
  if(cn_state == "2+0" & event_order == "G"){
    mutations_n1 <- (2*mutation_rate_m)*(1 - (generated_event_times[1]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                   rep(2, multinom_out[2]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number))
    }
    
    
  }else if(cn_state == "2+1" & event_order == "G"){
    
    mutations_n1 <- mutation_rate_m*(3 - (2*generated_event_times[1]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                   rep(2, multinom_out[2]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number))
    }
    
    
  }else if(cn_state == "3+0" & event_order == "GG"){
    
    mutations_n1 <- mutation_rate_m*(3 - (generated_event_times[1]) - (2*generated_event_times[2]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n3 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number))
    }
    
    
  }else if(cn_state == "3+1" & event_order == "GG"){
    mutations_n1 <- mutation_rate_m*(4 - (generated_event_times[1]) - (2*generated_event_times[2]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n3 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number))
    }
    
    
  }else if(cn_state == "4+0" & event_order == "GGG"){
    mutations_n1 <- mutation_rate_m*(4 - (generated_event_times[1]) - (generated_event_times[2]) - (2*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n3 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n4 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number))
    }
    
  }else if(cn_state == "4+1" & event_order == "GGG"){
    mutations_n1 <- mutation_rate_m*(5 - (generated_event_times[1]) - (generated_event_times[2]) - (2*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n3 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n4 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number))
    }
    
  }else if(cn_state == "5+0" & event_order == "GGGG"){
    mutations_n1 <- mutation_rate_m*(5 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n5 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number))
    }
    
  }else if(cn_state == "5+1" & event_order == "GGGG"){
    mutations_n1 <- mutation_rate_m*(6 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n5 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number))
    }
    
  }else if(cn_state == "6+0" & event_order == "GGGGG"){
    mutations_n1 <- mutation_rate_m*(6 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number))
    }
    
  }else if(cn_state == "6+1" & event_order == "GGGGG"){
    mutations_n1 <- mutation_rate_m*(7 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number))
    }
    
  }else if(cn_state == "7+0" & event_order == "GGGGGG"){
    mutations_n1 <- mutation_rate_m*(7 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (generated_event_times[5]) - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "7+1" & event_order == "GGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (generated_event_times[5]) - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "8+0" & event_order == "GGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (generated_event_times[5]) - (generated_event_times[6]) - (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n3 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+1" & event_order == "GGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (generated_event_times[5]) - (generated_event_times[6]) - (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n3 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "9+0" & event_order == "GGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (generated_event_times[5]) - (generated_event_times[6]) - (generated_event_times[7]) - (2*generated_event_times[8]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[8] - generated_event_times[7])
    mutations_n3 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n4 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n5 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n6 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n7 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+1" & event_order == "GGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (generated_event_times[5]) - (generated_event_times[6]) - (generated_event_times[7]) - (2*generated_event_times[8]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[8] - generated_event_times[7])
    mutations_n3 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n4 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n5 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n6 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n7 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*(generated_event_times[1])

    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "10+0" & event_order == "GGGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (generated_event_times[5]) - (generated_event_times[6]) - (generated_event_times[7]) - (generated_event_times[8]) - (2*generated_event_times[9]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[9] - generated_event_times[8])
    mutations_n3 <- mutation_rate_m*(generated_event_times[8] - generated_event_times[7])
    mutations_n4 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n5 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n6 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n7 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n8 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n9 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]),
                        rep(10, multinom_out[10]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+1" & event_order == "GGGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(11 - (generated_event_times[1]) - (generated_event_times[2]) - (generated_event_times[3]) - (generated_event_times[4]) - (generated_event_times[5]) - (generated_event_times[6]) - (generated_event_times[7]) - (generated_event_times[8]) - (2*generated_event_times[9]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[9] - generated_event_times[8])
    mutations_n3 <- mutation_rate_m*(generated_event_times[8] - generated_event_times[7])
    mutations_n4 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n5 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n6 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n7 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n8 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n9 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]),
                        rep(10, multinom_out[10]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "2+0" & event_order == "W"){
    
    mutations_n1 <- (2*mutation_rate_m)*(1 - generated_event_times[1])
    mutations_n2 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number))
    }
    
    
  }else if(cn_state == "2+1" & event_order == "W"){
    
    mutations_n1 <- mutation_rate_m*(3 - (2*generated_event_times[1]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number))
    }
    
    
  }else if(cn_state == "2+2" & event_order == "W"){
    
    mutations_n1 <- (4*mutation_rate_m)*(1 - generated_event_times[1])
    mutations_n2 <- (2*mutation_rate_m)*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                      rep(2,mutations_n2_number))
    }
    
    
  }else if(cn_state == "3+0" & event_order == "WG"){
    
    mutations_n1 <- mutation_rate_m*(3 - generated_event_times[1] - (2*generated_event_times[2]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n3 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number))
    }
    
    
  }else if(cn_state == "3+1" & event_order == "WG"){
    
    mutations_n1 <- mutation_rate_m*(4 - generated_event_times[1] - (2*generated_event_times[2]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n3 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number))
    }
    
    
  }else if(cn_state == "3+2" & event_order == "WG"){
    
    mutations_n1 <- mutation_rate_m*(5 - (3*generated_event_times[1]) - (2*generated_event_times[2]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2])
    mutations_n3 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number))
    }
    
    
  }else if(cn_state == "4+0" & event_order == "WGG"){
    
    mutations_n1 <- mutation_rate_m*(4 - generated_event_times[1] - generated_event_times[2] - (2*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n3 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n4 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number))
    }
    
    
  }else if(cn_state == "4+0" & event_order == "GW"){
    
    mutations_n1 <- mutation_rate_m*(4 - (4*generated_event_times[2]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[2]) - (2*generated_event_times[1]))
    mutations_n4 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number))
    }
    
    
  }else if(cn_state == "4+1" & event_order == "WGG"){

    mutations_n1 <- mutation_rate_m*(5 - (generated_event_times[1]) - generated_event_times[2] - (2*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n3 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n4 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number))
    }
    
        
  }else if(cn_state == "4+1" & event_order == "GW"){
    
    mutations_n1 <- mutation_rate_m*(5 - (4*generated_event_times[2]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[2]) - (2*generated_event_times[1]))
    mutations_n4 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number))
    }
    
    
  }else if(cn_state == "4+2" & event_order == "WGG"){
    
    mutations_n1 <- mutation_rate_m*(6 - (3*generated_event_times[1]) - generated_event_times[2] - (2*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1] + generated_event_times[3] - generated_event_times[2])
    mutations_n3 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n4 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number))
    }
    
    
  }else if(cn_state == "4+2" & event_order == "GW"){
    
    mutations_n1 <- mutation_rate_m*(6 - (6*generated_event_times[2]))
    mutations_n2 <- mutation_rate_m*((3*generated_event_times[2]) - (2*generated_event_times[1]))
    mutations_n4 <- mutation_rate_m*(generated_event_times[1])
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number))
    }
    
    
  }else if(cn_state == "5+0" & event_order == "WGGG"){
    
    mutations_n1 <- mutation_rate_m*(5 - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n5 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number))
    }
    
    
  }else if(cn_state == "5+0" & event_order == "GWG"){
    
    mutations_n1 <- mutation_rate_m*(5 - (3*generated_event_times[2]) - (2*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[1])
    mutations_n3 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n5 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n5
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n5/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(5, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(5,mutations_n5_number))
    }
    
    
  }else if(cn_state == "5+1" & event_order == "WGGG"){
    
    mutations_n1 <- mutation_rate_m*(6 - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n5 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number))
    }
    
    
  }else if(cn_state == "5+1" & event_order == "GWG"){
    
    mutations_n1 <- mutation_rate_m*(6 - (3*generated_event_times[2]) - (2*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[1])
    mutations_n3 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n5 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n5
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n5/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(5, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(5,mutations_n5_number))
    }
    
    
  }else if(cn_state == "5+2" & event_order == "WGGG"){
    
    mutations_n1 <- mutation_rate_m*(7 - (3*generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1] + generated_event_times[4] - generated_event_times[3])
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n5 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number))
    }
    
    
  }else if(cn_state == "5+2" & event_order == "GWG"){
    
    mutations_n1 <- mutation_rate_m*(7 - (5*generated_event_times[2]) - (2*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[3])
    mutations_n3 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n5 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n5
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n5/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(5, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(5,mutations_n5_number))
    }
    
    
  }else if(cn_state == "6+0" & event_order == "WGGGG"){
    
    mutations_n1 <- mutation_rate_m*(6 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number))
    }
    
    
  }else if(cn_state == "6+0" & event_order == "GWGG"){
    
    mutations_n1 <- mutation_rate_m*(6 - (3*generated_event_times[2]) - generated_event_times[3] - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[4] - generated_event_times[3])
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(6, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number))
    }
    
    
  }else if(cn_state == "6+0" & event_order == "GGW"){
    
    mutations_n1 <- mutation_rate_m*(6 - (6*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*((3*generated_event_times[3]) - (2*generated_event_times[2]) - generated_event_times[1])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]),
                        rep(6, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number))
    }
    
    
  }else if(cn_state == "6+1" & event_order == "WGGGG"){
    
    mutations_n1 <- mutation_rate_m*(7 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number))
    }
    
    
  }else if(cn_state == "6+1" & event_order == "GWGG"){
    
    mutations_n1 <- mutation_rate_m*(7 - (3*generated_event_times[2]) - generated_event_times[3] - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[4] - generated_event_times[3])
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(6, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number))
    }
    
    
  }else if(cn_state == "6+1" & event_order == "GGW"){
    
    mutations_n1 <- mutation_rate_m*(7 - (6*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*((3*generated_event_times[3]) - (2*generated_event_times[2]) - generated_event_times[1])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]),
                        rep(6, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number))
    }
    
    
  }else if(cn_state == "6+2" & event_order == "WGGGG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (3*generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1] + generated_event_times[5] - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number))
    }
    
    
  }else if(cn_state == "6+2" & event_order == "GWGG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (5*generated_event_times[2]) - generated_event_times[3] - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[2]) - generated_event_times[1] + generated_event_times[4] - generated_event_times[3])
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(6, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number))
    }
    
    
  }else if(cn_state == "6+2" & event_order == "GGW"){
    
    mutations_n1 <- mutation_rate_m*(8 - (8*generated_event_times[3]))
    mutations_n2 <- mutation_rate_m*((4*generated_event_times[3]) - (2*generated_event_times[2]) - generated_event_times[1])
    mutations_n4 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n6 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4+mutations_n6
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]),
                        rep(6, multinom_out[4]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number))
    }
    
    
  }else if(cn_state == "7+0" & event_order == "WGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(7 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "7+0" & event_order == "GWGGG"){
    
    mutations_n1 <- mutation_rate_m*(7 - (3*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[5] - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(7, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "7+0" & event_order == "GGWG"){
    
    mutations_n1 <- mutation_rate_m*(7 - (5*generated_event_times[3]) - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[1] - generated_event_times[2] + (generated_event_times[3]))
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n5+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(5, multinom_out[4]),
                        rep(7, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "7+1" & event_order == "WGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "7+1" & event_order == "GWGGG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (3*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[5] - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(7, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "7+1" & event_order == "GGWG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (5*generated_event_times[3]) - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[3]) - generated_event_times[2] - generated_event_times[1] + (generated_event_times[4]))
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n5+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(5, multinom_out[4]),
                        rep(7, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "7+2" & event_order == "WGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (3*generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1] + generated_event_times[6] - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "7+2" & event_order == "GWGGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (5*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[2]) - generated_event_times[1] + generated_event_times[5] - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(7, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "7+2" & event_order == "GGWG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (7*generated_event_times[3]) - (2*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[3]) - generated_event_times[2] - generated_event_times[1] + (generated_event_times[4]))
    mutations_n3 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n5 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n7 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n5+mutations_n7
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(5, multinom_out[4]),
                        rep(7, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number))
    }
    
    
  }else if(cn_state == "8+0" & event_order == "WGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n3 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+0" & event_order == "GWGGGG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (3*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[6] - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(8, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+0" & event_order == "GGWGG"){
    
    mutations_n1 <- mutation_rate_m*(8 - (5*generated_event_times[3]) - generated_event_times[4] - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[1] - generated_event_times[2] + (2*generated_event_times[3]) - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*((generated_event_times[4]) - (generated_event_times[3]))
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n6+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(6, multinom_out[5]),
                        rep(8, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+0" & event_order == "GGGW"){
    
    mutations_n1 <- mutation_rate_m*(8 - (8*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*((4*generated_event_times[4]) - generated_event_times[1] - generated_event_times[2] - (2*generated_event_times[3]))
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4+mutations_n6+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]),
                        rep(6, multinom_out[4]),
                        rep(8, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+1" & event_order == "WGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n3 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+1" & event_order == "GWGGGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (3*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[6] - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(8, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+1" & event_order == "GGWGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (5*generated_event_times[3]) - generated_event_times[4] - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[1] - generated_event_times[2] + (2*generated_event_times[3]) - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*((generated_event_times[4]) - (generated_event_times[3]))
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n6+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(6, multinom_out[5]),
                        rep(8, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+1" & event_order == "GGGW"){
    
    mutations_n1 <- mutation_rate_m*(9 - (8*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*((4*generated_event_times[4]) - generated_event_times[1] - generated_event_times[2] - (2*generated_event_times[3]))
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4+mutations_n6+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]),
                        rep(6, multinom_out[4]),
                        rep(8, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+2" & event_order == "WGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (3*generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1] + generated_event_times[7] - generated_event_times[6])
    mutations_n3 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+2" & event_order == "GWGGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (5*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[2]) - generated_event_times[1] + generated_event_times[6] - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(8, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+2" & event_order == "GGWGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (7*generated_event_times[3]) - generated_event_times[4] - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((3*generated_event_times[3]) - generated_event_times[1] - generated_event_times[2] + (generated_event_times[5]) - generated_event_times[4])
    mutations_n3 <- mutation_rate_m*((generated_event_times[4]) - (generated_event_times[3]))
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n6+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(6, multinom_out[5]),
                        rep(8, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "8+2" & event_order == "GGGW"){
    
    mutations_n1 <- mutation_rate_m*(10 - (10*generated_event_times[4]))
    mutations_n2 <- mutation_rate_m*((5*generated_event_times[4]) - generated_event_times[1] - generated_event_times[2] - (2*generated_event_times[3]))
    mutations_n4 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n6 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n8 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4+mutations_n6+mutations_n8
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]),
                        rep(6, multinom_out[4]),
                        rep(8, multinom_out[5]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number))
    }
    
    
  }else if(cn_state == "9+0" & event_order == "WGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - generated_event_times[7] - (2*generated_event_times[8]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[8] - generated_event_times[7])
    mutations_n3 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n4 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n5 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n6 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n7 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+0" & event_order == "GWGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (3*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[7] - generated_event_times[6])
    mutations_n3 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(9, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+0" & event_order == "GGWGGG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (5*generated_event_times[3]) - generated_event_times[4] - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[3]) - generated_event_times[2] - generated_event_times[1] - generated_event_times[5] + generated_event_times[6])
    mutations_n3 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*((generated_event_times[4]) - (generated_event_times[3]))
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n7+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(7, multinom_out[6]),
                        rep(9, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+0" & event_order == "GGGWG"){
    
    mutations_n1 <- mutation_rate_m*(9 - (7*generated_event_times[4]) - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] + (2*generated_event_times[4]))
    mutations_n3 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n5+mutations_n7+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(5, multinom_out[4]),
                        rep(7, multinom_out[5]),
                        rep(9, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+1" & event_order == "WGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - generated_event_times[7] - (2*generated_event_times[8]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[8] - generated_event_times[7])
    mutations_n3 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n4 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n5 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n6 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n7 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+1" & event_order == "GWGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (3*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[7] - generated_event_times[6])
    mutations_n3 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(9, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+1" & event_order == "GGWGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (5*generated_event_times[3]) - generated_event_times[4] - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[3]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[5] + generated_event_times[6])
    mutations_n3 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*((generated_event_times[4]) - (generated_event_times[3]))
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n7+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(7, multinom_out[6]),
                        rep(9, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+1" & event_order == "GGGWG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (7*generated_event_times[4]) - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] + (2*generated_event_times[4]))
    mutations_n3 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n5+mutations_n7+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(5, multinom_out[4]),
                        rep(7, multinom_out[5]),
                        rep(9, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+2" & event_order == "WGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(11 - (3*generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - generated_event_times[7] - (2*generated_event_times[8]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1] + generated_event_times[8] - generated_event_times[7])
    mutations_n3 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n4 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n5 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n6 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n7 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+2" & event_order == "GWGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(11 - (5*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[2]) - generated_event_times[1] + generated_event_times[7] - generated_event_times[6])
    mutations_n3 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(9, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+2" & event_order == "GGWGGG"){
    
    mutations_n1 <- mutation_rate_m*(11 - (7*generated_event_times[3]) - generated_event_times[4] - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*((3*generated_event_times[3]) - generated_event_times[1] - generated_event_times[2] + generated_event_times[6] - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*((generated_event_times[4]) - (generated_event_times[3]))
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n7+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(7, multinom_out[6]),
                        rep(9, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "9+2" & event_order == "GGGWG"){
    
    mutations_n1 <- mutation_rate_m*(11 - (9*generated_event_times[4]) - (2*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] + (3*generated_event_times[4]))
    mutations_n3 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[3])
    mutations_n5 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n7 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n9 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n5+mutations_n7+mutations_n9
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n9/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(5, multinom_out[4]),
                        rep(7, multinom_out[5]),
                        rep(9, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(5,mutations_n5_number),
                        rep(7,mutations_n7_number),
                        rep(9,mutations_n9_number))
    }
    
    
  }else if(cn_state == "10+0" & event_order == "WGGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - generated_event_times[7] - generated_event_times[8] - (2*generated_event_times[9]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[9] - generated_event_times[8])
    mutations_n3 <- mutation_rate_m*(generated_event_times[8] - generated_event_times[7])
    mutations_n4 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n5 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n6 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n7 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n8 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n9 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]),
                        rep(10, multinom_out[10]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+0" & event_order == "GWGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (3*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - generated_event_times[7] - (2*generated_event_times[8]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[8] - generated_event_times[7])
    mutations_n3 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n4 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n5 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n6 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n7 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(10, multinom_out[9]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+0" & event_order == "GGWGGGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (5*generated_event_times[3]) - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] -  (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[1] - generated_event_times[2] + (2*generated_event_times[3] - generated_event_times[6]))
    mutations_n3 <- mutation_rate_m*((generated_event_times[6]) - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*((generated_event_times[4]) - (generated_event_times[3]))
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(8, multinom_out[7]),
                        rep(10, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+0" & event_order == "GGGWGG"){
    
    mutations_n1 <- mutation_rate_m*(10 - (7*generated_event_times[4]) - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[6]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] + (3*generated_event_times[4]) - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n6+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(6, multinom_out[5]),
                        rep(8, multinom_out[6]),
                        rep(10, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+0" & event_order == "GGGGW"){
    
    mutations_n1 <- mutation_rate_m*(10 - (10*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((5*generated_event_times[5]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] - (2*generated_event_times[4]))
    mutations_n4 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4+mutations_n6+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]),
                        rep(6, multinom_out[4]),
                        rep(8, multinom_out[5]),
                        rep(10, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+1" & event_order == "WGGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(11 - (generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - generated_event_times[7] - generated_event_times[8] - (2*generated_event_times[9]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[9] - generated_event_times[8])
    mutations_n3 <- mutation_rate_m*(generated_event_times[8] - generated_event_times[7])
    mutations_n4 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n5 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n6 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n7 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n8 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n9 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]),
                        rep(10, multinom_out[10]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+1" & event_order == "GWGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(11 - (3*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - generated_event_times[7] - (2*generated_event_times[8]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1] + generated_event_times[8] - generated_event_times[7])
    mutations_n3 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n4 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n5 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n6 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n7 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(10, multinom_out[9]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+1" & event_order == "GGWGGGG"){
    
    mutations_n1 <- mutation_rate_m*(11 - (5*generated_event_times[3]) - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] -  (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[1] - generated_event_times[2] + (2*generated_event_times[3] - generated_event_times[6]))
    mutations_n3 <- mutation_rate_m*((generated_event_times[6]) - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*((generated_event_times[4]) - (generated_event_times[3]))
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(8, multinom_out[7]),
                        rep(10, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+1" & event_order == "GGGWGG"){
    
    mutations_n1 <- mutation_rate_m*(11 - (7*generated_event_times[4]) - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[6]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] + (3*generated_event_times[4]) - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n6+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(6, multinom_out[5]),
                        rep(8, multinom_out[6]),
                        rep(10, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+1" & event_order == "GGGGW"){
    
    mutations_n1 <- mutation_rate_m*(11 - (10*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((5*generated_event_times[5]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] - (2*generated_event_times[4]))
    mutations_n4 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4+mutations_n6+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]),
                        rep(6, multinom_out[4]),
                        rep(8, multinom_out[5]),
                        rep(10, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+2" & event_order == "WGGGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(12 - (3*generated_event_times[1]) - (generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - generated_event_times[7] - generated_event_times[8] - (2*generated_event_times[9]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[1] + generated_event_times[9] - generated_event_times[8])
    mutations_n3 <- mutation_rate_m*(generated_event_times[8] - generated_event_times[7])
    mutations_n4 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n5 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n6 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n7 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n8 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n9 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n9+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n9_number <- number_of_mutations_to_generate*(mutations_n9/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n9/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(9, multinom_out[9]),
                        rep(10, multinom_out[10]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(9,mutations_n9_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+2" & event_order == "GWGGGGGG"){
    
    mutations_n1 <- mutation_rate_m*(12 - (5*generated_event_times[2]) - generated_event_times[3] - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] - generated_event_times[7] - (2*generated_event_times[8]))
    mutations_n2 <- mutation_rate_m*((2*generated_event_times[2]) - generated_event_times[1] + generated_event_times[8] - generated_event_times[7])
    mutations_n3 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[6])
    mutations_n4 <- mutation_rate_m*(generated_event_times[6] - generated_event_times[5])
    mutations_n5 <- mutation_rate_m*(generated_event_times[5] - generated_event_times[4])
    mutations_n6 <- mutation_rate_m*(generated_event_times[4] - generated_event_times[3])
    mutations_n7 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n7+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n7_number <- number_of_mutations_to_generate*(mutations_n7/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n7/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(7, multinom_out[7]),
                        rep(8, multinom_out[8]),
                        rep(10, multinom_out[9]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(7,mutations_n7_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+2" & event_order == "GGWGGGG"){
    
    mutations_n1 <- mutation_rate_m*(12 - (7*generated_event_times[3]) - generated_event_times[4] - generated_event_times[5] - generated_event_times[6] -  (2*generated_event_times[7]))
    mutations_n2 <- mutation_rate_m*(generated_event_times[7] - generated_event_times[1] - generated_event_times[2] + (3*generated_event_times[3] - generated_event_times[6]))
    mutations_n3 <- mutation_rate_m*((generated_event_times[6]) - generated_event_times[5])
    mutations_n4 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[4])
    mutations_n5 <- mutation_rate_m*((generated_event_times[4]) - (generated_event_times[3]))
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n5+mutations_n6+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n5_number <- number_of_mutations_to_generate*(mutations_n5/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n5/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(5, multinom_out[5]),
                        rep(6, multinom_out[6]),
                        rep(8, multinom_out[7]),
                        rep(10, multinom_out[8]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(5,mutations_n5_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+2" & event_order == "GGGWGG"){
    
    mutations_n1 <- mutation_rate_m*(12 - (9*generated_event_times[4]) - generated_event_times[5] - (2*generated_event_times[6]))
    mutations_n2 <- mutation_rate_m*((generated_event_times[6]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] + (4*generated_event_times[4]) - generated_event_times[5])
    mutations_n3 <- mutation_rate_m*((generated_event_times[5]) - generated_event_times[4])
    mutations_n4 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n3+mutations_n4+mutations_n6+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n3_number <- number_of_mutations_to_generate*(mutations_n3/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n3/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(3, multinom_out[3]),
                        rep(4, multinom_out[4]),
                        rep(6, multinom_out[5]),
                        rep(8, multinom_out[6]),
                        rep(10, multinom_out[7]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(3,mutations_n3_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }else if(cn_state == "10+2" & event_order == "GGGGW"){
    
    mutations_n1 <- mutation_rate_m*(12 - (12*generated_event_times[5]))
    mutations_n2 <- mutation_rate_m*((6*generated_event_times[5]) - generated_event_times[1] - generated_event_times[2] - generated_event_times[3] - (2*generated_event_times[4]))
    mutations_n4 <- mutation_rate_m*((generated_event_times[4]) - generated_event_times[3])
    mutations_n6 <- mutation_rate_m*(generated_event_times[3] - generated_event_times[2])
    mutations_n8 <- mutation_rate_m*(generated_event_times[2] - generated_event_times[1])
    mutations_n10 <- mutation_rate_m*generated_event_times[1]
    
    mutations_n_total <- mutations_n1+mutations_n2+mutations_n4+mutations_n6+mutations_n8+mutations_n10
    
    mutations_n1_number <- number_of_mutations_to_generate*(mutations_n1/mutations_n_total)
    mutations_n2_number <- number_of_mutations_to_generate*(mutations_n2/mutations_n_total)
    mutations_n4_number <- number_of_mutations_to_generate*(mutations_n4/mutations_n_total)
    mutations_n6_number <- number_of_mutations_to_generate*(mutations_n6/mutations_n_total)
    mutations_n8_number <- number_of_mutations_to_generate*(mutations_n8/mutations_n_total)
    mutations_n10_number <- number_of_mutations_to_generate*(mutations_n10/mutations_n_total)
    
    if(multinomial){
      multinom_probs <- c((mutations_n1/mutations_n_total),
                          (mutations_n2/mutations_n_total),
                          (mutations_n4/mutations_n_total),
                          (mutations_n6/mutations_n_total),
                          (mutations_n8/mutations_n_total),
                          (mutations_n10/mutations_n_total))
      multinom_out <- rmultinom(1, size = number_of_mutations_to_generate, prob = multinom_probs)
      
      mutation_bag <- c(rep(1, multinom_out[1]),
                        rep(2, multinom_out[2]),
                        rep(4, multinom_out[3]),
                        rep(6, multinom_out[4]),
                        rep(8, multinom_out[5]),
                        rep(10, multinom_out[6]))
    }else{
      mutation_bag <- c(rep(1,mutations_n1_number),
                        rep(2,mutations_n2_number),
                        rep(4,mutations_n4_number),
                        rep(6,mutations_n6_number),
                        rep(8,mutations_n8_number),
                        rep(10,mutations_n10_number))
    }
    
    
  }
  return(mutation_bag)
}
```
### Make CN data
```{r}
make_cn_data <- function(cn_state,
                         number_of_mutations_to_select){
  cn_maj <- as.numeric(strsplit(cn_state,"\\+")[[1]][1])
  cn_min <- as.numeric(strsplit(cn_state,"\\+")[[1]][2])
  # CN data 
  data_cn <- as.data.frame(matrix(nrow = 1, ncol = 5, data = c(1,1,number_of_mutations_to_select,cn_maj,cn_min)))
  colnames(data_cn) <- c("chr","startpos","endpos","nMaj1_A","nMin1_A")
  data_cn$startpos <- as.numeric(data_cn$startpos)
  data_cn$endpos <- as.numeric(data_cn$endpos)
  data_cn$nMaj1_A <- as.numeric(data_cn$nMaj1_A)
  data_cn$nMin1_A <- as.numeric(data_cn$nMin1_A)
  
  return(data_cn)
}
```
### Make multiplicity data
```{r}
make_multiplicity_data <- function(number_of_mutations_to_select,
                                   mutation_bag_column_multiplicity
                                   ){
  # Multiplicity data
  data_mult <- as.data.frame(matrix(nrow = number_of_mutations_to_select, 
                                    ncol = 3, 
                                    data = c(rep("1",number_of_mutations_to_select),
                                             1:number_of_mutations_to_select,
                                             mutation_bag_column_multiplicity)))
  colnames(data_mult) <- c("chr","end","no.chrs.bearing.mut")
  data_mult$end <- as.numeric(data_mult$end)
  data_mult$no.chrs.bearing.mut <- as.numeric(data_mult$no.chrs.bearing.mut)
  
  return(data_mult)
}
```
### Make mutation data
```{r}
make_mutation_data <- function(number_of_mutations_to_select
                               ){
  # Mutation data
  data_muts <- as.data.frame(matrix(nrow = number_of_mutations_to_select, 
                                         ncol = 5, 
                                         data = c(rep("1",number_of_mutations_to_select),
                                                  1:number_of_mutations_to_select,
                                                  1:number_of_mutations_to_select,
                                                  rep("C",number_of_mutations_to_select),
                                                  rep("T",number_of_mutations_to_select)))) # ref and alt don't matter here but are neede for proper input data
  colnames(data_muts) <- c("chr", "start", "end", "ref", "alt")
  data_muts$start <- as.numeric(data_muts$start) 
  data_muts$end <- as.numeric(data_muts$end)
  
  return(data_muts)
}
```
### Generate timing test accuracy scenario
```{r}
# to be run once for each cn and order combination
generate_timing_test_accuracy_scenario <- function(cn_state, 
                                      event_order, 
                                      number_of_events, 
                                      number_of_mutations_to_select, 
                                      number_of_mutations_to_generate,
                                      multiplicity_states_exp,
                                      mutation_rate_m=1,
                                      number_of_tests=10,
                                      proportion_clocklike=1,
                                      output,
                                      multinomial){
  
  multiplicity_states <- eval(parse(text=multiplicity_states_exp))
  
  generated_event_times <- sort(round(runif(number_of_events,min = 0.01, max = 0.99), digits = 2))

  # Create bag of mutations
  generated_mutation_bag <- make_mutation_bag(cn_state = cn_state, 
                                              event_order = event_order, 
                                              number_of_mutations_to_generate = (number_of_mutations_to_generate*proportion_clocklike), 
                                              mutation_rate_m = mutation_rate_m,
                                              generated_event_times = generated_event_times,
                                              multinomial)
  
  if(proportion_clocklike < 1){
    proportion_not_clocklike <- 1 - proportion_clocklike
    generated_mutation_bag <- c(generated_mutation_bag,sample(multiplicity_states,(proportion_not_clocklike*number_of_mutations_to_generate), replace = TRUE))
  }
  
  # Create sample of mutations that you intend to use for testing
  if(number_of_mutations_to_select == "All"){
    number_of_mutations_to_select <- length(generated_mutation_bag)
  }
  mutation_sample_from_bag <- replicate(n=number_of_tests, 
                                        expr = {sample(generated_mutation_bag, 
                                                       size = number_of_mutations_to_select, replace = FALSE)})
  # Create sample copy number data
  test_cn_data <- make_cn_data(cn_state = cn_state, number_of_mutations_to_select = number_of_mutations_to_select)
  
  # Create sample mutation data
  test_mut_data <- make_mutation_data(number_of_mutations_to_select = number_of_mutations_to_select)
  
  # Other parameters for timing
  test_data_id <- paste0("test_",cn_state,"_",event_order)
  test_data_id <- gsub(" ","_",test_data_id)
  test_data_chrom <- "1"
  test_data_start <- 1
  test_data_stop <- number_of_mutations_to_select
  test_data_status <- grepl("W",event_order)
  
  number_of_events <- as.numeric(number_of_events)
  
  # Create output table
  timing_test_accuracy_output_results <- as.data.frame(matrix(nrow = number_of_tests, ncol = (5+(2*number_of_events)))) # 5+2*number of timepoints
  colnames(timing_test_accuracy_output_results) <- c("test_number",
                                                     "is_correct_order",
                                                     paste0("t_",1:number_of_events,"_difference"),
                                                     paste0("t_",1:number_of_events,"_error_rate_percent"),
                                                     "average_t_difference",
                                                     "average_absolute_t_difference",
                                                     "average_t_error_rate_percent")
  timing_test_accuracy_output_results$test_number <- 1:number_of_tests
  
  # run timing test
  
  for(i in 1:number_of_tests){
    # Multiplicity data
    # Create sample multiplicity data - has to be done in loop or apply because it uses each column of the mutation_sample_from_bag for the number of tests

    test_data_mult <- make_multiplicity_data(number_of_mutations_to_select = number_of_mutations_to_select, 
                                             mutation_bag_column_multiplicity = mutation_sample_from_bag[,i])

    segment_time <- AmplificationTimeR::time_amplification(
      cn_data = test_cn_data,
      multiplicity_data = test_data_mult,
      mutation_data = test_mut_data,
      muts_type = "SBS1 and SBS5",
      sample_id = test_data_id,
      amplification_chrom = test_data_chrom,
      amplification_start = test_data_start,
      amplification_stop = test_data_stop,
      is_WGD = test_data_status,
      genome = "hg19")
    
    timing_test_accuracy_output_results$is_correct_order[i] <- ifelse(segment_time$event_order == event_order, yes = TRUE, no = FALSE)
    
    if(number_of_events ==1){
      #Difference
      timing_test_accuracy_output_results$t_1_difference[i] <- generated_event_times[1] - segment_time$t_1_mean_bootstrap
      #Accuracy
      timing_test_accuracy_output_results$t_1_error_rate_percent[i] <- (((abs(segment_time$t_1_mean_bootstrap - generated_event_times[1])/generated_event_times[1])*100))
    }else if(number_of_events == 2){
      #Difference
      timing_test_accuracy_output_results$t_1_difference[i] <- generated_event_times[1] - segment_time$t_1_mean_bootstrap
      timing_test_accuracy_output_results$t_2_difference[i] <- generated_event_times[2] - segment_time$t_2_mean_bootstrap
      #Accuracy
      timing_test_accuracy_output_results$t_1_error_rate_percent[i] <- (((abs(segment_time$t_1_mean_bootstrap - generated_event_times[1])/generated_event_times[1])*100))
      timing_test_accuracy_output_results$t_2_error_rate_percent[i] <- (((abs(segment_time$t_2_mean_bootstrap - generated_event_times[2])/generated_event_times[2])*100))
    }else if(number_of_events == 3){
      #Difference
      timing_test_accuracy_output_results$t_1_difference[i] <- generated_event_times[1] - segment_time$t_1_mean_bootstrap
      timing_test_accuracy_output_results$t_2_difference[i] <- generated_event_times[2] - segment_time$t_2_mean_bootstrap
      timing_test_accuracy_output_results$t_3_difference[i] <- generated_event_times[3] - segment_time$t_3_mean_bootstrap
      #Accuracy
      timing_test_accuracy_output_results$t_1_error_rate_percent[i] <- (((abs(segment_time$t_1_mean_bootstrap - generated_event_times[1])/generated_event_times[1])*100))
      timing_test_accuracy_output_results$t_2_error_rate_percent[i] <- (((abs(segment_time$t_2_mean_bootstrap - generated_event_times[2])/generated_event_times[2])*100))
      timing_test_accuracy_output_results$t_3_error_rate_percent[i] <- (((abs(segment_time$t_3_mean_bootstrap - generated_event_times[3])/generated_event_times[3])*100))
    }else if(number_of_events == 4){
      #Difference
      timing_test_accuracy_output_results$t_1_difference[i] <- generated_event_times[1] - segment_time$t_1_mean_bootstrap
      timing_test_accuracy_output_results$t_2_difference[i] <- generated_event_times[2] - segment_time$t_2_mean_bootstrap
      timing_test_accuracy_output_results$t_3_difference[i] <- generated_event_times[3] - segment_time$t_3_mean_bootstrap
      timing_test_accuracy_output_results$t_4_difference[i] <- generated_event_times[4] - segment_time$t_4_mean_bootstrap
      #Accuracy
      timing_test_accuracy_output_results$t_1_error_rate_percent[i] <- (((abs(segment_time$t_1_mean_bootstrap - generated_event_times[1])/generated_event_times[1])*100))
      timing_test_accuracy_output_results$t_2_error_rate_percent[i] <- (((abs(segment_time$t_2_mean_bootstrap - generated_event_times[2])/generated_event_times[2])*100))
      timing_test_accuracy_output_results$t_3_error_rate_percent[i] <- (((abs(segment_time$t_3_mean_bootstrap - generated_event_times[3])/generated_event_times[3])*100))
      timing_test_accuracy_output_results$t_4_error_rate_percent[i] <- (((abs(segment_time$t_4_mean_bootstrap - generated_event_times[4])/generated_event_times[4])*100))
    }else if(number_of_events == 5){
      #Difference
      timing_test_accuracy_output_results$t_1_difference[i] <- generated_event_times[1] - segment_time$t_1_mean_bootstrap
      timing_test_accuracy_output_results$t_2_difference[i] <- generated_event_times[2] - segment_time$t_2_mean_bootstrap
      timing_test_accuracy_output_results$t_3_difference[i] <- generated_event_times[3] - segment_time$t_3_mean_bootstrap
      timing_test_accuracy_output_results$t_4_difference[i] <- generated_event_times[4] - segment_time$t_4_mean_bootstrap
      timing_test_accuracy_output_results$t_5_difference[i] <- generated_event_times[5] - segment_time$t_5_mean_bootstrap
      #Accuracy
      timing_test_accuracy_output_results$t_1_error_rate_percent[i] <- (((abs(segment_time$t_1_mean_bootstrap - generated_event_times[1])/generated_event_times[1])*100))
      timing_test_accuracy_output_results$t_2_error_rate_percent[i] <- (((abs(segment_time$t_2_mean_bootstrap - generated_event_times[2])/generated_event_times[2])*100))
      timing_test_accuracy_output_results$t_3_error_rate_percent[i] <- (((abs(segment_time$t_3_mean_bootstrap - generated_event_times[3])/generated_event_times[3])*100))
      timing_test_accuracy_output_results$t_4_error_rate_percent[i] <- (((abs(segment_time$t_4_mean_bootstrap - generated_event_times[4])/generated_event_times[4])*100))
      timing_test_accuracy_output_results$t_5_error_rate_percent[i] <- (((abs(segment_time$t_5_mean_bootstrap - generated_event_times[5])/generated_event_times[5])*100))
    }else if(number_of_events == 6){
      #Difference
      timing_test_accuracy_output_results$t_1_difference[i] <- generated_event_times[1] - segment_time$t_1_mean_bootstrap
      timing_test_accuracy_output_results$t_2_difference[i] <- generated_event_times[2] - segment_time$t_2_mean_bootstrap
      timing_test_accuracy_output_results$t_3_difference[i] <- generated_event_times[3] - segment_time$t_3_mean_bootstrap
      timing_test_accuracy_output_results$t_4_difference[i] <- generated_event_times[4] - segment_time$t_4_mean_bootstrap
      timing_test_accuracy_output_results$t_5_difference[i] <- generated_event_times[5] - segment_time$t_5_mean_bootstrap
      timing_test_accuracy_output_results$t_6_difference[i] <- generated_event_times[6] - segment_time$t_6_mean_bootstrap
      #Accuracy
      timing_test_accuracy_output_results$t_1_error_rate_percent[i] <- (((abs(segment_time$t_1_mean_bootstrap - generated_event_times[1])/generated_event_times[1])*100))
      timing_test_accuracy_output_results$t_2_error_rate_percent[i] <- (((abs(segment_time$t_2_mean_bootstrap - generated_event_times[2])/generated_event_times[2])*100))
      timing_test_accuracy_output_results$t_3_error_rate_percent[i] <- (((abs(segment_time$t_3_mean_bootstrap - generated_event_times[3])/generated_event_times[3])*100))
      timing_test_accuracy_output_results$t_4_error_rate_percent[i] <- (((abs(segment_time$t_4_mean_bootstrap - generated_event_times[4])/generated_event_times[4])*100))
      timing_test_accuracy_output_results$t_5_error_rate_percent[i] <- (((abs(segment_time$t_5_mean_bootstrap - generated_event_times[5])/generated_event_times[5])*100))
      timing_test_accuracy_output_results$t_6_error_rate_percent[i] <- (((abs(segment_time$t_6_mean_bootstrap - generated_event_times[6])/generated_event_times[6])*100))
    }else if(number_of_events == 7){
      #Difference
      timing_test_accuracy_output_results$t_1_difference[i] <- generated_event_times[1] - segment_time$t_1_mean_bootstrap
      timing_test_accuracy_output_results$t_2_difference[i] <- generated_event_times[2] - segment_time$t_2_mean_bootstrap
      timing_test_accuracy_output_results$t_3_difference[i] <- generated_event_times[3] - segment_time$t_3_mean_bootstrap
      timing_test_accuracy_output_results$t_4_difference[i] <- generated_event_times[4] - segment_time$t_4_mean_bootstrap
      timing_test_accuracy_output_results$t_5_difference[i] <- generated_event_times[5] - segment_time$t_5_mean_bootstrap
      timing_test_accuracy_output_results$t_6_difference[i] <- generated_event_times[6] - segment_time$t_6_mean_bootstrap
      timing_test_accuracy_output_results$t_7_difference[i] <- generated_event_times[7] - segment_time$t_7_mean_bootstrap
      #Accuracy
      timing_test_accuracy_output_results$t_1_error_rate_percent[i] <- (((abs(segment_time$t_1_mean_bootstrap - generated_event_times[1])/generated_event_times[1])*100))
      timing_test_accuracy_output_results$t_2_error_rate_percent[i] <- (((abs(segment_time$t_2_mean_bootstrap - generated_event_times[2])/generated_event_times[2])*100))
      timing_test_accuracy_output_results$t_3_error_rate_percent[i] <- (((abs(segment_time$t_3_mean_bootstrap - generated_event_times[3])/generated_event_times[3])*100))
      timing_test_accuracy_output_results$t_4_error_rate_percent[i] <- (((abs(segment_time$t_4_mean_bootstrap - generated_event_times[4])/generated_event_times[4])*100))
      timing_test_accuracy_output_results$t_5_error_rate_percent[i] <- (((abs(segment_time$t_5_mean_bootstrap - generated_event_times[5])/generated_event_times[5])*100))
      timing_test_accuracy_output_results$t_6_error_rate_percent[i] <- (((abs(segment_time$t_6_mean_bootstrap - generated_event_times[6])/generated_event_times[6])*100))
      timing_test_accuracy_output_results$t_7_error_rate_percent[i] <- (((abs(segment_time$t_7_mean_bootstrap - generated_event_times[7])/generated_event_times[7])*100))
    }else if(number_of_events == 8){
      #Difference
      timing_test_accuracy_output_results$t_1_difference[i] <- generated_event_times[1] - segment_time$t_1_mean_bootstrap
      timing_test_accuracy_output_results$t_2_difference[i] <- generated_event_times[2] - segment_time$t_2_mean_bootstrap
      timing_test_accuracy_output_results$t_3_difference[i] <- generated_event_times[3] - segment_time$t_3_mean_bootstrap
      timing_test_accuracy_output_results$t_4_difference[i] <- generated_event_times[4] - segment_time$t_4_mean_bootstrap
      timing_test_accuracy_output_results$t_5_difference[i] <- generated_event_times[5] - segment_time$t_5_mean_bootstrap
      timing_test_accuracy_output_results$t_6_difference[i] <- generated_event_times[6] - segment_time$t_6_mean_bootstrap
      timing_test_accuracy_output_results$t_7_difference[i] <- generated_event_times[7] - segment_time$t_7_mean_bootstrap
      timing_test_accuracy_output_results$t_8_difference[i] <- generated_event_times[8] - segment_time$t_8_mean_bootstrap
      #Accuracy
      timing_test_accuracy_output_results$t_1_error_rate_percent[i] <- (((abs(segment_time$t_1_mean_bootstrap - generated_event_times[1])/generated_event_times[1])*100))
      timing_test_accuracy_output_results$t_2_error_rate_percent[i] <- (((abs(segment_time$t_2_mean_bootstrap - generated_event_times[2])/generated_event_times[2])*100))
      timing_test_accuracy_output_results$t_3_error_rate_percent[i] <- (((abs(segment_time$t_3_mean_bootstrap - generated_event_times[3])/generated_event_times[3])*100))
      timing_test_accuracy_output_results$t_4_error_rate_percent[i] <- (((abs(segment_time$t_4_mean_bootstrap - generated_event_times[4])/generated_event_times[4])*100))
      timing_test_accuracy_output_results$t_5_error_rate_percent[i] <- (((abs(segment_time$t_5_mean_bootstrap - generated_event_times[5])/generated_event_times[5])*100))
      timing_test_accuracy_output_results$t_6_error_rate_percent[i] <- (((abs(segment_time$t_6_mean_bootstrap - generated_event_times[6])/generated_event_times[6])*100))
      timing_test_accuracy_output_results$t_7_error_rate_percent[i] <- (((abs(segment_time$t_7_mean_bootstrap - generated_event_times[7])/generated_event_times[7])*100))
      timing_test_accuracy_output_results$t_8_error_rate_percent[i] <- (((abs(segment_time$t_8_mean_bootstrap - generated_event_times[8])/generated_event_times[8])*100))
    }else if(number_of_events == 9){
      #Difference
      timing_test_accuracy_output_results$t_1_difference[i] <- generated_event_times[1] - segment_time$t_1_mean_bootstrap
      timing_test_accuracy_output_results$t_2_difference[i] <- generated_event_times[2] - segment_time$t_2_mean_bootstrap
      timing_test_accuracy_output_results$t_3_difference[i] <- generated_event_times[3] - segment_time$t_3_mean_bootstrap
      timing_test_accuracy_output_results$t_4_difference[i] <- generated_event_times[4] - segment_time$t_4_mean_bootstrap
      timing_test_accuracy_output_results$t_5_difference[i] <- generated_event_times[5] - segment_time$t_5_mean_bootstrap
      timing_test_accuracy_output_results$t_6_difference[i] <- generated_event_times[6] - segment_time$t_6_mean_bootstrap
      timing_test_accuracy_output_results$t_7_difference[i] <- generated_event_times[7] - segment_time$t_7_mean_bootstrap
      timing_test_accuracy_output_results$t_8_difference[i] <- generated_event_times[8] - segment_time$t_8_mean_bootstrap
      timing_test_accuracy_output_results$t_9_difference[i] <- generated_event_times[9] - segment_time$t_9_mean_bootstrap
      #Accuracy
      timing_test_accuracy_output_results$t_1_error_rate_percent[i] <- (((abs(segment_time$t_1_mean_bootstrap - generated_event_times[1])/generated_event_times[1])*100))
      timing_test_accuracy_output_results$t_2_error_rate_percent[i] <- (((abs(segment_time$t_2_mean_bootstrap - generated_event_times[2])/generated_event_times[2])*100))
      timing_test_accuracy_output_results$t_3_error_rate_percent[i] <- (((abs(segment_time$t_3_mean_bootstrap - generated_event_times[3])/generated_event_times[3])*100))
      timing_test_accuracy_output_results$t_4_error_rate_percent[i] <- (((abs(segment_time$t_4_mean_bootstrap - generated_event_times[4])/generated_event_times[4])*100))
      timing_test_accuracy_output_results$t_5_error_rate_percent[i] <- (((abs(segment_time$t_5_mean_bootstrap - generated_event_times[5])/generated_event_times[5])*100))
      timing_test_accuracy_output_results$t_6_error_rate_percent[i] <- (((abs(segment_time$t_6_mean_bootstrap - generated_event_times[6])/generated_event_times[6])*100))
      timing_test_accuracy_output_results$t_7_error_rate_percent[i] <- (((abs(segment_time$t_7_mean_bootstrap - generated_event_times[7])/generated_event_times[7])*100))
      timing_test_accuracy_output_results$t_8_error_rate_percent[i] <- (((abs(segment_time$t_8_mean_bootstrap - generated_event_times[8])/generated_event_times[8])*100))
      timing_test_accuracy_output_results$t_9_error_rate_percent[i] <- (((abs(segment_time$t_9_mean_bootstrap - generated_event_times[9])/generated_event_times[9])*100))
    }
    
  }
  
  if(number_of_events == 1){
    timing_test_accuracy_output_results$average_t_difference <- (timing_test_accuracy_output_results[,3:(2+number_of_events)])
  timing_test_accuracy_output_results$average_absolute_t_difference <- (abs(timing_test_accuracy_output_results[,(2+(number_of_events)):(2+(number_of_events))]))
  timing_test_accuracy_output_results$average_t_error_rate_percent <- ((timing_test_accuracy_output_results[,(2+(2*number_of_events)):(2+(2*number_of_events))]))
  }else{
    timing_test_accuracy_output_results$average_t_difference <- rowMeans(timing_test_accuracy_output_results[,3:(2+number_of_events)], na.rm = TRUE)
    timing_test_accuracy_output_results$average_absolute_t_difference <- rowMeans(abs(timing_test_accuracy_output_results[,3:(2+number_of_events)]), na.rm = TRUE)
    timing_test_accuracy_output_results$average_t_error_rate_percent <- rowMeans((timing_test_accuracy_output_results[,(2+number_of_events):(2+(2*number_of_events))]), na.rm = TRUE)
  }
  
  timing_test_accuracy_output_results_averaged <- as.data.frame(matrix(nrow = 1, ncol = 4))
  colnames(timing_test_accuracy_output_results_averaged) <- c("average_t_difference","average_absolute_t_difference","number_of_correct_orders","average_error_rate_percent_averaged")
  
  timing_test_accuracy_output_results_averaged$average_t_difference <- mean(timing_test_accuracy_output_results$average_t_difference, na.rm = TRUE)
  timing_test_accuracy_output_results_averaged$average_absolute_t_difference <- mean(timing_test_accuracy_output_results$average_absolute_t_difference, na.rm = TRUE)
  timing_test_accuracy_output_results_averaged$number_of_correct_orders <- sum(timing_test_accuracy_output_results$is_correct_order)
  timing_test_accuracy_output_results_averaged$average_error_rate_percent_averaged <- mean(timing_test_accuracy_output_results$average_t_error_rate_percent, na.rm = TRUE)

  # add generated times to calculated times
  segment_and_generated_times <- segment_time
  names(generated_event_times) <- paste0("gt",1:number_of_events)
  segment_and_generated_times <- cbind(segment_and_generated_times,as.data.frame(t(generated_event_times)))
  
  if(output == "Averaged"){
    return(timing_test_accuracy_output_results_averaged)
  }else if(output == "Individual times"){
    return(segment_and_generated_times)
  # return(c("generated_event_times" = generated_event_times,
  #          "timing_results" = segment_time,
  #          "timing_test_accuracy_output_results"= timing_test_accuracy_output_results,
  #          "timing_test_accuracy_output_results_averaged" = timing_test_accuracy_output_results_averaged))
  }
  
  # return(timing_test_accuracy_output_results)
  
  # return(generated_event_times) # Checking if seed issue resolved

}
```


# Testing Accuracy across states and mutation numbers
```{r}
mutation_numbers <- c(seq(10,100,by = 10),seq(200,1000,by = 100))
```

```{r}
mutation_number_and_accuracy <- as.data.frame(matrix(nrow = nrow(states_and_order), ncol = length(mutation_numbers)+1))
colnames(mutation_number_and_accuracy) <- c("State_and_order",mutation_numbers)
mutation_number_and_accuracy$State_and_order <- states_and_order$State_and_order

mutation_number_and_number_correct_order <- mutation_number_and_accuracy

mutation_number_and_average_difference <- mutation_number_and_accuracy

mutation_number_and_average_absolute_difference <- mutation_number_and_accuracy


state_timing_replicates <- 100
states_and_order_accuracy <- states_and_order

for(mut_number in 1:length(mutation_numbers)){ #length(mutation_numbers)
  for(state in 1:nrow(states_and_order_accuracy)){
    test_different_timings <- replicate(n=state_timing_replicates, 
                                        expr = {generate_timing_test_accuracy_scenario(cn_state = states_and_order_accuracy$State[state],
                                                                                       event_order = states_and_order_accuracy$Order[state],
                                                                                       number_of_events = as.numeric(states_and_order_accuracy$number_of_timepoints[state]),
                                                                                       number_of_mutations_to_select = "All",
                                                                                       number_of_mutations_to_generate = mutation_numbers[mut_number],
                                                                                       multiplicity_states_exp = states_and_order_accuracy$multiplicity_states[state],
                                                                                       mutation_rate_m = 1,
                                                                                       number_of_tests = 1,
                                                                                       proportion_clocklike=1,
                                                                                       output = "Averaged",
                                                                                       multinomial = multinomial_TF)})
    # test_different_timings
    test_different_timings <- as.data.frame(matrix(data = unlist(test_different_timings), nrow = state_timing_replicates, ncol = 4, byrow = TRUE))
    colnames(test_different_timings) <- c("average_t_difference", "average_absolute_t_difference", "number_of_correct_orders", "average_error_rate_percent_averaged")
    # test_different_timings
    
    mutation_number_and_accuracy[state,(mut_number+1)] <- colMeans(test_different_timings, na.rm = TRUE)[4]
    mutation_number_and_number_correct_order[state,(mut_number+1)] <- colSums(test_different_timings)[3] # sum if just doing one test
    mutation_number_and_average_difference[state,(mut_number+1)] <- colMeans(test_different_timings, na.rm = TRUE)[1]
    mutation_number_and_average_absolute_difference[state,(mut_number+1)] <- colMeans(test_different_timings, na.rm = TRUE)[2]
    
  }
}

```

## Save results
```{r}
write.table(mutation_number_and_accuracy, paste0(outdir,"Error_vs_mutation_number/",
                                                 "mutation_number_and_error_rate_",
                                                 state_timing_replicates,"_replicates",
                                                 "_",data_type,"_",
                                                 Sys.Date(),".txt"),
            sep = "\t", row.names = FALSE, quote = FALSE)
write.table(mutation_number_and_number_correct_order, paste0(outdir,"Error_vs_mutation_number/",
                                                 "mutation_number_and_correct_order_",
                                                 state_timing_replicates,"_replicates",
                                                 "_",data_type,"_",
                                                 Sys.Date(),".txt"),
            sep = "\t", row.names = FALSE, quote = FALSE)
write.table(mutation_number_and_average_difference, paste0(outdir,"Error_vs_mutation_number/",
                                                 "mutation_number_and_average_t_difference_",
                                                 state_timing_replicates,"_replicates",
                                                 "_",data_type,"_",
                                                 Sys.Date(),".txt"),
            sep = "\t", row.names = FALSE, quote = FALSE)
write.table(mutation_number_and_average_absolute_difference, paste0(outdir,"Error_vs_mutation_number/",
                                                 "mutation_number_and_average_absolute_t_difference_",
                                                 state_timing_replicates,"_replicates",
                                                 "_",data_type,"_",
                                                 Sys.Date(),".txt"),
            sep = "\t", row.names = FALSE, quote = FALSE)
```

## Plot
```{r}
plot_mutation_number_and_accuracy <- as.matrix(mutation_number_and_accuracy[,-1])
rownames(plot_mutation_number_and_accuracy) <- mutation_number_and_accuracy$State_and_order
```

```{r fig.height=12}
png(paste0(outdir,"Error_vs_mutation_number/",
                                                 "mutation_number_and_error_rate_",
                                                 state_timing_replicates,"_replicates",
                                                 "_",data_type,"_",
                                                 Sys.Date(),".png"),
    height = 12, width = 18, res = 300, units = "cm")
setHook("grid.newpage", function() pushViewport(viewport(x=1,y=1,width=0.9, height=0.9, name="vp", just=c("right","top"))), action="prepend")
pheatmap(plot_mutation_number_and_accuracy, 
        cluster_rows = FALSE, cluster_cols = FALSE,
        col = viridis(100),
        main = paste0("Average error rate (%) of timing (n=",state_timing_replicates,") - ",data_type_title),
        xlab = "Number of mutations simulated",
        ylab = "Copy number state and order",
        border_color = NA,
        scale = "none")
setHook("grid.newpage", NULL, "replace")
grid.text("Number of mutations simulated", y=-0.07, gp=gpar(fontsize=16))
grid.text("Copy number state and order", x=-0.07, rot=90, gp=gpar(fontsize=16))
dev.off()
```

```{r fig.height=10}
plot_mutation_number_and_number_correct_order <- as.matrix(mutation_number_and_number_correct_order[,-1])
rownames(plot_mutation_number_and_number_correct_order) <- mutation_number_and_number_correct_order$State_and_order
```
```{r fig.height=12}
png(paste0(outdir,"Error_vs_mutation_number/",
                                                 "mutation_number_and_correct_order_",
                                                 state_timing_replicates,"_replicates",
                                                 "_",data_type,"_",
                                                 Sys.Date(),".png"),
    height = 12, width = 18, res = 300, units = "cm")
setHook("grid.newpage", function() pushViewport(viewport(x=1,y=1,width=0.9, height=0.9, name="vp", just=c("right","top"))), action="prepend")
pheatmap(plot_mutation_number_and_number_correct_order, 
        cluster_rows = FALSE, cluster_cols = FALSE,
        col = viridis(10),
        main = paste0("Number of correct timing orders (n=",state_timing_replicates,") - ",data_type_title),
        border_color = NA,
        scale = "none")
setHook("grid.newpage", NULL, "replace")
grid.text("Number of mutations simulated", y=-0.07, gp=gpar(fontsize=16))
grid.text("Copy number state and order", x=-0.07, rot=90, gp=gpar(fontsize=16))
dev.off()
```

```{r fig.height=10}
plot_mutation_number_and_average_absolute_difference <- as.matrix(mutation_number_and_average_absolute_difference[,-1])
rownames(plot_mutation_number_and_average_absolute_difference) <- mutation_number_and_average_absolute_difference$State_and_order
```
```{r fig.height=12}
png(paste0(outdir,"Error_vs_mutation_number/",
                                                 "mutation_number_and_average_absolute_t_difference_",
                                                 state_timing_replicates,"_replicates",
                                                 "_",data_type,"_",
                                                 Sys.Date(),".png"),
    height = 12, width = 18, res = 300, units = "cm")
setHook("grid.newpage", function() pushViewport(viewport(x=1,y=1,width=0.9, height=0.9, name="vp", just=c("right","top"))), action="prepend")
pheatmap(plot_mutation_number_and_average_absolute_difference, 
        cluster_rows = FALSE, cluster_cols = FALSE,
        col = viridis(100),
        main = paste0("Average absolute difference in time (n=",state_timing_replicates,") - ",data_type_title),
        border_color = NA,
        scale = "none")
setHook("grid.newpage", NULL, "replace")
grid.text("Number of mutations simulated", y=-0.07, gp=gpar(fontsize=16))
grid.text("Copy number state and order", x=-0.07, rot=90, gp=gpar(fontsize=16))
dev.off()
```

# Testing individual timepoints >t2 vs simulated time

```{r fig.height=8}
n_replicates <- 100
n_mutations <- 100
for(test_case in 1:nrow(states_and_order)){
  # test each scenario x times
  test_individual <- replicate(n_replicates,{generate_timing_test_accuracy_scenario(cn_state = states_and_order$State[test_case],
                                                                          event_order = states_and_order$Order[test_case],
                                                                          number_of_events = states_and_order$number_of_timepoints[test_case],
                                                                          number_of_mutations_to_select = "All",
                                                                          number_of_mutations_to_generate = n_mutations,
                                                                          multiplicity_states_exp = states_and_order$multiplicity_states[test_case],
                                                                          mutation_rate_m = 1,
                                                                          number_of_tests = 1,
                                                                          proportion_clocklike=1,
                                                                          output = "Individual times",
                                                                          multinomial = multinomial_TF)})
  # get the results of the x replicates and turn them into a data frame
  test_individual <- as.data.frame(matrix(data = unlist(test_individual), nrow = n_replicates, byrow = TRUE))
  colnames(test_individual) <- c("sample","region","highest_copy_number","event_order","num_mutations_used","clonality_status","flags",
                                 "t_1","t_1_mean_bootstrap","t_1_lower_ci","t_1_upper_ci","t_2","t_2_mean_bootstrap","t_2_lower_ci","t_2_upper_ci",
                                 "t_3","t_3_mean_bootstrap","t_3_lower_ci","t_3_upper_ci","t_4","t_4_mean_bootstrap","t_4_lower_ci","t_4_upper_ci",
                                 "t_5","t_5_mean_bootstrap","t_5_lower_ci","t_5_upper_ci","t_6","t_6_mean_bootstrap","t_6_lower_ci","t_6_upper_ci",
                                 "t_7","t_7_mean_bootstrap","t_7_lower_ci","t_7_upper_ci","t_8","t_8_mean_bootstrap","t_8_lower_ci","t_8_upper_ci",
                                 "t_9","t_9_mean_bootstrap","t_9_lower_ci","t_9_upper_ci","t_10","t_10_mean_bootstrap","t_10_lower_ci","t_10_upper_ci",
                                 paste0("tg",1:states_and_order$number_of_timepoints[test_case]))
  # create a unique identifier for each replicate
  test_individual$sample_number <- paste0(test_individual$sample,"_",rownames(test_individual))
  
  # Melt the calculated and the generated data
  test_individual_melt_calculated <- melt(as.data.table(test_individual), id.vars = c("sample_number","num_mutations_used","event_order"), 
                                          measure.vars = c(colnames(test_individual)[grep("_mean_bootstrap",colnames(test_individual))]))
  test_individual_melt_generated <- melt(as.data.table(test_individual), id.vars = c("sample_number","num_mutations_used","event_order"), 
                                         measure.vars = c(colnames(test_individual)[grep("tg",colnames(test_individual))]))
  
  colnames(test_individual_melt_calculated) <- c("sample_number","num_mutations_used","event_order","calculated_variable","calculated_value")
  colnames(test_individual_melt_generated) <- c("sample_number","num_mutations_used","event_order","generated_variable","generated_value")
  
  test_individual_melt_calculated$event_number <- gsub("_mean_bootstrap","",test_individual_melt_calculated$calculated_variable)
  test_individual_melt_calculated$event_number <- gsub("t_","",test_individual_melt_calculated$event_number)
  
  test_individual_melt_generated$event_number <- gsub("tg","",test_individual_melt_generated$generated_variable)
  
  test_individual_melt_calculated$sample_number_id <- paste0(test_individual_melt_calculated$sample_number," ",
                                                             test_individual_melt_calculated$event_number)
  test_individual_melt_generated$sample_number_id <- paste0(test_individual_melt_generated$sample_number," ",
                                                            test_individual_melt_generated$event_number)
  # combine the melted data for plotting and testing
  test_individual_melt_combined <- merge(test_individual_melt_calculated,
                                         test_individual_melt_generated,
                                         by = c("sample_number_id","sample_number","num_mutations_used","event_order"))
  test_individual_melt_combined$event_number_t <- paste0("t",test_individual_melt_combined$event_number.x)
  # Do a Spearman correlation test
  test_individual_correlation <- as.data.frame(matrix(data = NA, 
                                                      nrow = as.numeric(states_and_order$number_of_timepoints[test_case]),
                                                      ncol = 4))
  colnames(test_individual_correlation) <- c("Timepoint","Spearman_rho","Spearman_p_value","Spearman_adjusted_p")
  test_individual_correlation$Timepoint <- paste0("t_",1:states_and_order$number_of_timepoints[test_case])
  for(t in 1:nrow(test_individual_correlation)){
    if(sum(!is.na(as.numeric(subset(test_individual_melt_combined, event_number.x == t)$calculated_value))) < 3){
      next
    }else{
      test_individual_correlation$Spearman_rho[t] <- cor.test(as.numeric(subset(test_individual_melt_combined, event_number.x == t)$calculated_value),
                                                              as.numeric(subset(test_individual_melt_combined, event_number.x == t)$generated_value),
                                                              method = "spearman")[[4]]
      test_individual_correlation$Spearman_p_value[t] <- cor.test(as.numeric(subset(test_individual_melt_combined, event_number.x == t)$calculated_value),
                                                                  as.numeric(subset(test_individual_melt_combined, event_number.x == t)$generated_value),
                                                                  method = "spearman")[[3]]
    }
    
  }
  test_individual_correlation$Spearman_adjusted_p <- p.adjust(test_individual_correlation$Spearman_p_value, method = "BH")
  
  # table grob for plotting table
  table_individual_cor <- tableGrob(test_individual_correlation)
  
  # Plot
  plot_individual_cor <- ggplot(test_individual_melt_combined, aes(x = as.numeric(calculated_value), y = as.numeric(generated_value), colour = as.numeric(num_mutations_used), shape = event_order))+
    geom_point()+
    # geom_smooth(method = "lm")+
    facet_wrap(~(event_number.x), scales = "free")+
    theme_light()+
    scale_colour_viridis(name = "Number of mutations used")+
    scale_shape(name = "Event Order Calculated")+
    xlab("Calculated time")+
    ylab("Generated time")+
    ggtitle(paste0(states_and_order$State_and_order[test_case], " - ",data_type_title))+
    theme(axis.text.x = element_text(angle = 70,vjust = 0.5), plot.title = element_text(hjust = 0.5))+
    scale_x_continuous(labels = label_number(accuracy = 0.01))+
    geom_abline(slope = 1, intercept = 0, linetype = 2, colour = "grey")
  
  # combine plot and table
  png(paste0(outdir,"Accuracy_of_timepoints/",
             "generated_vs_calculated_timepoints_",
             states_and_order$State_and_order[test_case],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".png"),
      res = 300, width = 20, height = 20, units = "cm")
  grid.arrange(plot_individual_cor, table_individual_cor,
               nrow = 2,
               as.table = TRUE,
               heights = c(2, 1))
  dev.off()
  
  # Save numerical results as well
  write.table(test_individual_correlation,
              paste0(outdir,"Accuracy_of_timepoints/",
             "generated_vs_calculated_timepoints_spearman_correlation_",
             states_and_order$State_and_order[test_case],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".txt"), sep = "\t", row.names = FALSE, quote = FALSE)
  write.table(test_individual_melt_combined,
              paste0(outdir,"Accuracy_of_timepoints/",
             "generated_vs_calculated_timepoints_melted_values_",
             states_and_order$State_and_order[test_case],"_",
             n_replicates,"_replicates",
             n_mutations,"_mutations",
             "_",data_type,"_",
             Sys.Date(),".txt"), sep = "\t", row.names = FALSE, quote = FALSE)
}
```

# Test proportion clocklike
```{r}
clocklike_proportions <- c(seq(0,1,by = 0.05))
```
```{r}
# test each state 100 times (i.e. generate 100 different event times)
n_replicates_clocklike <- 100
# number of mutations to generate for this test
n_mutations_clocklike_test <- 100

# make output tables
clocklike_proportions_and_accuracy <- as.data.frame(matrix(nrow = nrow(states_and_order), ncol = length(clocklike_proportions)+1))
colnames(clocklike_proportions_and_accuracy) <- c("State_and_order",clocklike_proportions)
clocklike_proportions_and_accuracy$State_and_order <- states_and_order$State_and_order

clocklike_proportions_and_number_correct_order <- clocklike_proportions_and_accuracy

clocklike_proportions_and_average_difference <- clocklike_proportions_and_accuracy

clocklike_proportions_and_average_absolute_difference <- clocklike_proportions_and_accuracy



for(c_proportion in 1:length(clocklike_proportions)){ #length(clocklike_proportionss)
  for(state in 1:nrow(states_and_order)){
    test_different_timings <- replicate(n=n_replicates_clocklike, 
                                        expr = {generate_timing_test_accuracy_scenario(cn_state = states_and_order$State[state],
                                                                                       event_order = states_and_order$Order[state],
                                                                                       number_of_events = as.numeric(states_and_order$number_of_timepoints[state]),
                                                                                       number_of_mutations_to_select = "All",
                                                                                       number_of_mutations_to_generate = n_mutations_clocklike_test,
                                                                                       multiplicity_states_exp = states_and_order$multiplicity_states[state],
                                                                                       mutation_rate_m = 1,
                                                                                       number_of_tests = 1,
                                                                                       proportion_clocklike=clocklike_proportions[c_proportion],
                                                                                       output = "Averaged",
                                                                                       multinomial = multinomial_TF)})
    # test_different_timings
    test_different_timings <- as.data.frame(matrix(data = unlist(test_different_timings), nrow = n_replicates_clocklike, ncol = 4, byrow = TRUE))
    colnames(test_different_timings) <- c("average_t_difference", "average_absolute_t_difference", "number_of_correct_orders", "average_error_rate_percent_averaged")
    # test_different_timings
    
    clocklike_proportions_and_accuracy[state,(c_proportion+1)] <- colMeans(test_different_timings, na.rm = TRUE)[4]
    clocklike_proportions_and_number_correct_order[state,(c_proportion+1)] <- colSums(test_different_timings)[3] # sum if just doing one test
    clocklike_proportions_and_average_difference[state,(c_proportion+1)] <- colMeans(test_different_timings, na.rm = TRUE)[1]
    clocklike_proportions_and_average_absolute_difference[state,(c_proportion+1)] <- colMeans(test_different_timings, na.rm = TRUE)[2]
    
  }
}

```

## Save results
```{r}
write.table(clocklike_proportions_and_accuracy, paste0(outdir,"Error_vs_proportion_clocklike/",
                                                 "clocklike_proportion_and_error_rate_",
                                                 n_replicates_clocklike,"_replicates",
                                                 n_mutations_clocklike_test,"_mutations",
                                                 "_",data_type,"_",
                                                 Sys.Date(),".txt"),
            sep = "\t", row.names = FALSE, quote = FALSE)
write.table(clocklike_proportions_and_number_correct_order, paste0(outdir,"Error_vs_proportion_clocklike/",
                                                 "clocklike_proportion_and_correct_order_",
                                                 n_replicates_clocklike,"_replicates",
                                                 n_mutations_clocklike_test,"_mutations",
                                                 "_",data_type,"_",
                                                 Sys.Date(),".txt"),
            sep = "\t", row.names = FALSE, quote = FALSE)
write.table(clocklike_proportions_and_average_difference, paste0(outdir,"Error_vs_proportion_clocklike/",
                                                 "clocklike_proportion_and_average_t_difference_",
                                                 n_replicates_clocklike,"_replicates",
                                                 n_mutations_clocklike_test,"_mutations",
                                                 "_",data_type,"_",
                                                 Sys.Date(),".txt"),
            sep = "\t", row.names = FALSE, quote = FALSE)
write.table(clocklike_proportions_and_average_absolute_difference, paste0(outdir,"Error_vs_proportion_clocklike/",
                                                 "clocklike_proportion_and_average_absolute_t_difference_",
                                                 n_replicates_clocklike,"_replicates",
                                                 n_mutations_clocklike_test,"_mutations",
                                                 "_",data_type,"_",
                                                 Sys.Date(),".txt"),
            sep = "\t", row.names = FALSE, quote = FALSE)
```

## Plots
```{r}
plot_clocklike_proportions_and_accuracy <- as.matrix(clocklike_proportions_and_accuracy[,-1])
rownames(plot_clocklike_proportions_and_accuracy) <- clocklike_proportions_and_accuracy$State_and_order
```

```{r fig.height=12}
png(paste0(outdir,"Error_vs_proportion_clocklike/",
                                                 "clocklike_proportion_and_error_rate_",
                                                 n_replicates_clocklike,"_replicates",
                                                 n_mutations_clocklike_test,"_mutations",
                                                 "_",data_type,"_",
                                                 Sys.Date(),".png"),
    height = 12, width = 18, res = 300, units = "cm")
setHook("grid.newpage", function() pushViewport(viewport(x=1,y=1,width=0.9, height=0.9, name="vp", just=c("right","top"))), action="prepend")
pheatmap(plot_clocklike_proportions_and_accuracy, 
        cluster_rows = FALSE, cluster_cols = FALSE,
        col = viridis(100),
        main = paste0("Average error rate (%) of timing (n=",state_timing_replicates,") - ",data_type_title),
        xlab = "Proportion of clocklike mutations simulated",
        ylab = "Copy number state and order",
        border_color = NA,
        scale = "none")
setHook("grid.newpage", NULL, "replace")
grid.text("Proportion of clocklike mutations simulated", y=-0.07, gp=gpar(fontsize=16))
grid.text("Copy number state and order", x=-0.07, rot=90, gp=gpar(fontsize=16))
dev.off()
```

```{r fig.height=10}
plot_clocklike_proportions_and_number_correct_order <- as.matrix(clocklike_proportions_and_number_correct_order[,-1])
rownames(plot_clocklike_proportions_and_number_correct_order) <- clocklike_proportions_and_number_correct_order$State_and_order
```
```{r fig.height=12}
png(paste0(outdir,"Error_vs_proportion_clocklike/",
                                                 "clocklike_proportion_and_correct_order_",
                                                 n_replicates_clocklike,"_replicates",
                                                 n_mutations_clocklike_test,"_mutations",
                                                 "_",data_type,"_",
                                                 Sys.Date(),".png"),
    height = 12, width = 18, res = 300, units = "cm")
setHook("grid.newpage", function() pushViewport(viewport(x=1,y=1,width=0.9, height=0.9, name="vp", just=c("right","top"))), action="prepend")
pheatmap(plot_clocklike_proportions_and_number_correct_order, 
        cluster_rows = FALSE, cluster_cols = FALSE,
        col = viridis(10),
        main = paste0("Number of correct timing orders (n=",state_timing_replicates,") - ",data_type_title),
        border_color = NA,
        scale = "none")
setHook("grid.newpage", NULL, "replace")
grid.text("Proportion of clocklike mutations simulated", y=-0.07, gp=gpar(fontsize=16))
grid.text("Copy number state and order", x=-0.07, rot=90, gp=gpar(fontsize=16))
dev.off()
```

```{r fig.height=10}
plot_clocklike_proportions_and_average_absolute_difference <- as.matrix(clocklike_proportions_and_average_absolute_difference[,-1])
rownames(plot_clocklike_proportions_and_average_absolute_difference) <- clocklike_proportions_and_average_absolute_difference$State_and_order
```
```{r fig.height=12}
png(paste0(outdir,"Error_vs_proportion_clocklike/",
                                                 "clocklike_proportion_and_average_absolute_t_difference_",
                                                 n_replicates_clocklike,"_replicates",
                                                 n_mutations_clocklike_test,"_mutations",
                                                 "_",data_type,"_",
                                                 Sys.Date(),".png"),
    height = 12, width = 18, res = 300, units = "cm")
setHook("grid.newpage", function() pushViewport(viewport(x=1,y=1,width=0.9, height=0.9, name="vp", just=c("right","top"))), action="prepend")
pheatmap(plot_clocklike_proportions_and_average_absolute_difference, 
        cluster_rows = FALSE, cluster_cols = FALSE,
        col = viridis(100),
        main = paste0("Average absolute difference in time (n=",state_timing_replicates,") - ",data_type_title),
        border_color = NA,
        scale = "none")
setHook("grid.newpage", NULL, "replace")
grid.text("Proportion of clocklike mutations simulated", y=-0.07, gp=gpar(fontsize=16))
grid.text("Copy number state and order", x=-0.07, rot=90, gp=gpar(fontsize=16))
dev.off()
```


# Session Info
```{r}
sessionInfo()
```

Save session info
```{r}
writeLines(capture.output(sessionInfo()), paste0(outdir,data_type,"_sessionInfo",Sys.Date(),".txt"))
```

